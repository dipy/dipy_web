{"parents": [], "prev": null, "next": null, "title": "Read/Write streamline files", "meta": {}, "body": "<div class=\"section\" id=\"read-write-streamline-files\">\n<span id=\"example-streamline-formats\"></span><h1>Read/Write streamline files<a class=\"headerlink\" href=\"#read-write-streamline-files\" title=\"Permalink to this headline\">\u00b6</a></h1>\n<div class=\"section\" id=\"overview\">\n<h2>Overview<a class=\"headerlink\" href=\"#overview\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p><a class=\"reference external\" href=\"http://dipy.org\">dipy</a> can read and write many different file formats. In this example\nwe give a short introduction on how to use it for loading or saving streamlines.</p>\n<p>Read <a class=\"reference internal\" href=\"../../faq/#faq\"><span class=\"std std-ref\">Frequently Asked Questions</span></a></p>\n<div class=\"highlight-default\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.data</span> <span class=\"k\">import</span> <span class=\"n\">get_data</span>\n<span class=\"kn\">from</span> <span class=\"nn\">nibabel</span> <span class=\"k\">import</span> <span class=\"n\">trackvis</span>\n</pre></div>\n</div>\n<ol class=\"arabic simple\">\n<li>Read/write trackvis streamline files with nibabel.</li>\n</ol>\n<div class=\"highlight-default\"><div class=\"highlight\"><pre><span></span><span class=\"n\">fname</span> <span class=\"o\">=</span> <span class=\"n\">get_data</span><span class=\"p\">(</span><span class=\"s1\">&#39;fornix&#39;</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">fname</span><span class=\"p\">)</span>\n\n<span class=\"n\">streams</span><span class=\"p\">,</span> <span class=\"n\">hdr</span> <span class=\"o\">=</span> <span class=\"n\">trackvis</span><span class=\"o\">.</span><span class=\"n\">read</span><span class=\"p\">(</span><span class=\"n\">fname</span><span class=\"p\">)</span>\n<span class=\"n\">streamlines</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">s</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">s</span> <span class=\"ow\">in</span> <span class=\"n\">streams</span><span class=\"p\">]</span>\n</pre></div>\n</div>\n<p>Similarly you can use <cite>trackvis.write</cite> to save the streamlines.</p>\n<ol class=\"arabic simple\" start=\"2\">\n<li>Read/writh streamlines with numpy.</li>\n</ol>\n<div class=\"highlight-default\"><div class=\"highlight\"><pre><span></span><span class=\"n\">streamlines_np</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(</span><span class=\"n\">streamlines</span><span class=\"p\">,</span> <span class=\"n\">dtype</span><span class=\"o\">=</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">object</span><span class=\"p\">)</span>\n<span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">save</span><span class=\"p\">(</span><span class=\"s1\">&#39;fornix.npy&#39;</span><span class=\"p\">,</span> <span class=\"n\">streamlines_np</span><span class=\"p\">)</span>\n\n<span class=\"n\">streamlines2</span> <span class=\"o\">=</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">load</span><span class=\"p\">(</span><span class=\"s1\">&#39;fornix.npy&#39;</span><span class=\"p\">))</span>\n</pre></div>\n</div>\n<p>3. We also work on our HDF5 based file format which can read/write massive datasets\n(as big as the size of you free disk space). With <cite>Dpy</cite> we can support</p>\n<blockquote>\n<div><ul class=\"simple\">\n<li>direct indexing from the disk</li>\n<li>memory usage always low</li>\n<li>extentions to include different arrays in the same file</li>\n</ul>\n</div></blockquote>\n<p>Here is a simple example.</p>\n<div class=\"highlight-default\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">dipy.io.dpy</span> <span class=\"k\">import</span> <span class=\"n\">Dpy</span>\n<span class=\"n\">dpw</span> <span class=\"o\">=</span> <span class=\"n\">Dpy</span><span class=\"p\">(</span><span class=\"s1\">&#39;fornix.dpy&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;w&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Write many streamlines at once.</p>\n<div class=\"highlight-default\"><div class=\"highlight\"><pre><span></span><span class=\"n\">dpw</span><span class=\"o\">.</span><span class=\"n\">write_tracks</span><span class=\"p\">(</span><span class=\"n\">streamlines2</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Write one track</p>\n<div class=\"highlight-default\"><div class=\"highlight\"><pre><span></span><span class=\"n\">dpw</span><span class=\"o\">.</span><span class=\"n\">write_track</span><span class=\"p\">(</span><span class=\"n\">streamlines2</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">])</span>\n</pre></div>\n</div>\n<p>or one track each time.</p>\n<div class=\"highlight-default\"><div class=\"highlight\"><pre><span></span><span class=\"k\">for</span> <span class=\"n\">t</span> <span class=\"ow\">in</span> <span class=\"n\">streamlines</span><span class=\"p\">:</span>\n    <span class=\"n\">dpw</span><span class=\"o\">.</span><span class=\"n\">write_track</span><span class=\"p\">(</span><span class=\"n\">t</span><span class=\"p\">)</span>\n\n<span class=\"n\">dpw</span><span class=\"o\">.</span><span class=\"n\">close</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>Read streamlines directly from the disk using their indices</p>\n<div class=\"highlight-default\"><div class=\"highlight\"><pre><span></span><span class=\"n\">dpr</span> <span class=\"o\">=</span> <span class=\"n\">Dpy</span><span class=\"p\">(</span><span class=\"s1\">&#39;fornix.dpy&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;r&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">some_streamlines</span> <span class=\"o\">=</span> <span class=\"n\">dpr</span><span class=\"o\">.</span><span class=\"n\">read_tracksi</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">20</span><span class=\"p\">,</span> <span class=\"mi\">30</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">])</span>\n<span class=\"n\">dpr</span><span class=\"o\">.</span><span class=\"n\">close</span><span class=\"p\">()</span>\n\n\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">streamlines</span><span class=\"p\">))</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">some_streamlines</span><span class=\"p\">))</span>\n</pre></div>\n</div>\n<div class=\"admonition-example-source-code admonition\">\n<p class=\"first admonition-title\">Example source code</p>\n<p class=\"last\">You can download <a class=\"reference download internal\" href=\"../../_downloads/streamline_formats.py\" download=\"\"><code class=\"xref download docutils literal\"><span class=\"pre\">the</span> <span class=\"pre\">full</span> <span class=\"pre\">source</span> <span class=\"pre\">code</span> <span class=\"pre\">of</span> <span class=\"pre\">this</span> <span class=\"pre\">example</span></code></a>.\nThis same script is also included in the dipy source distribution under the\n<code class=\"file docutils literal\"><span class=\"pre\">doc/examples/</span></code> directory.</p>\n</div>\n</div>\n</div>\n", "metatags": "", "rellinks": [["genindex", "General Index", "I", "index"]], "sourcename": "examples_built/streamline_formats.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Read/Write streamline files</a><ul>\n<li><a class=\"reference internal\" href=\"#overview\">Overview</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "examples_built/streamline_formats", "sidebars": null, "customsidebar": null, "alabaster_version": "0.7.10"}
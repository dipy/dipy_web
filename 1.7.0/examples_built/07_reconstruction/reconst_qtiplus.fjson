{"parents": [{"link": "../../../documentation/", "title": "Documentation"}, {"link": "../../", "title": "Examples"}, {"link": "../", "title": "Reconstruction"}], "prev": {"link": "../", "title": "Reconstruction"}, "next": {"link": "../reconst_shore/", "title": "Continuous and analytical diffusion signal modelling with 3D-SHORE"}, "title": "Applying positivity constraints to Q-space Trajectory Imaging (QTI+)", "meta": null, "body": "<div class=\"sphx-glr-download-link-note admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>Click <a class=\"reference internal\" href=\"#sphx-glr-download-examples-built-07-reconstruction-reconst-qtiplus-py\"><span class=\"std std-ref\">here</span></a>\nto download the full example code</p>\n</div>\n<section class=\"sphx-glr-example-title\" id=\"applying-positivity-constraints-to-q-space-trajectory-imaging-qti\">\n<span id=\"sphx-glr-examples-built-07-reconstruction-reconst-qtiplus-py\"></span><h1>Applying positivity constraints to Q-space Trajectory Imaging (QTI+)<a class=\"headerlink\" href=\"#applying-positivity-constraints-to-q-space-trajectory-imaging-qti\" title=\"Permalink to this heading\">\u00b6</a></h1>\n<p>Q-space trajectory imaging (QTI) <a class=\"footnote-reference brackets\" href=\"#id7\" id=\"id1\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>1<span class=\"fn-bracket\">]</span></a> with applied positivity constraints\n(QTI+) is an estimation framework proposed by Herberthson et al. <a class=\"footnote-reference brackets\" href=\"#id8\" id=\"id2\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>2<span class=\"fn-bracket\">]</span></a> which\nenforces necessary constraints during the estimation of the QTI model\nparameters.</p>\n<p>This tutorial briefly summarizes the theory and provides a comparison between\nperforming the constrained and unconstrained QTI reconstruction in DIPY.</p>\n<section id=\"theory\">\n<h2>Theory<a class=\"headerlink\" href=\"#theory\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>In QTI, the tissue microstructure is represented by a diffusion tensor\ndistribution (DTD). Here, DTD is denoted by <span class=\"math notranslate nohighlight\">\\(\\mathbf{D}\\)</span> and the voxel-level\ndiffusion tensor from DTI by <span class=\"math notranslate nohighlight\">\\(\\langle\\mathbf{D}\nangle\\)</span>, where\n<span class=\"math notranslate nohighlight\">\\(\\langle \\\nangle\\)</span> denotes averaging over the DTD. The covariance of\n<span class=\"math notranslate nohighlight\">\\(\\mathbf{D}\\)</span> is given by a fourth-order covariance tensor <span class=\"math notranslate nohighlight\">\\(\\mathbb{C}\\)</span> defined\nas</p>\n<div class=\"math notranslate nohighlight\">\n\\[\\mathbb{C} = \\langle \\mathbf{D} \\otimes \\mathbf{D}\\]</div>\n<dl class=\"simple\">\n<dt>angle - langle</dt><dd><p>mathbf{D}</p>\n</dd>\n</dl>\n<p>angle otimes langle mathbf{D}\nangle ,</p>\n<p>where <span class=\"math notranslate nohighlight\">\\(\\otimes\\)</span> denotes a tensor outer product. <span class=\"math notranslate nohighlight\">\\(\\mathbb{C}\\)</span> has 21 unique\nelements and enables the calculation of several microstructural parameters.</p>\n<p>Using the cumulant expansion, the diffusion-weighted signal can be approximated\nas</p>\n<div class=\"math notranslate nohighlight\">\n\\[S \u0007pprox S_0 \\exp \\left(- \\mathbf{b} : \\langle \\mathbf{D}\\]</div>\n<p>angle +</p>\n<p>rac{1}{2}(mathbf{b} otimes mathbf{b}) : mathbb{C}\night) ,</p>\n<p>where <span class=\"math notranslate nohighlight\">\\(S_0\\)</span> is the signal without diffusion-weighting, <span class=\"math notranslate nohighlight\">\\(\\mathbf{b}\\)</span> is the\nb-tensor used in the acquisition, and <span class=\"math notranslate nohighlight\">\\(:\\)</span> denotes a tensor inner product.</p>\n<p>The model parameters <span class=\"math notranslate nohighlight\">\\(S_0\\)</span>, <span class=\"math notranslate nohighlight\">\\(\\langle \\mathbf{D}\nangle\\)</span>, and <span class=\"math notranslate nohighlight\">\\(\\mathbb{C}\\)</span>\ncan be estimated by solving the following weighted problem, where the\nheteroskedasticity introduced by the taking the logarithm of the signal is\naccounted for:</p>\n<div class=\"math notranslate nohighlight\">\n\\[{\\mathrm{argmin}}_{S_0,\\langle \\mathbf{D}\\]</div>\n<dl class=\"simple\">\n<dt>angle, mathbb{C}}</dt><dd><p>sum_{k=1}^n S_k^2 left| ln(S_k)-ln(S_0)+mathbf{b}^{(k)} langle\nmathbf{D}</p>\n</dd>\n</dl>\n<p>angle -\nrac{1}{2} (mathbf{b} otimes mathbf{b})^{(k)}</p>\n<blockquote>\n<div><p>mathbb{C}</p>\n</div></blockquote>\n<p>ight|^2 ,</p>\n<p>the above can be written as a weighted least squares problem</p>\n<div class=\"math notranslate nohighlight\">\n\\[\\mathbf{Ax} = \\mathbf{y},\\]</div>\n<p>where</p>\n<div class=\"math notranslate nohighlight\">\n\\[y = \begin{pmatrix} \\ S_1 \\ ln S_1 \\\\]</div>\n<dl class=\"simple\">\n<dt>dots </dt><dd><p>S_n ln S_n end{pmatrix} ,</p>\n</dd>\n</dl>\n<div class=\"math notranslate nohighlight\">\n\\[x = \begin{pmatrix} \\ln S_0 &amp; \\langle \\mathbf{D}\\]</div>\n<dl class=\"simple\">\n<dt>angle &amp; mathbb{C}</dt><dd><p>end{pmatrix}^       ext{T} ,</p>\n</dd>\n</dl>\n<div class=\"math notranslate nohighlight\">\n\\[A =\n\begin{pmatrix}\nS_1 &amp; 0 &amp; \\ldots &amp; 0 \\ 0 &amp; \\ddots &amp; \\ddots &amp;\\]</div>\n<p>dots dots &amp; ddots</p>\n<blockquote>\n<div><p>&amp; ddots &amp; 0 0 &amp; ldots &amp; 0 &amp; S_n\nend{pmatrix}\n\begin{pmatrix}\n1 &amp; -mathbf{b}_1^   ext{T} &amp;</p>\n</div></blockquote>\n<dl class=\"simple\">\n<dt>rac{1}{2} (mathbf{b}_1 otimes mathbf{b}_1)</dt><dd><p>ext{T} </p>\n</dd>\n</dl>\n<p>dots &amp;\ndots &amp;\ndots </p>\n<p>dots &amp;\ndots &amp;\ndots </p>\n<blockquote>\n<div><p>1 &amp; -mathbf{b}_n^   ext{T} &amp;</p>\n</div></blockquote>\n<dl class=\"simple\">\n<dt>rac{1}{2} (mathbf{b}_n otimes mathbf{b}_n)</dt><dd><p>^    ext{T}\nend{pmatrix} ,</p>\n</dd>\n</dl>\n<p>where <span class=\"math notranslate nohighlight\">\\(n\\)</span> is the number of acquisitions and <span class=\"math notranslate nohighlight\">\\(\\langle\\mathbf{D}\nangle\\)</span>,\n<span class=\"math notranslate nohighlight\">\\(\\mathbb{C}\\)</span>, <span class=\"math notranslate nohighlight\">\\(\\mathbf{b}_i\\)</span>, and <span class=\"math notranslate nohighlight\">\\((\\mathbf{b}_i \\otimes \\mathbf{b}_i)\\)</span> are\nrepresented by column vectors using Voigt notation.</p>\n<p>The estimated <span class=\"math notranslate nohighlight\">\\(\\langle\\mathbf{D}\nangle\\)</span> and <span class=\"math notranslate nohighlight\">\\(\\mathbb{C}\\)</span> tensors\nshould observe mathematical and physical conditions dictated by the model\nitself: since <span class=\"math notranslate nohighlight\">\\(\\langle\\mathbf{D}\nangle\\)</span> represents a diffusivity, it should be\npositive semi-definite: <span class=\"math notranslate nohighlight\">\\(\\langle\\mathbf{D}\nangle \\succeq 0\\)</span>. Similarly, since\n<span class=\"math notranslate nohighlight\">\\(\\mathbf{C}\\)</span> represents a covariance, it\u2019s <span class=\"math notranslate nohighlight\">\\(6   imes 6\\)</span> representation,\n<span class=\"math notranslate nohighlight\">\\(\\mathbf{C}\\)</span>, should be positive semi-definite:  <span class=\"math notranslate nohighlight\">\\(\\mathbf{C} \\succeq 0\\)</span></p>\n<p>When not imposed, violations of these conditions can occur in presence of noise\nand/or in sparsely sampled data. This could results in metrics derived from the\nmodel parameters to be unreliable. Both these conditions can be enfoced while\nestimating the QTI model\u2019s parameters using semidefinite programming (SDP) as\nshown by Herberthson et al. <a class=\"footnote-reference brackets\" href=\"#id8\" id=\"id3\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>2<span class=\"fn-bracket\">]</span></a>. This corresponds to solving the problem</p>\n<div class=\"math notranslate nohighlight\">\n\\[ \\begin{align}\\begin{aligned}\\mathbf{Ax} = \\mathbf{y} \\\\\\    ext{subject to:} \\\\\\\\langle\\mathbf{D}\\end{aligned}\\end{align} \\]</div>\n<dl class=\"simple\">\n<dt>angle succeq 0 , </dt><dd><p>mathbf{C} succeq 0</p>\n</dd>\n</dl>\n</section>\n<section id=\"installation\">\n<h2>Installation<a class=\"headerlink\" href=\"#installation\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>The constrained problem stated above can be solved using the cvxpy library.\nInstructions on how to install cvxpy\ncan be found at <a class=\"reference external\" href=\"https://www.cvxpy.org/install/\">https://www.cvxpy.org/install/</a>. A free SDP solver\ncalled \u2018SCS\u2019 is installed with cvxpy, and can be readily used for\nperforming the fit. However, it is recommended to install an\nalternative solver, MOSEK, for improved speed and performance.\nMOSEK requires a licence which is free for academic use.\nInstructions on how to install Mosek and setting up a licence can be found\nat <a class=\"reference external\" href=\"https://docs.mosek.com/latest/install/installation.html\">https://docs.mosek.com/latest/install/installation.html</a></p>\n</section>\n<section id=\"usage-example\">\n<h2>Usage example<a class=\"headerlink\" href=\"#usage-example\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>Here we show how metrics derived from the\nQTI model parameters compare when the fit is performed with and without\napplying the positivity constraints.</p>\n<p>In DIPY, the constrained estimation routine is available as part of the\n<cite>dipy.reconst.qti</cite> module.\nFirst we import all the necessary modules to perform the QTI fit:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">dipy.data</span> <span class=\"kn\">import</span> <span class=\"n\">read_DiB_217_lte_pte_ste</span><span class=\"p\">,</span> <span class=\"n\">read_DiB_70_lte_pte_ste</span>\n<span class=\"kn\">import</span> <span class=\"nn\">dipy.reconst.qti</span> <span class=\"k\">as</span> <span class=\"nn\">qti</span>\n</pre></div>\n</div>\n<p>To showcase why enforcing positivity constraints in QTI is relevant, we use\na human brain dataset comprising 70 volumes acquired with tensor-encoding.\nThis dataset was obtained by subsampling a richer dataset containing 217\ndiffusion measurements, which we will use as ground truth when comparing\nthe parameters estimation with and without applied constraints. This emulates\nperforming shorter data acquisition which can correspond to scanning patients\nin clinical settings.</p>\n<p>The full dataset used in this tutorial was originally published at\n<a class=\"reference external\" href=\"https://github.com/filip-szczepankiewicz/Szczepankiewicz_DIB_2019\">https://github.com/filip-szczepankiewicz/Szczepankiewicz_DIB_2019</a>,\nand is described in <a class=\"footnote-reference brackets\" href=\"#id9\" id=\"id4\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>3<span class=\"fn-bracket\">]</span></a>.</p>\n<p>First, let\u2019s load the complete dataset and create the gradient table.\nWe mark these two with the \u2018_217\u2019 suffix.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">data_img</span><span class=\"p\">,</span> <span class=\"n\">mask_img</span><span class=\"p\">,</span> <span class=\"n\">gtab_217</span> <span class=\"o\">=</span> <span class=\"n\">read_DiB_217_lte_pte_ste</span><span class=\"p\">()</span>\n<span class=\"n\">data_217</span> <span class=\"o\">=</span> <span class=\"n\">data_img</span><span class=\"o\">.</span><span class=\"n\">get_fdata</span><span class=\"p\">()</span>\n<span class=\"n\">mask</span> <span class=\"o\">=</span> <span class=\"n\">mask_img</span><span class=\"o\">.</span><span class=\"n\">get_fdata</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>Second, let\u2019s load the downsampled dataset and create the gradient table.\nWe mark these two with the \u2018_70\u2019 suffix.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">data_img</span><span class=\"p\">,</span> <span class=\"n\">_</span><span class=\"p\">,</span> <span class=\"n\">gtab_70</span> <span class=\"o\">=</span> <span class=\"n\">read_DiB_70_lte_pte_ste</span><span class=\"p\">()</span>\n<span class=\"n\">data_70</span> <span class=\"o\">=</span> <span class=\"n\">data_img</span><span class=\"o\">.</span><span class=\"n\">get_fdata</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>Now we can fit the QTI model to the datasets containing 217 measurements, and\nuse it as reference to compare the constrained and unconstrained fit on the\nsmaller dataset. For time considerations, we restrict the fit to a\nsingle slice.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">mask</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"p\">:</span><span class=\"mi\">13</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n<span class=\"n\">mask</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"mi\">14</span><span class=\"p\">:]</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n\n<span class=\"n\">qtimodel_217</span> <span class=\"o\">=</span> <span class=\"n\">qti</span><span class=\"o\">.</span><span class=\"n\">QtiModel</span><span class=\"p\">(</span><span class=\"n\">gtab_217</span><span class=\"p\">)</span>\n<span class=\"n\">qtifit_217</span> <span class=\"o\">=</span> <span class=\"n\">qtimodel_217</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">data_217</span><span class=\"p\">,</span> <span class=\"n\">mask</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Now we can fit the QTI model using the default unconstrained fitting method\nto the subsampled dataset:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">qtimodel_unconstrained</span> <span class=\"o\">=</span> <span class=\"n\">qti</span><span class=\"o\">.</span><span class=\"n\">QtiModel</span><span class=\"p\">(</span><span class=\"n\">gtab_70</span><span class=\"p\">)</span>\n<span class=\"n\">qtifit_unconstrained</span> <span class=\"o\">=</span> <span class=\"n\">qtimodel_unconstrained</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">data_70</span><span class=\"p\">,</span> <span class=\"n\">mask</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Now we repeat the fit but with the constraints applied.\nTo perform the constrained fit, we select the \u2018SDPdc\u2019 fit method when creating\nthe QtiModel object.</p>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>this fit method is slower compared to the defaults unconstrained.</p>\n</div>\n<p>If mosek is installed, it can be specified as the solver to be used\nas follows:</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">qtimodel</span> <span class=\"o\">=</span> <span class=\"n\">qti</span><span class=\"o\">.</span><span class=\"n\">QtiModel</span><span class=\"p\">(</span><span class=\"n\">gtab</span><span class=\"p\">,</span> <span class=\"n\">fit_method</span><span class=\"o\">=</span><span class=\"s1\">&#39;SDPdc&#39;</span><span class=\"p\">,</span> <span class=\"n\">cvxpy_solver</span><span class=\"o\">=</span><span class=\"s1\">&#39;MOSEK&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">qtifit</span> <span class=\"o\">=</span> <span class=\"n\">qtimodel</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">,</span> <span class=\"n\">mask</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>If Mosek is not installed, the constrained fit can still be performed, and\nSCS will be used as solver. SCS is typically much slower than Mosek, but\nprovides similar results in terms of accuracy. To give an example, the fit\nperformed in the next line will take approximately 15 minutes when using SCS,\nand 2 minute when using Mosek!</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">qtimodel_constrained</span> <span class=\"o\">=</span> <span class=\"n\">qti</span><span class=\"o\">.</span><span class=\"n\">QtiModel</span><span class=\"p\">(</span><span class=\"n\">gtab_70</span><span class=\"p\">,</span> <span class=\"n\">fit_method</span><span class=\"o\">=</span><span class=\"s1\">&#39;SDPdc&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">qtifit_constrained</span> <span class=\"o\">=</span> <span class=\"n\">qtimodel_constrained</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">data_70</span><span class=\"p\">,</span> <span class=\"n\">mask</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>/opt/homebrew/Caskroom/miniforge/base/envs/dipy-39-x86/lib/python3.9/site-packages/cvxpy/problems/problem.py:1385: UserWarning: Solution may be inaccurate. Try another solver, adjusting the solver settings, or solve with verbose=True for more information.\n  warnings.warn(\n</pre></div>\n</div>\n<p>Now we can visualize the results obtained with the constrained and\nunconstrained fit on the small dataset, and compare them with the\n\u201cground truth\u201d provided by fitting the QTI model to the full dataset.\nFor example, we can look at the FA and \u00b5FA maps, and their value\ndistribution in White Matter in comparison to the ground truth.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">dipy.viz.plotting</span> <span class=\"kn\">import</span> <span class=\"n\">compare_qti_maps</span>\n\n<span class=\"n\">z</span> <span class=\"o\">=</span> <span class=\"mi\">13</span>\n<span class=\"n\">wm_mask</span> <span class=\"o\">=</span> <span class=\"n\">qtifit_217</span><span class=\"o\">.</span><span class=\"n\">ufa</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"n\">z</span><span class=\"p\">]</span> <span class=\"o\">&gt;</span> <span class=\"mf\">0.6</span>\n<span class=\"n\">compare_qti_maps</span><span class=\"p\">(</span><span class=\"n\">qtifit_217</span><span class=\"p\">,</span> <span class=\"n\">qtifit_unconstrained</span><span class=\"p\">,</span> <span class=\"n\">qtifit_constrained</span><span class=\"p\">,</span> <span class=\"n\">wm_mask</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>/opt/homebrew/Caskroom/miniforge/base/envs/dipy-39-x86/lib/python3.9/site-packages/dipy/reconst/qti.py:954: RuntimeWarning: invalid value encountered in sqrt\n  ufa = np.sqrt(self.c_mu)\n</pre></div>\n</div>\n<p>The results clearly show how many of the FA and \u00b5FA values\nobtained with the unconstrained fit fall outside the correct\ntheoretical range [0 1], while the constrained fit provides\nmore sound results. Note also that even when fitting the rich\ndataset, some values of the parameters produced with the unconstrained\nfit fall outside the correct range, suggesting that the constrained fit,\ndespite the additional time cost, should be performed even on densely\nsampled diffusion data.</p>\n<p>For more information about QTI and QTI+, please read the articles by\nWestin et al. <a class=\"footnote-reference brackets\" href=\"#id7\" id=\"id5\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>1<span class=\"fn-bracket\">]</span></a> and Herberthson et al. <a class=\"footnote-reference brackets\" href=\"#id8\" id=\"id6\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>2<span class=\"fn-bracket\">]</span></a>.</p>\n<section id=\"references\">\n<h3>References<a class=\"headerlink\" href=\"#references\" title=\"Permalink to this heading\">\u00b6</a></h3>\n<aside class=\"footnote-list brackets\">\n<aside class=\"footnote brackets\" id=\"id7\" role=\"note\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span>1<span class=\"fn-bracket\">]</span></span>\n<span class=\"backrefs\">(<a role=\"doc-backlink\" href=\"#id1\">1</a>,<a role=\"doc-backlink\" href=\"#id5\">2</a>)</span>\n<p>Westin, Carl-Fredrik, et al. \u201cQ-space trajectory imaging for\nmultidimensional diffusion MRI of the human brain.\u201d Neuroimage 135\n(2016): 345-362. <a class=\"reference external\" href=\"https://doi.org/10.1016/j.neuroimage.2016.02.039\">https://doi.org/10.1016/j.neuroimage.2016.02.039</a>.</p>\n</aside>\n<aside class=\"footnote brackets\" id=\"id8\" role=\"note\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span>2<span class=\"fn-bracket\">]</span></span>\n<span class=\"backrefs\">(<a role=\"doc-backlink\" href=\"#id2\">1</a>,<a role=\"doc-backlink\" href=\"#id3\">2</a>,<a role=\"doc-backlink\" href=\"#id6\">3</a>)</span>\n<p>Herberthson M., Boito D., Dela Haije T., Feragen A., Westin C.-F.,\nOzarslan E., \u201cQ-space trajectory imaging with positivity constraints\n(QTI+)\u201d in Neuroimage, Volume 238, 2021.\n<a class=\"reference external\" href=\"https://doi.org/10.1016/j.neuroimage.2021.118198\">https://doi.org/10.1016/j.neuroimage.2021.118198</a></p>\n</aside>\n<aside class=\"footnote brackets\" id=\"id9\" role=\"note\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id4\">3</a><span class=\"fn-bracket\">]</span></span>\n<p>F Szczepankiewicz, S Hoge, C-F Westin. Linear, planar and spherical\ntensor-valued diffusion MRI data by free waveform encoding in healthy\nbrain, water, oil and liquid crystals. Data in Brief (2019),\nDOI: <a class=\"reference external\" href=\"https://doi.org/10.1016/j.dib.2019.104208\">https://doi.org/10.1016/j.dib.2019.104208</a></p>\n</aside>\n</aside>\n<p class=\"sphx-glr-timing\"><strong>Total running time of the script:</strong> ( 1163 minutes  56.110 seconds)</p>\n<div class=\"sphx-glr-footer sphx-glr-footer-example docutils container\" id=\"sphx-glr-download-examples-built-07-reconstruction-reconst-qtiplus-py\">\n<div class=\"sphx-glr-download sphx-glr-download-python docutils container\">\n<p><a class=\"reference download internal\" download=\"\" href=\"../../../_downloads/8fcf708c1bfea852ebed60e1b52d2cdf/reconst_qtiplus.py\"><code class=\"xref download docutils literal notranslate\"><span class=\"pre\">Download</span> <span class=\"pre\">Python</span> <span class=\"pre\">source</span> <span class=\"pre\">code:</span> <span class=\"pre\">reconst_qtiplus.py</span></code></a></p>\n</div>\n<div class=\"sphx-glr-download sphx-glr-download-jupyter docutils container\">\n<p><a class=\"reference download internal\" download=\"\" href=\"../../../_downloads/ca2bbc3ff8503af94db9d105287d5a12/reconst_qtiplus.ipynb\"><code class=\"xref download docutils literal notranslate\"><span class=\"pre\">Download</span> <span class=\"pre\">Jupyter</span> <span class=\"pre\">notebook:</span> <span class=\"pre\">reconst_qtiplus.ipynb</span></code></a></p>\n</div>\n</div>\n<p class=\"sphx-glr-signature\"><a class=\"reference external\" href=\"https://sphinx-gallery.github.io\">Gallery generated by Sphinx-Gallery</a></p>\n</section>\n</section>\n</section>\n", "metatags": "<meta name=\"generator\" content=\"Docutils 0.19: https://docutils.sourceforge.io/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["examples_built/07_reconstruction/reconst_shore", "Continuous and analytical diffusion signal modelling with 3D-SHORE", "N", "next"], ["examples_built/07_reconstruction/index", "Reconstruction", "P", "previous"]], "sourcename": "examples_built/07_reconstruction/reconst_qtiplus.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Applying positivity constraints to Q-space Trajectory Imaging (QTI+)</a><ul>\n<li><a class=\"reference internal\" href=\"#theory\">Theory</a></li>\n<li><a class=\"reference internal\" href=\"#installation\">Installation</a></li>\n<li><a class=\"reference internal\" href=\"#usage-example\">Usage example</a><ul>\n<li><a class=\"reference internal\" href=\"#references\">References</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "examples_built/07_reconstruction/reconst_qtiplus", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}
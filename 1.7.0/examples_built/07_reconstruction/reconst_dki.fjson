{"parents": [{"link": "../../../documentation/", "title": "Documentation"}, {"link": "../../", "title": "Examples"}, {"link": "../", "title": "Reconstruction"}], "prev": {"link": "../reconst_dsi_metrics/", "title": "Calculate DSI-based scalar maps"}, "next": {"link": "../kfold_xval/", "title": "K-fold cross-validation for model comparison"}, "title": "Reconstruction of the diffusion signal with the kurtosis tensor model", "meta": null, "body": "<div class=\"sphx-glr-download-link-note admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>Click <a class=\"reference internal\" href=\"#sphx-glr-download-examples-built-07-reconstruction-reconst-dki-py\"><span class=\"std std-ref\">here</span></a>\nto download the full example code</p>\n</div>\n<section class=\"sphx-glr-example-title\" id=\"reconstruction-of-the-diffusion-signal-with-the-kurtosis-tensor-model\">\n<span id=\"sphx-glr-examples-built-07-reconstruction-reconst-dki-py\"></span><h1>Reconstruction of the diffusion signal with the kurtosis tensor model<a class=\"headerlink\" href=\"#reconstruction-of-the-diffusion-signal-with-the-kurtosis-tensor-model\" title=\"Permalink to this heading\">\u00b6</a></h1>\n<p>The diffusion kurtosis model is an expansion of the diffusion tensor model\n(see <span class=\"xref std std-ref\">example_reconst_dti</span>). In addition to the diffusion tensor (DT), the\ndiffusion kurtosis model quantifies the degree to which water diffusion in\nbiological tissues is non-Gaussian using the kurtosis tensor (KT)\n<a class=\"reference internal\" href=\"../reconst_msdki/#jensen2005\" id=\"id1\"><span>[Jensen2005]</span></a>.</p>\n<p>Measurements of non-Gaussian diffusion from the diffusion kurtosis model are of\ninterest because they can be used to characterize tissue microstructural\nheterogeneity <a class=\"reference internal\" href=\"#jensen2010\" id=\"id2\"><span>[Jensen2010]</span></a>. Moreover, DKI can be used to: 1) derive concrete\nbiophysical parameters, such as the density of axonal fibers and diffusion\ntortuosity <a class=\"reference internal\" href=\"../reconst_dki_micro/#fierem2011\" id=\"id3\"><span>[Fierem2011]</span></a> (see <span class=\"xref std std-ref\">example_reconst_dki_micro</span>); and 2)\nresolve crossing fibers in tractography and to obtain invariant rotational\nmeasures not limited to well-aligned fiber populations <a class=\"reference internal\" href=\"../reconst_msdki/#netohe2015\" id=\"id4\"><span>[NetoHe2015]</span></a>.</p>\n<p>The diffusion kurtosis model expresses the diffusion-weighted signal as:</p>\n<div class=\"math notranslate nohighlight\">\n\\[S(n,b)=S_{0}e^{-bD(n)+\\]</div>\n<p>rac{1}{6}b^{2}D(n)^{2}K(n)}</p>\n<p>where <span class=\"math notranslate nohighlight\">\\(\\mathbf{b}\\)</span> is the applied diffusion weighting (which is dependent on\nthe measurement parameters), <span class=\"math notranslate nohighlight\">\\(S_0\\)</span> is the signal in the absence of diffusion\ngradient sensitization, <span class=\"math notranslate nohighlight\">\\(\\mathbf{D(n)}\\)</span> is the value of diffusion along\ndirection <span class=\"math notranslate nohighlight\">\\(\\mathbf{n}\\)</span>, and <span class=\"math notranslate nohighlight\">\\(\\mathbf{K(n)}\\)</span> is the value of kurtosis along\ndirection <span class=\"math notranslate nohighlight\">\\(\\mathbf{n}\\)</span>. The directional diffusion <span class=\"math notranslate nohighlight\">\\(\\mathbf{D(n)}\\)</span> and kurtosis\n<span class=\"math notranslate nohighlight\">\\(\\mathbf{K(n)}\\)</span> can be related to the diffusion tensor (DT) and kurtosis tensor\n(KT) using the following equations:</p>\n<div class=\"math notranslate nohighlight\">\n\\[D(n)=\\sum_{i=1}^{3}\\sum_{j=1}^{3}n_{i}n_{j}D_{ij}\\]</div>\n<p>and</p>\n<div class=\"math notranslate nohighlight\">\n\\[K(n)=\\]</div>\n<dl class=\"simple\">\n<dt>rac{MD^{2}}{D(n)^{2}}sum_{i=1}^{3}sum_{j=1}^{3}sum_{k=1}^{3}</dt><dd><p>sum_{l=1}^{3}n_{i}n_{j}n_{k}n_{l}W_{ijkl}</p>\n</dd>\n</dl>\n<p>where <span class=\"math notranslate nohighlight\">\\(D_{ij}\\)</span> are the elements of the second-order DT, and <span class=\"math notranslate nohighlight\">\\(W_{ijkl}\\)</span> the\nelements of the fourth-order KT and <span class=\"math notranslate nohighlight\">\\(MD\\)</span> is the mean diffusivity. As the DT,\nKT has antipodal symmetry and thus only 15 Wijkl elements are needed to fully\ncharacterize the KT:</p>\n<div class=\"math notranslate nohighlight\">\n\\[\begin{matrix} ( &amp; W_{xxxx} &amp; W_{yyyy} &amp; W_{zzzz} &amp; W_{xxxy} &amp; W_{xxxz}\n                 &amp; ... \\\n                 &amp; W_{xyyy} &amp; W_{yyyz} &amp; W_{xzzz} &amp; W_{yzzz} &amp; W_{xxyy}\n                 &amp; ... \\\n                 &amp; W_{xxzz} &amp; W_{yyzz} &amp; W_{xxyz} &amp; W_{xyyz} &amp; W_{xyzz}\n                 &amp; &amp; )\\end{matrix}\\]</div>\n<p>In the following example we show how to fit the diffusion kurtosis model on\ndiffusion-weighted multi-shell datasets and how to estimate diffusion kurtosis\nbased statistics.</p>\n<p>First, we import all relevant modules:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"kn\">import</span> <span class=\"nn\">dipy.reconst.dki</span> <span class=\"k\">as</span> <span class=\"nn\">dki</span>\n<span class=\"kn\">import</span> <span class=\"nn\">dipy.reconst.dti</span> <span class=\"k\">as</span> <span class=\"nn\">dti</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.core.gradients</span> <span class=\"kn\">import</span> <span class=\"n\">gradient_table</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.data</span> <span class=\"kn\">import</span> <span class=\"n\">get_fnames</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.io.gradients</span> <span class=\"kn\">import</span> <span class=\"n\">read_bvals_bvecs</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.io.image</span> <span class=\"kn\">import</span> <span class=\"n\">load_nifti</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.segment.mask</span> <span class=\"kn\">import</span> <span class=\"n\">median_otsu</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.viz.plotting</span> <span class=\"kn\">import</span> <span class=\"n\">compare_maps</span>\n<span class=\"kn\">from</span> <span class=\"nn\">scipy.ndimage</span> <span class=\"kn\">import</span> <span class=\"n\">gaussian_filter</span>\n</pre></div>\n</div>\n<p>DKI requires multi-shell data, i.e. data acquired from more than one non-zero\nb-value. Here, we use fetch to download a multi-shell dataset which was kindly\nprovided by Hansen and Jespersen (more details about the data are provided in\ntheir paper <a class=\"reference internal\" href=\"../reconst_msdki/#hansen2016\" id=\"id5\"><span>[Hansen2016]</span></a>). The total size of the downloaded data is 192\nMBytes, however you only need to fetch it once.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">fraw</span><span class=\"p\">,</span> <span class=\"n\">fbval</span><span class=\"p\">,</span> <span class=\"n\">fbvec</span><span class=\"p\">,</span> <span class=\"n\">t1_fname</span> <span class=\"o\">=</span> <span class=\"n\">get_fnames</span><span class=\"p\">(</span><span class=\"s1\">&#39;cfin_multib&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">data</span><span class=\"p\">,</span> <span class=\"n\">affine</span> <span class=\"o\">=</span> <span class=\"n\">load_nifti</span><span class=\"p\">(</span><span class=\"n\">fraw</span><span class=\"p\">)</span>\n<span class=\"n\">bvals</span><span class=\"p\">,</span> <span class=\"n\">bvecs</span> <span class=\"o\">=</span> <span class=\"n\">read_bvals_bvecs</span><span class=\"p\">(</span><span class=\"n\">fbval</span><span class=\"p\">,</span> <span class=\"n\">fbvec</span><span class=\"p\">)</span>\n<span class=\"n\">gtab</span> <span class=\"o\">=</span> <span class=\"n\">gradient_table</span><span class=\"p\">(</span><span class=\"n\">bvals</span><span class=\"p\">,</span> <span class=\"n\">bvecs</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Function <code class=\"docutils literal notranslate\"><span class=\"pre\">get_fnames</span></code> downloads and outputs the paths of the data,\n<code class=\"docutils literal notranslate\"><span class=\"pre\">load_nifti</span></code> returns the data as a nibabel Nifti1Image object, and\n<code class=\"docutils literal notranslate\"><span class=\"pre\">read_bvals_bvecs</span></code> loads the arrays containing the information about the\nb-values and b-vectors. These later arrays are converted to the GradientTable\nobject required for <a href=\"#id26\"><span class=\"problematic\" id=\"id27\">Dipy_</span></a>\u2019s data reconstruction.</p>\n<p>Before fitting the data, we perform some data pre-processing. We first compute\na brain mask to avoid unnecessary calculations on the background of the image.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">maskdata</span><span class=\"p\">,</span> <span class=\"n\">mask</span> <span class=\"o\">=</span> <span class=\"n\">median_otsu</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">,</span> <span class=\"n\">vol_idx</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">median_radius</span><span class=\"o\">=</span><span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"n\">numpass</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span>\n                             <span class=\"n\">autocrop</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span> <span class=\"n\">dilate</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Since the diffusion kurtosis models involves the estimation of a large number\nof parameters <a class=\"reference internal\" href=\"#taxcmw2015\" id=\"id6\"><span>[TaxCMW2015]</span></a> and since the non-Gaussian components of the\ndiffusion signal are more sensitive to artefacts <a class=\"reference internal\" href=\"#netohe2012\" id=\"id7\"><span>[NetoHe2012]</span></a>, it might be\nfavorable to suppress the effects of noise and artefacts before diffusion\nkurtosis fitting. In this example the effects of noise and artefacts are\nsuppress by using 3D Gaussian smoothing (with a Gaussian kernel with\nfwhm=1.25) as suggested by pioneer DKI studies (e.g. <a class=\"reference internal\" href=\"../reconst_msdki/#jensen2005\" id=\"id8\"><span>[Jensen2005]</span></a>,\n<a class=\"reference internal\" href=\"#netohe2012\" id=\"id9\"><span>[NetoHe2012]</span></a>). Although here the Gaussian smoothing is used so that results\nare comparable to these studies, it is important to note that more advanced\nnoise and artifact suppression algorithms are available in <a href=\"#id28\"><span class=\"problematic\" id=\"id29\">DIPY_</span></a>, e.g. the\nMarcenko-Pastur PCA denoising algorithm (<span class=\"xref std std-ref\">example-denoise-mppca</span>) and\nthe Gibbs artefact suppression algorithm (<span class=\"xref std std-ref\">example-denoise-gibbs</span>).</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">fwhm</span> <span class=\"o\">=</span> <span class=\"mf\">1.25</span>\n<span class=\"n\">gauss_std</span> <span class=\"o\">=</span> <span class=\"n\">fwhm</span> <span class=\"o\">/</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sqrt</span><span class=\"p\">(</span><span class=\"mi\">8</span> <span class=\"o\">*</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">log</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">))</span>  <span class=\"c1\"># converting fwhm to Gaussian std</span>\n<span class=\"n\">data_smooth</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">zeros</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">)</span>\n<span class=\"k\">for</span> <span class=\"n\">v</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]):</span>\n    <span class=\"n\">data_smooth</span><span class=\"p\">[</span><span class=\"o\">...</span><span class=\"p\">,</span> <span class=\"n\">v</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">gaussian_filter</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">[</span><span class=\"o\">...</span><span class=\"p\">,</span> <span class=\"n\">v</span><span class=\"p\">],</span> <span class=\"n\">sigma</span><span class=\"o\">=</span><span class=\"n\">gauss_std</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Now that we have loaded and pre-processed the data we can go forward\nwith DKI fitting. For this, the DKI model is first defined for the data\u2019s\nGradientTable object by instantiating the DiffusionKurtosisModel object in the\nfollowing way:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">dkimodel</span> <span class=\"o\">=</span> <span class=\"n\">dki</span><span class=\"o\">.</span><span class=\"n\">DiffusionKurtosisModel</span><span class=\"p\">(</span><span class=\"n\">gtab</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>To fit the data using the defined model object, we call the <code class=\"docutils literal notranslate\"><span class=\"pre\">fit</span></code> function of\nthis object. For the purpose of this example, we will only fit a single slice of\nthe data:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">data_smooth</span> <span class=\"o\">=</span> <span class=\"n\">data_smooth</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"mi\">9</span><span class=\"p\">:</span><span class=\"mi\">10</span><span class=\"p\">]</span>\n<span class=\"n\">mask</span> <span class=\"o\">=</span> <span class=\"n\">mask</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"mi\">9</span><span class=\"p\">:</span><span class=\"mi\">10</span><span class=\"p\">]</span>\n<span class=\"n\">dkifit</span> <span class=\"o\">=</span> <span class=\"n\">dkimodel</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">data_smooth</span><span class=\"p\">,</span> <span class=\"n\">mask</span><span class=\"o\">=</span><span class=\"n\">mask</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>  0%|          | 0/3121 [00:00&lt;?, ?it/s]\n  1%|1         | 35/3121 [00:00&lt;00:09, 338.80it/s]\n  2%|2         | 69/3121 [00:00&lt;00:09, 337.16it/s]\n  3%|3         | 109/3121 [00:00&lt;00:08, 365.11it/s]\n  5%|4         | 151/3121 [00:00&lt;00:07, 386.19it/s]\n  6%|6         | 190/3121 [00:00&lt;00:07, 379.52it/s]\n  7%|7         | 228/3121 [00:00&lt;00:07, 368.94it/s]\n  8%|8         | 265/3121 [00:00&lt;00:07, 363.36it/s]\n 10%|9         | 302/3121 [00:00&lt;00:07, 358.74it/s]\n 11%|#         | 340/3121 [00:00&lt;00:07, 364.56it/s]\n 12%|#2        | 377/3121 [00:01&lt;00:07, 350.38it/s]\n 13%|#3        | 415/3121 [00:01&lt;00:07, 358.87it/s]\n 14%|#4        | 452/3121 [00:01&lt;00:07, 361.69it/s]\n 16%|#5        | 489/3121 [00:01&lt;00:07, 362.89it/s]\n 17%|#6        | 526/3121 [00:01&lt;00:07, 330.84it/s]\n 18%|#7        | 560/3121 [00:01&lt;00:09, 267.31it/s]\n 19%|#9        | 601/3121 [00:01&lt;00:08, 300.29it/s]\n 20%|##        | 636/3121 [00:01&lt;00:08, 309.60it/s]\n 22%|##1       | 676/3121 [00:01&lt;00:07, 332.99it/s]\n 23%|##2       | 713/3121 [00:02&lt;00:07, 341.84it/s]\n 24%|##3       | 749/3121 [00:02&lt;00:06, 343.40it/s]\n 25%|##5       | 785/3121 [00:02&lt;00:06, 336.37it/s]\n 26%|##6       | 823/3121 [00:02&lt;00:06, 348.14it/s]\n 28%|##7       | 859/3121 [00:02&lt;00:06, 336.10it/s]\n 29%|##8       | 894/3121 [00:02&lt;00:06, 338.18it/s]\n 30%|##9       | 935/3121 [00:02&lt;00:06, 357.54it/s]\n 31%|###1      | 972/3121 [00:02&lt;00:06, 355.00it/s]\n 32%|###2      | 1008/3121 [00:02&lt;00:06, 334.73it/s]\n 33%|###3      | 1042/3121 [00:03&lt;00:06, 325.84it/s]\n 35%|###4      | 1079/3121 [00:03&lt;00:06, 337.09it/s]\n 36%|###5      | 1120/3121 [00:03&lt;00:05, 353.87it/s]\n 37%|###7      | 1158/3121 [00:03&lt;00:05, 360.81it/s]\n 38%|###8      | 1195/3121 [00:03&lt;00:05, 344.88it/s]\n 39%|###9      | 1231/3121 [00:03&lt;00:05, 348.21it/s]\n 41%|####      | 1267/3121 [00:03&lt;00:05, 349.29it/s]\n 42%|####1     | 1303/3121 [00:03&lt;00:05, 352.31it/s]\n 43%|####2     | 1340/3121 [00:03&lt;00:04, 357.18it/s]\n 44%|####4     | 1376/3121 [00:03&lt;00:05, 343.80it/s]\n 45%|####5     | 1420/3121 [00:04&lt;00:04, 370.73it/s]\n 47%|####6     | 1458/3121 [00:04&lt;00:04, 368.19it/s]\n 48%|####7     | 1495/3121 [00:04&lt;00:04, 361.86it/s]\n 49%|####9     | 1533/3121 [00:04&lt;00:04, 363.12it/s]\n 50%|#####     | 1572/3121 [00:04&lt;00:04, 370.76it/s]\n 52%|#####1    | 1610/3121 [00:04&lt;00:04, 357.42it/s]\n 53%|#####2    | 1646/3121 [00:04&lt;00:04, 358.14it/s]\n 54%|#####3    | 1682/3121 [00:04&lt;00:04, 354.82it/s]\n 55%|#####5    | 1718/3121 [00:04&lt;00:03, 352.59it/s]\n 56%|#####6    | 1754/3121 [00:05&lt;00:03, 352.71it/s]\n 57%|#####7    | 1792/3121 [00:05&lt;00:03, 358.87it/s]\n 59%|#####8    | 1835/3121 [00:05&lt;00:03, 375.04it/s]\n 60%|######    | 1877/3121 [00:05&lt;00:03, 387.78it/s]\n 62%|######1   | 1929/3121 [00:05&lt;00:02, 426.42it/s]\n 63%|######3   | 1977/3121 [00:05&lt;00:02, 441.15it/s]\n 65%|######4   | 2022/3121 [00:05&lt;00:02, 412.38it/s]\n 66%|######6   | 2064/3121 [00:05&lt;00:02, 402.07it/s]\n 67%|######7   | 2105/3121 [00:05&lt;00:02, 400.89it/s]\n 69%|######8   | 2146/3121 [00:05&lt;00:02, 397.00it/s]\n 70%|#######   | 2186/3121 [00:06&lt;00:02, 391.12it/s]\n 71%|#######1  | 2226/3121 [00:06&lt;00:02, 384.75it/s]\n 73%|#######2  | 2266/3121 [00:06&lt;00:02, 387.98it/s]\n 74%|#######3  | 2305/3121 [00:06&lt;00:02, 363.14it/s]\n 75%|#######5  | 2349/3121 [00:06&lt;00:02, 384.32it/s]\n 77%|#######6  | 2388/3121 [00:06&lt;00:01, 380.29it/s]\n 78%|#######7  | 2427/3121 [00:06&lt;00:01, 363.19it/s]\n 79%|#######8  | 2464/3121 [00:06&lt;00:01, 364.09it/s]\n 80%|########  | 2501/3121 [00:06&lt;00:01, 340.54it/s]\n 81%|########1 | 2536/3121 [00:07&lt;00:01, 302.84it/s]\n 83%|########2 | 2579/3121 [00:07&lt;00:01, 335.19it/s]\n 84%|########4 | 2622/3121 [00:07&lt;00:01, 360.61it/s]\n 85%|########5 | 2660/3121 [00:07&lt;00:01, 357.81it/s]\n 87%|########6 | 2700/3121 [00:07&lt;00:01, 368.44it/s]\n 88%|########7 | 2738/3121 [00:07&lt;00:01, 355.93it/s]\n 89%|########8 | 2776/3121 [00:07&lt;00:00, 360.93it/s]\n 90%|######### | 2813/3121 [00:07&lt;00:00, 357.49it/s]\n 91%|#########1| 2851/3121 [00:07&lt;00:00, 363.49it/s]\n 93%|#########2| 2888/3121 [00:08&lt;00:00, 364.11it/s]\n 94%|#########3| 2925/3121 [00:08&lt;00:00, 360.26it/s]\n 95%|#########4| 2962/3121 [00:08&lt;00:00, 360.02it/s]\n 96%|#########6| 3000/3121 [00:08&lt;00:00, 364.95it/s]\n 97%|#########7| 3038/3121 [00:08&lt;00:00, 367.62it/s]\n 99%|#########8| 3086/3121 [00:08&lt;00:00, 396.72it/s]\n100%|##########| 3121/3121 [00:08&lt;00:00, 359.85it/s]\n</pre></div>\n</div>\n<p>The fit method creates a DiffusionKurtosisFit object, which contains all the\ndiffusion and kurtosis fitting parameters and other DKI attributes. For\ninstance, since the diffusion kurtosis model estimates the diffusion tensor,\nall standard diffusion tensor statistics can be computed from the\nDiffusionKurtosisFit instance. For example, we can extract the fractional\nanisotropy (FA), the mean diffusivity (MD), the axial diffusivity (AD) and the\nradial diffusivity (RD) from the DiffusionKurtosisiFit instance. Of course,\nthese measures can also be computed from DIPY\u2019s <code class=\"docutils literal notranslate\"><span class=\"pre\">TensorModel</span></code> fit, and should\nbe analogous; however, theoretically, the diffusion statistics from the kurtosis\nmodel are expected to have better accuracy, since DKI\u2019s diffusion tensor are\ndecoupled from higher order terms effects <a class=\"reference internal\" href=\"#veraar2011\" id=\"id10\"><span>[Veraar2011]</span></a>, <a class=\"reference internal\" href=\"#netohe2012\" id=\"id11\"><span>[NetoHe2012]</span></a>. Below we\ncompare the FA, MD, AD, and RD, computed from both DTI and DKI.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">tenmodel</span> <span class=\"o\">=</span> <span class=\"n\">dti</span><span class=\"o\">.</span><span class=\"n\">TensorModel</span><span class=\"p\">(</span><span class=\"n\">gtab</span><span class=\"p\">)</span>\n<span class=\"n\">tenfit</span> <span class=\"o\">=</span> <span class=\"n\">tenmodel</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">data_smooth</span><span class=\"p\">,</span> <span class=\"n\">mask</span><span class=\"o\">=</span><span class=\"n\">mask</span><span class=\"p\">)</span>\n\n<span class=\"n\">fits</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">tenfit</span><span class=\"p\">,</span> <span class=\"n\">dkifit</span><span class=\"p\">]</span>\n<span class=\"n\">maps</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;fa&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;md&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;ad&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;rd&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">fit_labels</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;DTI&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;DKI&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">map_kwargs</span> <span class=\"o\">=</span> <span class=\"p\">[{</span><span class=\"s1\">&#39;vmax&#39;</span><span class=\"p\">:</span> <span class=\"mf\">0.7</span><span class=\"p\">},</span> <span class=\"p\">{</span><span class=\"s1\">&#39;vmax&#39;</span><span class=\"p\">:</span> <span class=\"mf\">2e-3</span><span class=\"p\">},</span> <span class=\"p\">{</span><span class=\"s1\">&#39;vmax&#39;</span><span class=\"p\">:</span> <span class=\"mf\">2e-3</span><span class=\"p\">},</span> <span class=\"p\">{</span><span class=\"s1\">&#39;vmax&#39;</span><span class=\"p\">:</span> <span class=\"mf\">2e-3</span><span class=\"p\">}]</span>\n<span class=\"n\">compare_maps</span><span class=\"p\">(</span><span class=\"n\">fits</span><span class=\"p\">,</span> <span class=\"n\">maps</span><span class=\"p\">,</span> <span class=\"n\">fit_labels</span><span class=\"o\">=</span><span class=\"n\">fit_labels</span><span class=\"p\">,</span> <span class=\"n\">map_kwargs</span><span class=\"o\">=</span><span class=\"n\">map_kwargs</span><span class=\"p\">,</span>\n             <span class=\"n\">filename</span><span class=\"o\">=</span><span class=\"s1\">&#39;Diffusion_tensor_measures_from_DTI_and_DKI.png&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_reconst_dki_001.png\" srcset=\"../../_images/sphx_glr_reconst_dki_001.png\" alt=\"reconst dki\" class = \"sphx-glr-single-img\"/><figure class=\"align-center\" id=\"id21\">\n<img alt=\"examples_built/07_reconstruction/Diffusion_tensor_measures_from_DTI_and_DKI.png\" src=\"examples_built/07_reconstruction/Diffusion_tensor_measures_from_DTI_and_DKI.png\" />\n<figcaption>\n<p><span class=\"caption-text\">Diffusion tensor measures obtained from the diffusion tensor estimated\nfrom DKI (upper panels) and DTI (lower panels).</span><a class=\"headerlink\" href=\"#id21\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<p>DTI\u2019s diffusion estimates present lower values than DKI\u2019s estimates,\nshowing that DTI\u2019s diffusion measurements are underestimated  by higher order\neffects.</p>\n<p>In addition to the standard diffusion statistics, the DiffusionKurtosisFit\ninstance can be used to estimate the non-Gaussian measures of mean kurtosis\n(MK), the axial kurtosis (AK) and the radial kurtosis (RK).</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">maps</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;mk&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;ak&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;rk&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">compare_maps</span><span class=\"p\">([</span><span class=\"n\">dkifit</span><span class=\"p\">],</span> <span class=\"n\">maps</span><span class=\"p\">,</span> <span class=\"n\">fit_labels</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;DKI&#39;</span><span class=\"p\">],</span>\n             <span class=\"n\">map_kwargs</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">&#39;vmin&#39;</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"s1\">&#39;vmax&#39;</span><span class=\"p\">:</span> <span class=\"mf\">1.5</span><span class=\"p\">},</span>\n             <span class=\"n\">filename</span><span class=\"o\">=</span><span class=\"s1\">&#39;Kurtosis_tensor_standard_measures.png&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_reconst_dki_002.png\" srcset=\"../../_images/sphx_glr_reconst_dki_002.png\" alt=\"reconst dki\" class = \"sphx-glr-single-img\"/><figure class=\"align-center\" id=\"id22\">\n<img alt=\"examples_built/07_reconstruction/Kurtosis_tensor_standard_measures.png\" src=\"examples_built/07_reconstruction/Kurtosis_tensor_standard_measures.png\" />\n<figcaption>\n<p><span class=\"caption-text\">DKI standard kurtosis measures.</span><a class=\"headerlink\" href=\"#id22\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<p>The non-Gaussian behaviour of the diffusion signal is expected to be higher\nwhen tissue water is confined by multiple compartments. MK is, therefore,\nhigher in white matter since it is highly compartmentalized by myelin sheaths.\nThese water diffusion compartmentalization is expected to be more pronounced\nperpendicularly to white matter fibers and thus the RK map presents higher\namplitudes than the AK map.</p>\n<p>It is important to note that kurtosis estimates might present negative estimates\nin deep white matter regions (e.g. the band of dark voxels in the RK map above).\nThese negative kurtosis values are artefactual and might be induced by:\n1) low radial diffusivities of aligned white matter - since it is very hard\nto capture non-Gaussian information in radial direction due to it\u2019s low\ndiffusion decays, radial kurtosis estimates (and consequently the mean\nkurtosis estimates) might have low robustness and tendency to exhibit negative\nvalues <a class=\"reference internal\" href=\"#netohe2012\" id=\"id12\"><span>[NetoHe2012]</span></a>;\n2) Gibbs artefacts - MRI images might be corrupted by signal oscillation\nartefact between tissue\u2019s edges if an inadequate number of high frequencies of\nthe k-space is sampled. These oscillations might have different signs on\nimages acquired with different diffusion-weighted and inducing negative biases\nin kurtosis parametric maps <a class=\"reference internal\" href=\"#perron2015\" id=\"id13\"><span>[Perron2015]</span></a>, <a class=\"reference internal\" href=\"../reconst_msdki/#netohe2018\" id=\"id14\"><span>[NetoHe2018]</span></a>.</p>\n<p>One can try to suppress this issue by using the more advance noise and artefact\nsuppression algorithms, e.g., as mentioned above, the MP-PCA denoising\n(<span class=\"xref std std-ref\">example-denoise-mppca</span>) and Gibbs Unringing\n(<span class=\"xref std std-ref\">example-denoise-gibbs</span>) algorithms. Alternatively, one can overcome this\nartefact by computing the kurtosis values from powder-averaged\ndiffusion-weighted signals. The details on how to compute the kurtosis from\npowder-average signals in dipy are described in follow the tutorial\n(<span class=\"xref std std-ref\">example-reconst-msdki</span>). Finally, one can use constrained optimization to\nensure that the fitted parameters are physically plausible <a class=\"reference internal\" href=\"#delaha2020\" id=\"id15\"><span>[DelaHa2020]</span></a>, as we\nwill illustrate in the next section. Ideally though, artefacts such as Gibbs\nringing should be corrected for as well as possible before using constrained\noptimization.</p>\n<section id=\"constrained-optimization-for-dki\">\n<h2>Constrained optimization for DKI<a class=\"headerlink\" href=\"#constrained-optimization-for-dki\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>When instantiating the DiffusionKurtosisModel, the model can be set up to use\nconstraints with the option <cite>fit_method=\u2019CLS\u2019</cite> (for ordinary least squares) or\nwith <cite>fit_method=\u2019CWLS\u2019</cite> (for weighted least squares). Constrained fitting takes\nmore time than unconstrained fitting, but is generally recommended to prevent\nphysically unplausible parameter estimates <a class=\"reference internal\" href=\"#delaha2020\" id=\"id16\"><span>[DelaHa2020]</span></a>. For performance\npurposes it is recommended to use the MOSEK solver (<a class=\"reference external\" href=\"https://www.mosek.com/\">https://www.mosek.com/</a>) by\nsetting <code class=\"docutils literal notranslate\"><span class=\"pre\">cvxpy_solver='MOSEK'</span></code>. Different solvers can differ greatly in terms\nof runtime and solution accuracy, and in some cases solvers may show warnings\nabout convergence or recommended option settings.</p>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>In certain atypical scenarios, the DKI+ constraints could potentially be\ntoo restrictive. Always check the results of a constrained fit with their\nunconstrained counterpart to verify that there are no unexpected\nqualitative differences.</p>\n</div>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">dkimodel_plus</span> <span class=\"o\">=</span> <span class=\"n\">dki</span><span class=\"o\">.</span><span class=\"n\">DiffusionKurtosisModel</span><span class=\"p\">(</span><span class=\"n\">gtab</span><span class=\"p\">,</span> <span class=\"n\">fit_method</span><span class=\"o\">=</span><span class=\"s1\">&#39;CLS&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">dkifit_plus</span> <span class=\"o\">=</span> <span class=\"n\">dkimodel_plus</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">data_smooth</span><span class=\"p\">,</span> <span class=\"n\">mask</span><span class=\"o\">=</span><span class=\"n\">mask</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>  0%|          | 0/3121 [00:00&lt;?, ?it/s]\n  0%|          | 4/3121 [00:00&lt;01:23, 37.43it/s]\n  0%|          | 10/3121 [00:00&lt;01:02, 50.15it/s]\n  1%|          | 17/3121 [00:00&lt;00:55, 55.77it/s]\n  1%|          | 24/3121 [00:00&lt;00:53, 57.50it/s]\n  1%|          | 31/3121 [00:00&lt;00:52, 58.59it/s]\n  1%|1         | 38/3121 [00:00&lt;00:51, 59.46it/s]\n  1%|1         | 44/3121 [00:00&lt;00:52, 59.04it/s]\n  2%|1         | 51/3121 [00:00&lt;00:51, 60.15it/s]\n  2%|1         | 58/3121 [00:01&lt;00:51, 59.95it/s]\n  2%|2         | 64/3121 [00:01&lt;00:51, 59.09it/s]\n  2%|2         | 71/3121 [00:01&lt;00:50, 59.93it/s]\n  2%|2         | 77/3121 [00:01&lt;00:51, 59.38it/s]\n  3%|2         | 83/3121 [00:01&lt;00:51, 59.46it/s]\n  3%|2         | 89/3121 [00:01&lt;00:57, 52.82it/s]\n  3%|3         | 95/3121 [00:01&lt;00:58, 51.32it/s]\n  3%|3         | 101/3121 [00:01&lt;00:58, 51.97it/s]\n  3%|3         | 108/3121 [00:01&lt;00:54, 54.90it/s]\n  4%|3         | 114/3121 [00:02&lt;00:53, 56.24it/s]\n  4%|3         | 120/3121 [00:02&lt;00:52, 56.88it/s]\n  4%|4         | 127/3121 [00:02&lt;00:51, 57.97it/s]\n  4%|4         | 134/3121 [00:02&lt;00:50, 59.01it/s]\n  4%|4         | 140/3121 [00:02&lt;00:50, 59.16it/s]\n  5%|4         | 147/3121 [00:02&lt;00:49, 59.62it/s]\n  5%|4         | 153/3121 [00:02&lt;00:50, 59.16it/s]\n  5%|5         | 160/3121 [00:02&lt;00:49, 59.68it/s]\n  5%|5         | 167/3121 [00:02&lt;00:49, 59.68it/s]\n  6%|5         | 173/3121 [00:03&lt;00:49, 59.21it/s]\n  6%|5         | 180/3121 [00:03&lt;00:48, 60.36it/s]\n  6%|5         | 187/3121 [00:03&lt;00:49, 59.32it/s]\n  6%|6         | 194/3121 [00:03&lt;00:48, 60.29it/s]\n  6%|6         | 201/3121 [00:03&lt;00:48, 59.69it/s]\n  7%|6         | 207/3121 [00:03&lt;00:48, 59.67it/s]\n  7%|6         | 213/3121 [00:03&lt;00:48, 59.76it/s]\n  7%|7         | 220/3121 [00:03&lt;00:47, 61.27it/s]\n  7%|7         | 227/3121 [00:03&lt;00:48, 60.02it/s]\n  7%|7         | 234/3121 [00:04&lt;00:48, 59.88it/s]\n  8%|7         | 241/3121 [00:04&lt;00:48, 59.60it/s]\n  8%|7         | 248/3121 [00:04&lt;00:47, 60.22it/s]\n  8%|8         | 255/3121 [00:04&lt;00:47, 59.96it/s]\n  8%|8         | 262/3121 [00:04&lt;00:47, 59.83it/s]\n  9%|8         | 268/3121 [00:04&lt;00:47, 59.66it/s]\n  9%|8         | 275/3121 [00:04&lt;00:46, 60.70it/s]\n  9%|9         | 282/3121 [00:04&lt;00:47, 59.67it/s]\n  9%|9         | 288/3121 [00:04&lt;00:49, 57.47it/s]\n  9%|9         | 294/3121 [00:05&lt;00:48, 58.11it/s]\n 10%|9         | 300/3121 [00:05&lt;00:48, 58.51it/s]\n 10%|9         | 306/3121 [00:05&lt;00:50, 55.61it/s]\n 10%|#         | 313/3121 [00:05&lt;00:48, 58.43it/s]\n 10%|#         | 319/3121 [00:05&lt;00:47, 58.57it/s]\n 10%|#         | 325/3121 [00:05&lt;00:48, 58.14it/s]\n 11%|#         | 331/3121 [00:05&lt;00:47, 58.64it/s]\n 11%|#         | 338/3121 [00:05&lt;00:46, 60.08it/s]\n 11%|#1        | 345/3121 [00:05&lt;00:46, 59.60it/s]\n 11%|#1        | 351/3121 [00:06&lt;00:46, 59.29it/s]\n 11%|#1        | 358/3121 [00:06&lt;00:46, 59.45it/s]\n 12%|#1        | 365/3121 [00:06&lt;00:45, 60.56it/s]\n 12%|#1        | 372/3121 [00:06&lt;00:46, 59.69it/s]\n 12%|#2        | 379/3121 [00:06&lt;00:45, 59.79it/s]\n 12%|#2        | 386/3121 [00:06&lt;00:45, 60.17it/s]\n 13%|#2        | 393/3121 [00:06&lt;00:45, 60.28it/s]\n 13%|#2        | 400/3121 [00:06&lt;00:45, 60.13it/s]\n 13%|#3        | 407/3121 [00:06&lt;00:45, 60.06it/s]\n 13%|#3        | 414/3121 [00:07&lt;00:45, 59.72it/s]\n 13%|#3        | 421/3121 [00:07&lt;00:45, 59.50it/s]\n 14%|#3        | 427/3121 [00:07&lt;00:48, 56.06it/s]\n 14%|#3        | 433/3121 [00:07&lt;00:50, 53.72it/s]\n 14%|#4        | 439/3121 [00:07&lt;00:50, 52.87it/s]\n 14%|#4        | 445/3121 [00:07&lt;00:50, 52.80it/s]\n 14%|#4        | 451/3121 [00:07&lt;00:51, 52.31it/s]\n 15%|#4        | 457/3121 [00:07&lt;00:52, 50.99it/s]\n 15%|#4        | 463/3121 [00:08&lt;00:51, 51.26it/s]\n 15%|#5        | 469/3121 [00:08&lt;00:51, 51.59it/s]\n 15%|#5        | 475/3121 [00:08&lt;00:50, 52.25it/s]\n 15%|#5        | 482/3121 [00:08&lt;00:48, 54.81it/s]\n 16%|#5        | 488/3121 [00:08&lt;00:46, 56.10it/s]\n 16%|#5        | 495/3121 [00:08&lt;00:45, 57.20it/s]\n 16%|#6        | 501/3121 [00:08&lt;00:47, 55.68it/s]\n 16%|#6        | 507/3121 [00:08&lt;00:46, 56.56it/s]\n 16%|#6        | 514/3121 [00:08&lt;00:45, 57.77it/s]\n 17%|#6        | 520/3121 [00:09&lt;00:44, 58.30it/s]\n 17%|#6        | 526/3121 [00:09&lt;00:44, 58.66it/s]\n 17%|#7        | 533/3121 [00:09&lt;00:43, 59.29it/s]\n 17%|#7        | 540/3121 [00:09&lt;00:43, 59.62it/s]\n 17%|#7        | 546/3121 [00:09&lt;00:43, 59.52it/s]\n 18%|#7        | 552/3121 [00:09&lt;00:43, 59.32it/s]\n 18%|#7        | 559/3121 [00:09&lt;00:42, 59.88it/s]\n 18%|#8        | 566/3121 [00:09&lt;00:42, 59.80it/s]\n 18%|#8        | 572/3121 [00:09&lt;00:42, 59.44it/s]\n 19%|#8        | 579/3121 [00:09&lt;00:42, 59.95it/s]\n 19%|#8        | 585/3121 [00:10&lt;00:44, 57.52it/s]\n 19%|#8        | 591/3121 [00:10&lt;00:43, 58.12it/s]\n 19%|#9        | 597/3121 [00:10&lt;00:43, 58.46it/s]\n 19%|#9        | 604/3121 [00:10&lt;00:42, 59.18it/s]\n 20%|#9        | 611/3121 [00:10&lt;00:42, 58.75it/s]\n 20%|#9        | 617/3121 [00:10&lt;00:43, 57.03it/s]\n 20%|#9        | 623/3121 [00:10&lt;00:43, 57.84it/s]\n 20%|##        | 629/3121 [00:10&lt;00:42, 58.24it/s]\n 20%|##        | 636/3121 [00:10&lt;00:42, 59.16it/s]\n 21%|##        | 642/3121 [00:11&lt;00:41, 59.28it/s]\n 21%|##        | 649/3121 [00:11&lt;00:41, 59.54it/s]\n 21%|##        | 655/3121 [00:11&lt;00:41, 59.60it/s]\n 21%|##1       | 661/3121 [00:11&lt;00:41, 59.31it/s]\n 21%|##1       | 668/3121 [00:11&lt;00:40, 60.00it/s]\n 22%|##1       | 674/3121 [00:11&lt;00:40, 59.83it/s]\n 22%|##1       | 681/3121 [00:11&lt;00:40, 59.99it/s]\n 22%|##2       | 687/3121 [00:11&lt;00:40, 59.84it/s]\n 22%|##2       | 693/3121 [00:11&lt;00:40, 59.82it/s]\n 22%|##2       | 700/3121 [00:12&lt;00:40, 60.05it/s]\n 23%|##2       | 707/3121 [00:12&lt;00:40, 59.86it/s]\n 23%|##2       | 713/3121 [00:12&lt;00:41, 57.69it/s]\n 23%|##3       | 719/3121 [00:12&lt;00:41, 57.91it/s]\n 23%|##3       | 726/3121 [00:12&lt;00:40, 58.67it/s]\n 23%|##3       | 733/3121 [00:12&lt;00:40, 59.14it/s]\n 24%|##3       | 739/3121 [00:12&lt;00:40, 59.23it/s]\n 24%|##3       | 745/3121 [00:12&lt;00:42, 56.57it/s]\n 24%|##4       | 752/3121 [00:12&lt;00:40, 58.04it/s]\n 24%|##4       | 759/3121 [00:13&lt;00:40, 58.41it/s]\n 25%|##4       | 766/3121 [00:13&lt;00:39, 59.14it/s]\n 25%|##4       | 772/3121 [00:13&lt;00:39, 59.14it/s]\n 25%|##4       | 779/3121 [00:13&lt;00:39, 59.49it/s]\n 25%|##5       | 785/3121 [00:13&lt;00:39, 59.57it/s]\n 25%|##5       | 791/3121 [00:13&lt;00:39, 59.25it/s]\n 26%|##5       | 797/3121 [00:13&lt;00:39, 58.52it/s]\n 26%|##5       | 803/3121 [00:13&lt;00:40, 57.71it/s]\n 26%|##5       | 809/3121 [00:13&lt;00:40, 56.67it/s]\n 26%|##6       | 815/3121 [00:14&lt;00:40, 57.32it/s]\n 26%|##6       | 821/3121 [00:14&lt;00:40, 56.72it/s]\n 27%|##6       | 828/3121 [00:14&lt;00:39, 58.38it/s]\n 27%|##6       | 834/3121 [00:14&lt;00:39, 58.64it/s]\n 27%|##6       | 840/3121 [00:14&lt;00:38, 58.95it/s]\n 27%|##7       | 847/3121 [00:14&lt;00:38, 59.43it/s]\n 27%|##7       | 853/3121 [00:14&lt;00:38, 59.34it/s]\n 28%|##7       | 859/3121 [00:14&lt;00:38, 59.26it/s]\n 28%|##7       | 865/3121 [00:14&lt;00:38, 58.32it/s]\n 28%|##7       | 871/3121 [00:14&lt;00:39, 57.60it/s]\n 28%|##8       | 878/3121 [00:15&lt;00:38, 58.50it/s]\n 28%|##8       | 884/3121 [00:15&lt;00:38, 58.53it/s]\n 29%|##8       | 891/3121 [00:15&lt;00:37, 59.41it/s]\n 29%|##8       | 897/3121 [00:15&lt;00:37, 59.47it/s]\n 29%|##8       | 903/3121 [00:15&lt;00:38, 57.91it/s]\n 29%|##9       | 909/3121 [00:15&lt;00:40, 54.90it/s]\n 29%|##9       | 916/3121 [00:15&lt;00:38, 56.54it/s]\n 30%|##9       | 922/3121 [00:15&lt;00:40, 54.90it/s]\n 30%|##9       | 928/3121 [00:15&lt;00:39, 55.18it/s]\n 30%|##9       | 934/3121 [00:16&lt;00:39, 55.06it/s]\n 30%|###       | 940/3121 [00:16&lt;00:38, 56.28it/s]\n 30%|###       | 946/3121 [00:16&lt;00:37, 57.32it/s]\n 31%|###       | 953/3121 [00:16&lt;00:37, 58.56it/s]\n 31%|###       | 960/3121 [00:16&lt;00:36, 59.38it/s]\n 31%|###       | 966/3121 [00:16&lt;00:36, 58.90it/s]\n 31%|###1      | 972/3121 [00:16&lt;00:36, 59.08it/s]\n 31%|###1      | 978/3121 [00:16&lt;00:36, 59.14it/s]\n 32%|###1      | 984/3121 [00:16&lt;00:36, 57.88it/s]\n 32%|###1      | 990/3121 [00:17&lt;00:36, 57.81it/s]\n 32%|###1      | 996/3121 [00:17&lt;00:36, 58.18it/s]\n 32%|###2      | 1002/3121 [00:17&lt;00:36, 58.61it/s]\n 32%|###2      | 1008/3121 [00:17&lt;00:36, 57.89it/s]\n 32%|###2      | 1014/3121 [00:17&lt;00:36, 58.45it/s]\n 33%|###2      | 1020/3121 [00:17&lt;00:37, 56.70it/s]\n 33%|###2      | 1026/3121 [00:17&lt;00:36, 57.14it/s]\n 33%|###3      | 1032/3121 [00:17&lt;00:36, 57.79it/s]\n 33%|###3      | 1039/3121 [00:17&lt;00:35, 58.68it/s]\n 33%|###3      | 1045/3121 [00:17&lt;00:35, 58.89it/s]\n 34%|###3      | 1052/3121 [00:18&lt;00:35, 58.78it/s]\n 34%|###3      | 1058/3121 [00:18&lt;00:36, 56.62it/s]\n 34%|###4      | 1065/3121 [00:18&lt;00:35, 58.30it/s]\n 34%|###4      | 1071/3121 [00:18&lt;00:35, 58.54it/s]\n 35%|###4      | 1078/3121 [00:18&lt;00:34, 58.97it/s]\n 35%|###4      | 1085/3121 [00:18&lt;00:34, 59.53it/s]\n 35%|###4      | 1091/3121 [00:18&lt;00:34, 59.27it/s]\n 35%|###5      | 1097/3121 [00:18&lt;00:36, 55.21it/s]\n 35%|###5      | 1103/3121 [00:18&lt;00:36, 56.02it/s]\n 36%|###5      | 1109/3121 [00:19&lt;00:35, 56.96it/s]\n 36%|###5      | 1116/3121 [00:19&lt;00:34, 58.58it/s]\n 36%|###5      | 1122/3121 [00:19&lt;00:34, 58.47it/s]\n 36%|###6      | 1128/3121 [00:19&lt;00:34, 58.56it/s]\n 36%|###6      | 1134/3121 [00:19&lt;00:33, 58.92it/s]\n 37%|###6      | 1141/3121 [00:19&lt;00:33, 59.73it/s]\n 37%|###6      | 1147/3121 [00:19&lt;00:33, 59.10it/s]\n 37%|###6      | 1153/3121 [00:19&lt;00:34, 57.15it/s]\n 37%|###7      | 1159/3121 [00:19&lt;00:34, 57.67it/s]\n 37%|###7      | 1166/3121 [00:20&lt;00:33, 58.57it/s]\n 38%|###7      | 1173/3121 [00:20&lt;00:33, 58.83it/s]\n 38%|###7      | 1180/3121 [00:20&lt;00:32, 59.31it/s]\n 38%|###8      | 1186/3121 [00:20&lt;00:32, 59.29it/s]\n 38%|###8      | 1193/3121 [00:20&lt;00:32, 59.41it/s]\n 38%|###8      | 1200/3121 [00:20&lt;00:32, 59.98it/s]\n 39%|###8      | 1206/3121 [00:20&lt;00:32, 59.69it/s]\n 39%|###8      | 1213/3121 [00:20&lt;00:31, 59.98it/s]\n 39%|###9      | 1219/3121 [00:20&lt;00:31, 59.76it/s]\n 39%|###9      | 1225/3121 [00:21&lt;00:32, 58.55it/s]\n 39%|###9      | 1231/3121 [00:21&lt;00:32, 57.85it/s]\n 40%|###9      | 1237/3121 [00:21&lt;00:32, 58.42it/s]\n 40%|###9      | 1243/3121 [00:21&lt;00:31, 58.86it/s]\n 40%|####      | 1250/3121 [00:21&lt;00:31, 59.32it/s]\n 40%|####      | 1257/3121 [00:21&lt;00:31, 59.64it/s]\n 40%|####      | 1263/3121 [00:21&lt;00:31, 59.38it/s]\n 41%|####      | 1269/3121 [00:21&lt;00:31, 59.13it/s]\n 41%|####      | 1276/3121 [00:21&lt;00:30, 60.35it/s]\n 41%|####1     | 1283/3121 [00:22&lt;00:30, 59.40it/s]\n 41%|####1     | 1290/3121 [00:22&lt;00:30, 59.96it/s]\n 42%|####1     | 1296/3121 [00:22&lt;00:30, 59.67it/s]\n 42%|####1     | 1302/3121 [00:22&lt;00:33, 54.77it/s]\n 42%|####1     | 1308/3121 [00:22&lt;00:33, 54.31it/s]\n 42%|####2     | 1314/3121 [00:22&lt;00:32, 55.34it/s]\n 42%|####2     | 1320/3121 [00:22&lt;00:31, 56.41it/s]\n 42%|####2     | 1326/3121 [00:22&lt;00:31, 56.98it/s]\n 43%|####2     | 1333/3121 [00:22&lt;00:30, 58.34it/s]\n 43%|####2     | 1339/3121 [00:23&lt;00:30, 58.78it/s]\n 43%|####3     | 1346/3121 [00:23&lt;00:29, 59.57it/s]\n 43%|####3     | 1352/3121 [00:23&lt;00:29, 59.47it/s]\n 44%|####3     | 1358/3121 [00:23&lt;00:29, 59.48it/s]\n 44%|####3     | 1365/3121 [00:23&lt;00:29, 59.82it/s]\n 44%|####3     | 1371/3121 [00:23&lt;00:29, 59.51it/s]\n 44%|####4     | 1378/3121 [00:23&lt;00:28, 60.23it/s]\n 44%|####4     | 1385/3121 [00:23&lt;00:29, 59.81it/s]\n 45%|####4     | 1392/3121 [00:23&lt;00:28, 60.14it/s]\n 45%|####4     | 1399/3121 [00:24&lt;00:31, 55.10it/s]\n 45%|####5     | 1405/3121 [00:24&lt;00:30, 56.30it/s]\n 45%|####5     | 1411/3121 [00:24&lt;00:29, 57.05it/s]\n 45%|####5     | 1418/3121 [00:24&lt;00:29, 58.41it/s]\n 46%|####5     | 1424/3121 [00:24&lt;00:28, 58.69it/s]\n 46%|####5     | 1430/3121 [00:24&lt;00:28, 58.40it/s]\n 46%|####6     | 1437/3121 [00:24&lt;00:28, 59.49it/s]\n 46%|####6     | 1444/3121 [00:24&lt;00:27, 59.91it/s]\n 46%|####6     | 1450/3121 [00:24&lt;00:28, 59.64it/s]\n 47%|####6     | 1457/3121 [00:25&lt;00:27, 59.78it/s]\n 47%|####6     | 1464/3121 [00:25&lt;00:27, 60.06it/s]\n 47%|####7     | 1471/3121 [00:25&lt;00:27, 60.10it/s]\n 47%|####7     | 1478/3121 [00:25&lt;00:27, 59.84it/s]\n 48%|####7     | 1484/3121 [00:25&lt;00:27, 59.80it/s]\n 48%|####7     | 1490/3121 [00:25&lt;00:27, 58.86it/s]\n 48%|####7     | 1497/3121 [00:25&lt;00:26, 60.25it/s]\n 48%|####8     | 1504/3121 [00:25&lt;00:26, 60.08it/s]\n 48%|####8     | 1511/3121 [00:25&lt;00:26, 59.87it/s]\n 49%|####8     | 1518/3121 [00:26&lt;00:26, 60.36it/s]\n 49%|####8     | 1525/3121 [00:26&lt;00:26, 59.69it/s]\n 49%|####9     | 1532/3121 [00:26&lt;00:26, 60.26it/s]\n 49%|####9     | 1539/3121 [00:26&lt;00:26, 60.37it/s]\n 50%|####9     | 1546/3121 [00:26&lt;00:26, 59.35it/s]\n 50%|####9     | 1553/3121 [00:26&lt;00:25, 60.32it/s]\n 50%|####9     | 1560/3121 [00:26&lt;00:25, 60.07it/s]\n 50%|#####     | 1567/3121 [00:26&lt;00:26, 59.04it/s]\n 50%|#####     | 1573/3121 [00:26&lt;00:26, 57.69it/s]\n 51%|#####     | 1579/3121 [00:27&lt;00:26, 57.87it/s]\n 51%|#####     | 1586/3121 [00:27&lt;00:25, 59.22it/s]\n 51%|#####1    | 1592/3121 [00:27&lt;00:25, 59.04it/s]\n 51%|#####1    | 1599/3121 [00:27&lt;00:25, 59.98it/s]\n 51%|#####1    | 1605/3121 [00:27&lt;00:25, 59.72it/s]\n 52%|#####1    | 1611/3121 [00:27&lt;00:26, 56.96it/s]\n 52%|#####1    | 1618/3121 [00:27&lt;00:25, 57.96it/s]\n 52%|#####2    | 1624/3121 [00:27&lt;00:25, 58.45it/s]\n 52%|#####2    | 1631/3121 [00:27&lt;00:25, 58.91it/s]\n 52%|#####2    | 1637/3121 [00:28&lt;00:25, 58.33it/s]\n 53%|#####2    | 1644/3121 [00:28&lt;00:24, 59.74it/s]\n 53%|#####2    | 1651/3121 [00:28&lt;00:24, 60.04it/s]\n 53%|#####3    | 1658/3121 [00:28&lt;00:24, 60.02it/s]\n 53%|#####3    | 1665/3121 [00:28&lt;00:24, 59.91it/s]\n 54%|#####3    | 1672/3121 [00:28&lt;00:24, 60.12it/s]\n 54%|#####3    | 1679/3121 [00:28&lt;00:23, 60.13it/s]\n 54%|#####4    | 1686/3121 [00:28&lt;00:24, 59.72it/s]\n 54%|#####4    | 1693/3121 [00:28&lt;00:23, 60.11it/s]\n 54%|#####4    | 1700/3121 [00:29&lt;00:23, 59.76it/s]\n 55%|#####4    | 1706/3121 [00:29&lt;00:23, 59.79it/s]\n 55%|#####4    | 1713/3121 [00:29&lt;00:23, 60.03it/s]\n 55%|#####5    | 1720/3121 [00:29&lt;00:23, 60.18it/s]\n 55%|#####5    | 1727/3121 [00:29&lt;00:23, 59.71it/s]\n 56%|#####5    | 1734/3121 [00:29&lt;00:23, 60.16it/s]\n 56%|#####5    | 1741/3121 [00:29&lt;00:23, 59.96it/s]\n 56%|#####5    | 1747/3121 [00:29&lt;00:23, 59.52it/s]\n 56%|#####6    | 1754/3121 [00:29&lt;00:22, 60.30it/s]\n 56%|#####6    | 1761/3121 [00:30&lt;00:23, 57.48it/s]\n 57%|#####6    | 1767/3121 [00:30&lt;00:24, 55.77it/s]\n 57%|#####6    | 1773/3121 [00:30&lt;00:23, 56.72it/s]\n 57%|#####7    | 1780/3121 [00:30&lt;00:23, 57.96it/s]\n 57%|#####7    | 1786/3121 [00:30&lt;00:22, 58.36it/s]\n 57%|#####7    | 1793/3121 [00:30&lt;00:22, 58.80it/s]\n 58%|#####7    | 1800/3121 [00:30&lt;00:22, 59.15it/s]\n 58%|#####7    | 1807/3121 [00:30&lt;00:22, 59.52it/s]\n 58%|#####8    | 1813/3121 [00:31&lt;00:22, 59.41it/s]\n 58%|#####8    | 1820/3121 [00:31&lt;00:21, 60.04it/s]\n 59%|#####8    | 1827/3121 [00:31&lt;00:21, 59.79it/s]\n 59%|#####8    | 1834/3121 [00:31&lt;00:21, 59.63it/s]\n 59%|#####8    | 1840/3121 [00:31&lt;00:21, 59.62it/s]\n 59%|#####9    | 1847/3121 [00:31&lt;00:21, 60.18it/s]\n 59%|#####9    | 1854/3121 [00:31&lt;00:21, 60.08it/s]\n 60%|#####9    | 1861/3121 [00:31&lt;00:21, 59.98it/s]\n 60%|#####9    | 1868/3121 [00:31&lt;00:20, 60.00it/s]\n 60%|######    | 1875/3121 [00:32&lt;00:20, 60.13it/s]\n 60%|######    | 1882/3121 [00:32&lt;00:20, 60.16it/s]\n 61%|######    | 1889/3121 [00:32&lt;00:20, 59.80it/s]\n 61%|######    | 1895/3121 [00:32&lt;00:20, 59.54it/s]\n 61%|######    | 1901/3121 [00:32&lt;00:20, 59.50it/s]\n 61%|######1   | 1907/3121 [00:32&lt;00:20, 59.54it/s]\n 61%|######1   | 1914/3121 [00:32&lt;00:20, 60.22it/s]\n 62%|######1   | 1921/3121 [00:32&lt;00:19, 60.14it/s]\n 62%|######1   | 1928/3121 [00:32&lt;00:20, 58.23it/s]\n 62%|######1   | 1934/3121 [00:33&lt;00:20, 57.81it/s]\n 62%|######2   | 1940/3121 [00:33&lt;00:20, 58.29it/s]\n 62%|######2   | 1946/3121 [00:33&lt;00:20, 58.53it/s]\n 63%|######2   | 1953/3121 [00:33&lt;00:19, 59.43it/s]\n 63%|######2   | 1959/3121 [00:33&lt;00:21, 54.02it/s]\n 63%|######2   | 1965/3121 [00:33&lt;00:20, 55.25it/s]\n 63%|######3   | 1972/3121 [00:33&lt;00:19, 57.50it/s]\n 63%|######3   | 1979/3121 [00:33&lt;00:19, 58.43it/s]\n 64%|######3   | 1986/3121 [00:33&lt;00:19, 59.11it/s]\n 64%|######3   | 1992/3121 [00:34&lt;00:19, 58.99it/s]\n 64%|######4   | 1998/3121 [00:34&lt;00:18, 59.22it/s]\n 64%|######4   | 2005/3121 [00:34&lt;00:18, 59.40it/s]\n 64%|######4   | 2012/3121 [00:34&lt;00:18, 59.57it/s]\n 65%|######4   | 2018/3121 [00:34&lt;00:18, 59.49it/s]\n 65%|######4   | 2025/3121 [00:34&lt;00:18, 60.04it/s]\n 65%|######5   | 2032/3121 [00:34&lt;00:18, 60.07it/s]\n 65%|######5   | 2039/3121 [00:34&lt;00:18, 59.94it/s]\n 66%|######5   | 2046/3121 [00:34&lt;00:17, 60.24it/s]\n 66%|######5   | 2053/3121 [00:35&lt;00:17, 59.92it/s]\n 66%|######6   | 2060/3121 [00:35&lt;00:17, 60.33it/s]\n 66%|######6   | 2067/3121 [00:35&lt;00:17, 59.59it/s]\n 66%|######6   | 2074/3121 [00:35&lt;00:17, 60.31it/s]\n 67%|######6   | 2081/3121 [00:35&lt;00:17, 59.81it/s]\n 67%|######6   | 2087/3121 [00:35&lt;00:17, 59.76it/s]\n 67%|######7   | 2094/3121 [00:35&lt;00:17, 59.77it/s]\n 67%|######7   | 2101/3121 [00:35&lt;00:16, 60.17it/s]\n 68%|######7   | 2108/3121 [00:35&lt;00:16, 59.91it/s]\n 68%|######7   | 2115/3121 [00:36&lt;00:16, 60.49it/s]\n 68%|######7   | 2122/3121 [00:36&lt;00:16, 59.69it/s]\n 68%|######8   | 2129/3121 [00:36&lt;00:16, 59.89it/s]\n 68%|######8   | 2135/3121 [00:36&lt;00:16, 59.65it/s]\n 69%|######8   | 2142/3121 [00:36&lt;00:16, 60.09it/s]\n 69%|######8   | 2149/3121 [00:36&lt;00:16, 60.16it/s]\n 69%|######9   | 2156/3121 [00:36&lt;00:16, 60.27it/s]\n 69%|######9   | 2163/3121 [00:36&lt;00:16, 59.51it/s]\n 70%|######9   | 2170/3121 [00:37&lt;00:15, 60.03it/s]\n 70%|######9   | 2177/3121 [00:37&lt;00:15, 60.04it/s]\n 70%|######9   | 2184/3121 [00:37&lt;00:15, 60.27it/s]\n 70%|#######   | 2191/3121 [00:37&lt;00:15, 59.50it/s]\n 70%|#######   | 2198/3121 [00:37&lt;00:15, 60.05it/s]\n 71%|#######   | 2205/3121 [00:37&lt;00:15, 59.69it/s]\n 71%|#######   | 2212/3121 [00:37&lt;00:15, 59.96it/s]\n 71%|#######1  | 2219/3121 [00:37&lt;00:14, 60.50it/s]\n 71%|#######1  | 2226/3121 [00:37&lt;00:14, 60.37it/s]\n 72%|#######1  | 2233/3121 [00:38&lt;00:14, 60.21it/s]\n 72%|#######1  | 2240/3121 [00:38&lt;00:14, 60.08it/s]\n 72%|#######1  | 2247/3121 [00:38&lt;00:14, 60.14it/s]\n 72%|#######2  | 2254/3121 [00:38&lt;00:14, 59.80it/s]\n 72%|#######2  | 2260/3121 [00:38&lt;00:14, 59.46it/s]\n 73%|#######2  | 2267/3121 [00:38&lt;00:14, 59.69it/s]\n 73%|#######2  | 2274/3121 [00:38&lt;00:13, 60.61it/s]\n 73%|#######3  | 2281/3121 [00:38&lt;00:14, 59.38it/s]\n 73%|#######3  | 2288/3121 [00:38&lt;00:13, 60.23it/s]\n 74%|#######3  | 2295/3121 [00:39&lt;00:13, 60.46it/s]\n 74%|#######3  | 2302/3121 [00:39&lt;00:13, 59.73it/s]\n 74%|#######3  | 2308/3121 [00:39&lt;00:13, 59.42it/s]\n 74%|#######4  | 2315/3121 [00:39&lt;00:13, 60.54it/s]\n 74%|#######4  | 2322/3121 [00:39&lt;00:13, 60.13it/s]\n 75%|#######4  | 2329/3121 [00:39&lt;00:13, 60.02it/s]\n 75%|#######4  | 2336/3121 [00:39&lt;00:13, 59.78it/s]\n 75%|#######5  | 2342/3121 [00:39&lt;00:13, 59.41it/s]\n 75%|#######5  | 2348/3121 [00:39&lt;00:12, 59.53it/s]\n 75%|#######5  | 2355/3121 [00:40&lt;00:12, 60.17it/s]\n 76%|#######5  | 2362/3121 [00:40&lt;00:12, 60.71it/s]\n 76%|#######5  | 2369/3121 [00:40&lt;00:12, 59.96it/s]\n 76%|#######6  | 2376/3121 [00:40&lt;00:12, 60.24it/s]\n 76%|#######6  | 2383/3121 [00:40&lt;00:12, 59.91it/s]\n 77%|#######6  | 2390/3121 [00:40&lt;00:12, 60.27it/s]\n 77%|#######6  | 2397/3121 [00:40&lt;00:12, 60.16it/s]\n 77%|#######7  | 2404/3121 [00:40&lt;00:11, 59.83it/s]\n 77%|#######7  | 2410/3121 [00:41&lt;00:11, 59.84it/s]\n 77%|#######7  | 2417/3121 [00:41&lt;00:11, 60.06it/s]\n 78%|#######7  | 2424/3121 [00:41&lt;00:11, 60.05it/s]\n 78%|#######7  | 2431/3121 [00:41&lt;00:11, 59.96it/s]\n 78%|#######8  | 2438/3121 [00:41&lt;00:11, 60.26it/s]\n 78%|#######8  | 2445/3121 [00:41&lt;00:11, 59.67it/s]\n 79%|#######8  | 2452/3121 [00:41&lt;00:11, 60.32it/s]\n 79%|#######8  | 2459/3121 [00:41&lt;00:11, 56.97it/s]\n 79%|#######8  | 2465/3121 [00:41&lt;00:11, 55.39it/s]\n 79%|#######9  | 2472/3121 [00:42&lt;00:11, 57.32it/s]\n 79%|#######9  | 2478/3121 [00:42&lt;00:11, 56.31it/s]\n 80%|#######9  | 2484/3121 [00:42&lt;00:11, 55.33it/s]\n 80%|#######9  | 2491/3121 [00:42&lt;00:10, 57.64it/s]\n 80%|########  | 2498/3121 [00:42&lt;00:10, 57.96it/s]\n 80%|########  | 2505/3121 [00:42&lt;00:10, 59.29it/s]\n 80%|########  | 2511/3121 [00:42&lt;00:10, 59.22it/s]\n 81%|########  | 2518/3121 [00:42&lt;00:10, 60.22it/s]\n 81%|########  | 2525/3121 [00:42&lt;00:10, 59.57it/s]\n 81%|########1 | 2531/3121 [00:43&lt;00:10, 58.79it/s]\n 81%|########1 | 2538/3121 [00:43&lt;00:09, 60.09it/s]\n 82%|########1 | 2545/3121 [00:43&lt;00:09, 59.81it/s]\n 82%|########1 | 2552/3121 [00:43&lt;00:09, 60.12it/s]\n 82%|########1 | 2559/3121 [00:43&lt;00:09, 58.84it/s]\n 82%|########2 | 2565/3121 [00:43&lt;00:09, 57.67it/s]\n 82%|########2 | 2571/3121 [00:43&lt;00:09, 58.21it/s]\n 83%|########2 | 2577/3121 [00:43&lt;00:09, 56.63it/s]\n 83%|########2 | 2583/3121 [00:43&lt;00:09, 56.92it/s]\n 83%|########2 | 2589/3121 [00:44&lt;00:09, 56.98it/s]\n 83%|########3 | 2595/3121 [00:44&lt;00:09, 56.66it/s]\n 83%|########3 | 2601/3121 [00:44&lt;00:09, 57.02it/s]\n 84%|########3 | 2607/3121 [00:44&lt;00:08, 57.59it/s]\n 84%|########3 | 2614/3121 [00:44&lt;00:08, 58.71it/s]\n 84%|########3 | 2620/3121 [00:44&lt;00:08, 58.84it/s]\n 84%|########4 | 2627/3121 [00:44&lt;00:08, 59.52it/s]\n 84%|########4 | 2633/3121 [00:44&lt;00:08, 59.40it/s]\n 85%|########4 | 2640/3121 [00:44&lt;00:08, 59.78it/s]\n 85%|########4 | 2646/3121 [00:45&lt;00:07, 59.73it/s]\n 85%|########5 | 2653/3121 [00:45&lt;00:07, 60.01it/s]\n 85%|########5 | 2660/3121 [00:45&lt;00:07, 59.85it/s]\n 85%|########5 | 2667/3121 [00:45&lt;00:07, 60.14it/s]\n 86%|########5 | 2674/3121 [00:45&lt;00:07, 59.94it/s]\n 86%|########5 | 2680/3121 [00:45&lt;00:07, 59.86it/s]\n 86%|########6 | 2686/3121 [00:45&lt;00:07, 59.36it/s]\n 86%|########6 | 2693/3121 [00:45&lt;00:07, 60.35it/s]\n 87%|########6 | 2700/3121 [00:45&lt;00:07, 60.00it/s]\n 87%|########6 | 2706/3121 [00:46&lt;00:06, 59.58it/s]\n 87%|########6 | 2712/3121 [00:46&lt;00:06, 59.67it/s]\n 87%|########7 | 2719/3121 [00:46&lt;00:06, 60.24it/s]\n 87%|########7 | 2726/3121 [00:46&lt;00:06, 59.74it/s]\n 88%|########7 | 2732/3121 [00:46&lt;00:06, 59.55it/s]\n 88%|########7 | 2739/3121 [00:46&lt;00:06, 60.61it/s]\n 88%|########7 | 2746/3121 [00:46&lt;00:06, 59.64it/s]\n 88%|########8 | 2753/3121 [00:46&lt;00:06, 59.90it/s]\n 88%|########8 | 2760/3121 [00:46&lt;00:05, 60.21it/s]\n 89%|########8 | 2767/3121 [00:47&lt;00:05, 60.40it/s]\n 89%|########8 | 2774/3121 [00:47&lt;00:05, 59.52it/s]\n 89%|########9 | 2780/3121 [00:47&lt;00:05, 57.41it/s]\n 89%|########9 | 2786/3121 [00:47&lt;00:06, 55.35it/s]\n 89%|########9 | 2792/3121 [00:47&lt;00:06, 53.42it/s]\n 90%|########9 | 2799/3121 [00:47&lt;00:05, 55.68it/s]\n 90%|########9 | 2805/3121 [00:47&lt;00:05, 56.32it/s]\n 90%|######### | 2811/3121 [00:47&lt;00:05, 57.25it/s]\n 90%|######### | 2817/3121 [00:47&lt;00:05, 56.67it/s]\n 90%|######### | 2824/3121 [00:48&lt;00:05, 57.90it/s]\n 91%|######### | 2830/3121 [00:48&lt;00:04, 58.22it/s]\n 91%|######### | 2837/3121 [00:48&lt;00:04, 59.23it/s]\n 91%|#########1| 2843/3121 [00:48&lt;00:04, 56.48it/s]\n 91%|#########1| 2850/3121 [00:48&lt;00:04, 57.89it/s]\n 92%|#########1| 2856/3121 [00:48&lt;00:04, 58.20it/s]\n 92%|#########1| 2863/3121 [00:48&lt;00:04, 58.88it/s]\n 92%|#########1| 2869/3121 [00:48&lt;00:04, 56.50it/s]\n 92%|#########2| 2876/3121 [00:48&lt;00:04, 57.59it/s]\n 92%|#########2| 2882/3121 [00:49&lt;00:04, 58.02it/s]\n 93%|#########2| 2889/3121 [00:49&lt;00:03, 58.99it/s]\n 93%|#########2| 2896/3121 [00:49&lt;00:03, 59.22it/s]\n 93%|#########3| 2903/3121 [00:49&lt;00:03, 59.57it/s]\n 93%|#########3| 2909/3121 [00:49&lt;00:03, 55.76it/s]\n 93%|#########3| 2915/3121 [00:49&lt;00:05, 38.68it/s]\n 94%|#########3| 2921/3121 [00:49&lt;00:04, 41.81it/s]\n 94%|#########3| 2927/3121 [00:50&lt;00:04, 45.67it/s]\n 94%|#########4| 2934/3121 [00:50&lt;00:03, 49.31it/s]\n 94%|#########4| 2940/3121 [00:50&lt;00:03, 50.29it/s]\n 94%|#########4| 2946/3121 [00:50&lt;00:03, 51.85it/s]\n 95%|#########4| 2952/3121 [00:50&lt;00:03, 53.99it/s]\n 95%|#########4| 2959/3121 [00:50&lt;00:02, 56.15it/s]\n 95%|#########5| 2965/3121 [00:50&lt;00:02, 56.74it/s]\n 95%|#########5| 2971/3121 [00:50&lt;00:02, 57.59it/s]\n 95%|#########5| 2977/3121 [00:50&lt;00:02, 58.06it/s]\n 96%|#########5| 2983/3121 [00:51&lt;00:02, 56.54it/s]\n 96%|#########5| 2989/3121 [00:51&lt;00:02, 57.25it/s]\n 96%|#########5| 2996/3121 [00:51&lt;00:02, 58.17it/s]\n 96%|#########6| 3002/3121 [00:51&lt;00:02, 58.45it/s]\n 96%|#########6| 3009/3121 [00:51&lt;00:01, 59.19it/s]\n 97%|#########6| 3016/3121 [00:51&lt;00:01, 59.07it/s]\n 97%|#########6| 3023/3121 [00:51&lt;00:01, 59.90it/s]\n 97%|#########7| 3029/3121 [00:51&lt;00:01, 59.27it/s]\n 97%|#########7| 3036/3121 [00:51&lt;00:01, 60.03it/s]\n 98%|#########7| 3043/3121 [00:52&lt;00:01, 59.94it/s]\n 98%|#########7| 3050/3121 [00:52&lt;00:01, 60.19it/s]\n 98%|#########7| 3057/3121 [00:52&lt;00:01, 59.38it/s]\n 98%|#########8| 3064/3121 [00:52&lt;00:00, 60.27it/s]\n 98%|#########8| 3071/3121 [00:52&lt;00:00, 59.76it/s]\n 99%|#########8| 3077/3121 [00:52&lt;00:00, 59.81it/s]\n 99%|#########8| 3084/3121 [00:52&lt;00:00, 59.53it/s]\n 99%|#########9| 3090/3121 [00:52&lt;00:00, 59.63it/s]\n 99%|#########9| 3097/3121 [00:52&lt;00:00, 59.98it/s]\n 99%|#########9| 3103/3121 [00:53&lt;00:00, 59.86it/s]\n100%|#########9| 3110/3121 [00:53&lt;00:00, 60.07it/s]\n100%|#########9| 3117/3121 [00:53&lt;00:00, 58.77it/s]\n100%|##########| 3121/3121 [00:53&lt;00:00, 58.52it/s]\n</pre></div>\n</div>\n<p>We can now compare the kurtosis measures obtained with the constrained fit to\nthe measures obtained before, where we see that many of the artefactual voxels\nhave now been corrected. In particular outliers caused by pure noise \u2013 instead\nof for example acquisition artefacts \u2013 can be corrected with this method.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">compare_maps</span><span class=\"p\">([</span><span class=\"n\">dkifit_plus</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"s1\">&#39;mk&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;ak&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;rk&#39;</span><span class=\"p\">],</span> <span class=\"n\">fit_labels</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;DKI+&#39;</span><span class=\"p\">],</span>\n             <span class=\"n\">filename</span><span class=\"o\">=</span><span class=\"s1\">&#39;Kurtosis_tensor_standard_measures_plus.png&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_reconst_dki_003.png\" srcset=\"../../_images/sphx_glr_reconst_dki_003.png\" alt=\"reconst dki\" class = \"sphx-glr-single-img\"/><figure class=\"align-center\" id=\"id23\">\n<img alt=\"examples_built/07_reconstruction/Kurtosis_tensor_standard_measures_plus.png\" src=\"examples_built/07_reconstruction/Kurtosis_tensor_standard_measures_plus.png\" />\n<figcaption>\n<p><span class=\"caption-text\">DKI standard kurtosis measures obtained with constrained optimization.</span><a class=\"headerlink\" href=\"#id23\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<p>When using constrained optimization, the expected range of the kurtosis measures\nis also naturally constrained, and so does not typically require additional\nclipping.</p>\n<p>Finally, constrained optimization obviates the need for smoothing in many cases:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">dkifit_noisy</span> <span class=\"o\">=</span> <span class=\"n\">dkimodel</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"mi\">9</span><span class=\"p\">:</span><span class=\"mi\">10</span><span class=\"p\">],</span> <span class=\"n\">mask</span><span class=\"o\">=</span><span class=\"n\">mask</span><span class=\"p\">)</span>\n<span class=\"n\">dkifit_noisy_plus</span> <span class=\"o\">=</span> <span class=\"n\">dkimodel_plus</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"mi\">9</span><span class=\"p\">:</span><span class=\"mi\">10</span><span class=\"p\">],</span> <span class=\"n\">mask</span><span class=\"o\">=</span><span class=\"n\">mask</span><span class=\"p\">)</span>\n\n<span class=\"n\">compare_maps</span><span class=\"p\">([</span><span class=\"n\">dkifit_noisy</span><span class=\"p\">,</span> <span class=\"n\">dkifit_noisy_plus</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"s1\">&#39;mk&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;ak&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;rk&#39;</span><span class=\"p\">],</span>\n             <span class=\"n\">fit_labels</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;DKI&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;DKI+&#39;</span><span class=\"p\">],</span> <span class=\"n\">map_kwargs</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">&#39;vmin&#39;</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"s1\">&#39;vmax&#39;</span><span class=\"p\">:</span> <span class=\"mf\">1.5</span><span class=\"p\">},</span>\n             <span class=\"n\">filename</span><span class=\"o\">=</span><span class=\"s1\">&#39;Kurtosis_tensor_standard_measures_noisy.png&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_reconst_dki_004.png\" srcset=\"../../_images/sphx_glr_reconst_dki_004.png\" alt=\"reconst dki\" class = \"sphx-glr-single-img\"/><div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>  0%|          | 0/3121 [00:00&lt;?, ?it/s]\n  1%|1         | 39/3121 [00:00&lt;00:08, 380.26it/s]\n  2%|2         | 78/3121 [00:00&lt;00:08, 374.55it/s]\n  4%|3         | 117/3121 [00:00&lt;00:07, 376.04it/s]\n  5%|4         | 155/3121 [00:00&lt;00:07, 376.54it/s]\n  6%|6         | 193/3121 [00:00&lt;00:07, 373.81it/s]\n  7%|7         | 233/3121 [00:00&lt;00:07, 381.15it/s]\n  9%|8         | 273/3121 [00:00&lt;00:07, 379.81it/s]\n 10%|9         | 311/3121 [00:00&lt;00:07, 378.77it/s]\n 11%|#1        | 351/3121 [00:00&lt;00:07, 375.52it/s]\n 12%|#2        | 389/3121 [00:01&lt;00:07, 368.90it/s]\n 14%|#3        | 432/3121 [00:01&lt;00:06, 384.55it/s]\n 15%|#5        | 471/3121 [00:01&lt;00:06, 382.03it/s]\n 16%|#6        | 513/3121 [00:01&lt;00:06, 392.37it/s]\n 18%|#7        | 556/3121 [00:01&lt;00:06, 401.17it/s]\n 19%|#9        | 601/3121 [00:01&lt;00:06, 415.36it/s]\n 21%|##        | 643/3121 [00:01&lt;00:06, 404.38it/s]\n 22%|##1       | 684/3121 [00:01&lt;00:06, 397.76it/s]\n 23%|##3       | 724/3121 [00:01&lt;00:07, 321.39it/s]\n 24%|##4       | 761/3121 [00:02&lt;00:07, 333.11it/s]\n 26%|##6       | 812/3121 [00:02&lt;00:06, 378.40it/s]\n 27%|##7       | 852/3121 [00:02&lt;00:06, 375.75it/s]\n 29%|##8       | 891/3121 [00:02&lt;00:05, 377.38it/s]\n 30%|##9       | 930/3121 [00:02&lt;00:05, 378.30it/s]\n 31%|###1      | 970/3121 [00:02&lt;00:05, 382.41it/s]\n 32%|###2      | 1010/3121 [00:02&lt;00:05, 385.68it/s]\n 34%|###3      | 1049/3121 [00:02&lt;00:05, 378.20it/s]\n 35%|###4      | 1090/3121 [00:02&lt;00:05, 386.69it/s]\n 36%|###6      | 1129/3121 [00:02&lt;00:05, 380.11it/s]\n 37%|###7      | 1168/3121 [00:03&lt;00:05, 371.11it/s]\n 39%|###8      | 1209/3121 [00:03&lt;00:05, 380.50it/s]\n 40%|###9      | 1248/3121 [00:03&lt;00:05, 364.36it/s]\n 41%|####1     | 1285/3121 [00:03&lt;00:05, 361.50it/s]\n 42%|####2     | 1325/3121 [00:03&lt;00:04, 366.84it/s]\n 44%|####3     | 1369/3121 [00:03&lt;00:04, 386.18it/s]\n 45%|####5     | 1412/3121 [00:03&lt;00:04, 397.72it/s]\n 47%|####6     | 1452/3121 [00:03&lt;00:04, 396.49it/s]\n 48%|####7     | 1492/3121 [00:03&lt;00:04, 390.89it/s]\n 49%|####9     | 1532/3121 [00:04&lt;00:04, 384.16it/s]\n 50%|#####     | 1571/3121 [00:04&lt;00:04, 385.34it/s]\n 52%|#####1    | 1610/3121 [00:04&lt;00:03, 386.50it/s]\n 53%|#####2    | 1649/3121 [00:04&lt;00:03, 386.69it/s]\n 54%|#####4    | 1688/3121 [00:04&lt;00:03, 378.06it/s]\n 55%|#####5    | 1726/3121 [00:04&lt;00:03, 368.38it/s]\n 57%|#####6    | 1766/3121 [00:04&lt;00:03, 377.45it/s]\n 58%|#####7    | 1804/3121 [00:04&lt;00:03, 354.78it/s]\n 59%|#####8    | 1840/3121 [00:04&lt;00:03, 334.03it/s]\n 60%|######    | 1874/3121 [00:05&lt;00:03, 327.09it/s]\n 61%|######1   | 1917/3121 [00:05&lt;00:03, 353.93it/s]\n 63%|######2   | 1958/3121 [00:05&lt;00:03, 368.99it/s]\n 64%|######4   | 2001/3121 [00:05&lt;00:02, 381.66it/s]\n 65%|######5   | 2040/3121 [00:05&lt;00:02, 375.67it/s]\n 67%|######6   | 2081/3121 [00:05&lt;00:02, 384.38it/s]\n 68%|######8   | 2126/3121 [00:05&lt;00:02, 402.77it/s]\n 70%|######9   | 2178/3121 [00:05&lt;00:02, 436.32it/s]\n 71%|#######1  | 2226/3121 [00:05&lt;00:02, 447.16it/s]\n 73%|#######2  | 2271/3121 [00:05&lt;00:02, 409.15it/s]\n 74%|#######4  | 2313/3121 [00:06&lt;00:02, 400.57it/s]\n 75%|#######5  | 2354/3121 [00:06&lt;00:01, 397.19it/s]\n 77%|#######6  | 2395/3121 [00:06&lt;00:01, 390.86it/s]\n 78%|#######8  | 2435/3121 [00:06&lt;00:01, 385.99it/s]\n 79%|#######9  | 2474/3121 [00:06&lt;00:01, 384.22it/s]\n 81%|########  | 2514/3121 [00:06&lt;00:01, 388.26it/s]\n 82%|########1 | 2554/3121 [00:06&lt;00:01, 387.00it/s]\n 83%|########3 | 2593/3121 [00:06&lt;00:01, 385.99it/s]\n 84%|########4 | 2633/3121 [00:06&lt;00:01, 386.49it/s]\n 86%|########5 | 2672/3121 [00:07&lt;00:01, 365.34it/s]\n 87%|########6 | 2711/3121 [00:07&lt;00:01, 371.83it/s]\n 88%|########8 | 2750/3121 [00:07&lt;00:00, 376.78it/s]\n 89%|########9 | 2788/3121 [00:07&lt;00:00, 371.13it/s]\n 91%|######### | 2826/3121 [00:07&lt;00:00, 368.05it/s]\n 92%|#########1| 2870/3121 [00:07&lt;00:00, 388.20it/s]\n 93%|#########3| 2910/3121 [00:07&lt;00:00, 391.13it/s]\n 95%|#########4| 2951/3121 [00:07&lt;00:00, 395.28it/s]\n 96%|#########5| 2993/3121 [00:07&lt;00:00, 400.97it/s]\n 97%|#########7| 3034/3121 [00:07&lt;00:00, 401.64it/s]\n 99%|#########8| 3075/3121 [00:08&lt;00:00, 385.28it/s]\n100%|##########| 3121/3121 [00:08&lt;00:00, 404.47it/s]\n100%|##########| 3121/3121 [00:08&lt;00:00, 382.17it/s]\n\n  0%|          | 0/3121 [00:00&lt;?, ?it/s]\n  0%|          | 6/3121 [00:00&lt;00:53, 58.12it/s]\n  0%|          | 9/3121 [00:11&lt;00:53, 58.12it/s]/opt/homebrew/Caskroom/miniforge/base/envs/dipy-39-x86/lib/python3.9/site-packages/cvxpy/problems/problem.py:1385: UserWarning: Solution may be inaccurate. Try another solver, adjusting the solver settings, or solve with verbose=True for more information.\n  warnings.warn(\n/Users/skoudoro/devel/dipy/dipy/core/optimize.py:527: UserWarning: Solver failed to produce an optimum: optimal_inaccurate.\n  warnings.warn(msg)\n\n  0%|          | 10/3121 [00:30&lt;3:10:20,  3.67s/it]\n  0%|          | 11/3121 [00:59&lt;6:30:23,  7.53s/it]\n  1%|          | 17/3121 [00:59&lt;2:52:01,  3.33s/it]\n  1%|          | 23/3121 [01:00&lt;1:35:46,  1.86s/it]\n  1%|          | 29/3121 [01:00&lt;58:51,  1.14s/it]\n  1%|          | 29/3121 [01:12&lt;58:51,  1.14s/it]\n  1%|          | 30/3121 [01:29&lt;3:03:38,  3.56s/it]\n  1%|1         | 32/3121 [02:01&lt;5:05:27,  5.93s/it]\n  1%|1         | 37/3121 [02:01&lt;3:00:20,  3.51s/it]\n  1%|1         | 43/3121 [02:01&lt;1:46:02,  2.07s/it]\n  2%|1         | 47/3121 [02:12&lt;1:45:54,  2.07s/it]\n  2%|1         | 48/3121 [02:33&lt;2:57:32,  3.47s/it]\n  2%|1         | 53/3121 [03:05&lt;3:46:59,  4.44s/it]\n  2%|1         | 58/3121 [03:38&lt;4:21:51,  5.13s/it]\n  2%|2         | 64/3121 [03:38&lt;2:50:15,  3.34s/it]\n  2%|2         | 70/3121 [03:39&lt;1:53:37,  2.23s/it]\n  2%|2         | 77/3121 [03:39&lt;1:13:11,  1.44s/it]\n  3%|2         | 84/3121 [03:39&lt;48:38,  1.04it/s]\n  3%|2         | 88/3121 [03:52&lt;48:34,  1.04it/s]\n  3%|2         | 89/3121 [04:10&lt;1:56:13,  2.30s/it]\n  3%|2         | 90/3121 [04:41&lt;3:36:34,  4.29s/it]\n  3%|2         | 91/3121 [05:12&lt;5:36:23,  6.66s/it]\n  3%|3         | 97/3121 [05:12&lt;3:11:01,  3.79s/it]\n  3%|3         | 103/3121 [05:12&lt;1:58:13,  2.35s/it]\n  3%|3         | 109/3121 [05:13&lt;1:16:39,  1.53s/it]\n  4%|3         | 115/3121 [05:13&lt;51:18,  1.02s/it]\n  4%|3         | 121/3121 [05:13&lt;35:00,  1.43it/s]\n  4%|4         | 126/3121 [05:13&lt;25:33,  1.95it/s]\n  4%|4         | 131/3121 [05:13&lt;18:35,  2.68it/s]\n  4%|4         | 136/3121 [05:13&lt;13:31,  3.68it/s]\n  5%|4         | 142/3121 [05:13&lt;09:18,  5.33it/s]\n  5%|4         | 148/3121 [05:13&lt;06:36,  7.50it/s]\n  5%|4         | 154/3121 [05:14&lt;04:48, 10.27it/s]\n  5%|5         | 161/3121 [05:14&lt;03:25, 14.38it/s]\n  5%|5         | 167/3121 [05:14&lt;02:39, 18.54it/s]\n  6%|5         | 173/3121 [05:14&lt;02:07, 23.19it/s]\n  6%|5         | 180/3121 [05:14&lt;01:41, 29.07it/s]\n  6%|5         | 187/3121 [05:14&lt;01:24, 34.86it/s]\n  6%|6         | 193/3121 [05:14&lt;01:14, 39.32it/s]\n  6%|6         | 199/3121 [05:14&lt;01:09, 42.13it/s]\n  7%|6         | 206/3121 [05:14&lt;01:01, 47.08it/s]\n  7%|6         | 212/3121 [05:14&lt;00:58, 50.13it/s]\n  7%|6         | 218/3121 [05:15&lt;00:55, 52.60it/s]\n  7%|7         | 224/3121 [05:15&lt;00:54, 53.10it/s]\n  7%|7         | 231/3121 [05:15&lt;00:52, 55.09it/s]\n  8%|7         | 237/3121 [05:15&lt;00:52, 54.72it/s]\n  8%|7         | 243/3121 [05:15&lt;00:52, 54.86it/s]\n  8%|8         | 250/3121 [05:15&lt;00:50, 56.51it/s]\n  8%|8         | 256/3121 [05:15&lt;00:50, 56.52it/s]\n  8%|8         | 262/3121 [05:15&lt;00:50, 56.61it/s]\n  9%|8         | 268/3121 [05:15&lt;00:50, 56.99it/s]\n  9%|8         | 275/3121 [05:16&lt;00:51, 54.79it/s]\n  9%|9         | 281/3121 [05:16&lt;00:51, 55.28it/s]\n  9%|9         | 287/3121 [05:16&lt;00:51, 55.44it/s]\n  9%|9         | 293/3121 [05:16&lt;00:52, 53.46it/s]\n 10%|9         | 299/3121 [05:16&lt;00:52, 53.74it/s]\n 10%|9         | 305/3121 [05:16&lt;01:00, 46.43it/s]\n 10%|9         | 310/3121 [05:16&lt;01:00, 46.46it/s]\n 10%|#         | 315/3121 [05:16&lt;01:00, 46.66it/s]\n 10%|#         | 321/3121 [05:17&lt;00:58, 47.99it/s]\n 10%|#         | 326/3121 [05:17&lt;00:58, 48.13it/s]\n 11%|#         | 332/3121 [05:17&lt;00:55, 50.58it/s]\n 11%|#         | 338/3121 [05:17&lt;00:55, 50.19it/s]\n 11%|#1        | 344/3121 [05:17&lt;00:53, 51.99it/s]\n 11%|#1        | 351/3121 [05:17&lt;00:50, 55.16it/s]\n 11%|#1        | 357/3121 [05:17&lt;00:49, 56.12it/s]\n 12%|#1        | 363/3121 [05:17&lt;00:48, 56.57it/s]\n 12%|#1        | 370/3121 [05:17&lt;00:47, 58.47it/s]\n 12%|#2        | 376/3121 [05:18&lt;00:48, 56.76it/s]\n 12%|#2        | 382/3121 [05:18&lt;00:47, 57.12it/s]\n 12%|#2        | 388/3121 [05:18&lt;00:49, 55.18it/s]\n 13%|#2        | 395/3121 [05:18&lt;00:47, 57.01it/s]\n 13%|#2        | 401/3121 [05:18&lt;00:47, 57.36it/s]\n 13%|#3        | 407/3121 [05:18&lt;00:47, 57.25it/s]\n 13%|#3        | 414/3121 [05:18&lt;00:45, 59.21it/s]\n 13%|#3        | 421/3121 [05:18&lt;00:46, 58.22it/s]\n 14%|#3        | 427/3121 [05:18&lt;00:47, 57.06it/s]\n 14%|#3        | 434/3121 [05:19&lt;00:46, 57.97it/s]\n 14%|#4        | 440/3121 [05:19&lt;00:46, 57.92it/s]\n 14%|#4        | 446/3121 [05:19&lt;00:45, 58.26it/s]\n 14%|#4        | 452/3121 [05:19&lt;00:45, 58.61it/s]\n 15%|#4        | 458/3121 [05:19&lt;00:46, 57.46it/s]\n 15%|#4        | 465/3121 [05:19&lt;00:45, 58.44it/s]\n 15%|#5        | 472/3121 [05:19&lt;00:45, 58.73it/s]\n 15%|#5        | 478/3121 [05:19&lt;00:44, 58.93it/s]\n 16%|#5        | 485/3121 [05:19&lt;00:44, 59.45it/s]\n 16%|#5        | 491/3121 [05:20&lt;00:44, 59.47it/s]\n 16%|#5        | 497/3121 [05:20&lt;00:44, 59.61it/s]\n 16%|#6        | 503/3121 [05:20&lt;00:44, 59.22it/s]\n 16%|#6        | 509/3121 [05:20&lt;00:44, 58.44it/s]\n 17%|#6        | 515/3121 [05:20&lt;00:45, 57.77it/s]\n 17%|#6        | 521/3121 [05:20&lt;00:47, 54.81it/s]\n 17%|#6        | 528/3121 [05:20&lt;00:45, 57.19it/s]\n 17%|#7        | 534/3121 [05:20&lt;00:44, 57.66it/s]\n 17%|#7        | 540/3121 [05:20&lt;00:46, 56.07it/s]\n 17%|#7        | 546/3121 [05:20&lt;00:45, 57.14it/s]\n 18%|#7        | 552/3121 [05:21&lt;00:45, 56.61it/s]\n 18%|#7        | 558/3121 [05:21&lt;00:46, 54.69it/s]\n 18%|#8        | 564/3121 [05:21&lt;00:46, 54.82it/s]\n 18%|#8        | 571/3121 [05:21&lt;00:44, 56.71it/s]\n 19%|#8        | 578/3121 [05:21&lt;00:44, 57.16it/s]\n 19%|#8        | 585/3121 [05:21&lt;00:43, 58.67it/s]\n 19%|#8        | 592/3121 [05:21&lt;00:42, 58.82it/s]\n 19%|#9        | 598/3121 [05:21&lt;00:42, 58.68it/s]\n 19%|#9        | 605/3121 [05:21&lt;00:42, 59.42it/s]\n 20%|#9        | 611/3121 [05:22&lt;00:42, 59.38it/s]\n 20%|#9        | 618/3121 [05:22&lt;00:41, 60.08it/s]\n 20%|##        | 625/3121 [05:22&lt;00:41, 60.00it/s]\n 20%|##        | 631/3121 [05:22&lt;00:41, 59.51it/s]\n 20%|##        | 638/3121 [05:22&lt;00:49, 50.63it/s]\n 21%|##        | 645/3121 [05:22&lt;00:46, 53.65it/s]\n 21%|##        | 651/3121 [05:22&lt;00:44, 54.93it/s]\n 21%|##1       | 658/3121 [05:22&lt;00:43, 56.78it/s]\n 21%|##1       | 664/3121 [05:23&lt;00:42, 57.49it/s]\n 21%|##1       | 671/3121 [05:23&lt;00:42, 57.56it/s]\n 22%|##1       | 678/3121 [05:23&lt;00:41, 58.99it/s]\n 22%|##1       | 684/3121 [05:23&lt;00:41, 58.39it/s]\n 22%|##2       | 690/3121 [05:23&lt;00:41, 58.51it/s]\n 22%|##2       | 696/3121 [05:23&lt;00:42, 57.46it/s]\n 22%|##2       | 702/3121 [05:23&lt;00:41, 58.10it/s]\n 23%|##2       | 708/3121 [05:23&lt;00:41, 57.67it/s]\n 23%|##2       | 714/3121 [05:23&lt;00:42, 56.57it/s]\n 23%|##3       | 720/3121 [05:24&lt;00:43, 55.20it/s]\n 23%|##3       | 726/3121 [05:24&lt;00:42, 55.90it/s]\n 23%|##3       | 733/3121 [05:24&lt;00:41, 56.92it/s]\n 24%|##3       | 740/3121 [05:24&lt;00:41, 57.77it/s]\n 24%|##3       | 747/3121 [05:24&lt;00:40, 58.65it/s]\n 24%|##4       | 754/3121 [05:24&lt;00:39, 59.23it/s]\n 24%|##4       | 761/3121 [05:24&lt;00:39, 59.84it/s]\n 25%|##4       | 767/3121 [05:24&lt;00:39, 59.72it/s]\n 25%|##4       | 773/3121 [05:24&lt;00:42, 54.89it/s]\n 25%|##4       | 779/3121 [05:25&lt;00:48, 48.49it/s]\n 25%|##5       | 785/3121 [05:25&lt;00:51, 45.10it/s]\n 25%|##5       | 790/3121 [05:25&lt;00:50, 45.74it/s]\n 26%|##5       | 796/3121 [05:25&lt;00:47, 48.96it/s]\n 26%|##5       | 803/3121 [05:25&lt;00:43, 52.97it/s]\n 26%|##5       | 809/3121 [05:25&lt;00:42, 54.67it/s]\n 26%|##6       | 815/3121 [05:25&lt;00:41, 56.06it/s]\n 26%|##6       | 822/3121 [05:25&lt;00:40, 57.22it/s]\n 27%|##6       | 828/3121 [05:25&lt;00:39, 57.59it/s]\n 27%|##6       | 835/3121 [05:26&lt;00:38, 58.83it/s]\n 27%|##6       | 841/3121 [05:26&lt;00:38, 59.05it/s]\n 27%|##7       | 848/3121 [05:26&lt;00:38, 59.56it/s]\n 27%|##7       | 854/3121 [05:26&lt;00:39, 56.89it/s]\n 28%|##7       | 860/3121 [05:26&lt;00:40, 55.27it/s]\n 28%|##7       | 867/3121 [05:26&lt;00:39, 56.67it/s]\n 28%|##7       | 873/3121 [05:26&lt;00:40, 55.64it/s]\n 28%|##8       | 879/3121 [05:26&lt;00:44, 50.66it/s]\n 28%|##8       | 885/3121 [05:27&lt;00:45, 49.18it/s]\n 29%|##8       | 891/3121 [05:27&lt;00:44, 50.36it/s]\n 29%|##8       | 897/3121 [05:27&lt;00:44, 50.43it/s]\n 29%|##8       | 904/3121 [05:27&lt;00:41, 53.65it/s]\n 29%|##9       | 910/3121 [05:27&lt;00:40, 54.67it/s]\n 29%|##9       | 916/3121 [05:27&lt;00:40, 53.81it/s]\n 30%|##9       | 922/3121 [05:27&lt;00:42, 51.95it/s]\n 30%|##9       | 928/3121 [05:27&lt;00:43, 50.70it/s]\n 30%|##9       | 934/3121 [05:28&lt;00:46, 47.46it/s]\n 30%|###       | 939/3121 [05:28&lt;00:46, 46.43it/s]\n 30%|###       | 944/3121 [05:28&lt;00:49, 44.37it/s]\n 30%|###       | 949/3121 [05:28&lt;00:53, 40.54it/s]\n 31%|###       | 954/3121 [05:28&lt;00:58, 36.93it/s]\n 31%|###       | 958/3121 [05:28&lt;00:58, 36.92it/s]\n 31%|###       | 963/3121 [05:28&lt;00:55, 39.16it/s]\n 31%|###1      | 968/3121 [05:28&lt;00:53, 40.22it/s]\n 31%|###1      | 973/3121 [05:29&lt;00:52, 41.12it/s]\n 31%|###1      | 978/3121 [05:29&lt;00:49, 43.09it/s]\n 32%|###1      | 984/3121 [05:29&lt;00:46, 46.26it/s]\n 32%|###1      | 989/3121 [05:29&lt;00:45, 46.55it/s]\n 32%|###1      | 994/3121 [05:29&lt;00:46, 46.03it/s]\n 32%|###2      | 999/3121 [05:29&lt;00:46, 45.55it/s]\n 32%|###2      | 1004/3121 [05:29&lt;00:46, 45.42it/s]\n 32%|###2      | 1009/3121 [05:29&lt;00:45, 46.06it/s]\n 33%|###2      | 1015/3121 [05:29&lt;00:42, 49.04it/s]\n 33%|###2      | 1021/3121 [05:30&lt;00:41, 50.49it/s]\n 33%|###2      | 1027/3121 [05:30&lt;00:39, 52.92it/s]\n 33%|###3      | 1034/3121 [05:30&lt;00:37, 55.50it/s]\n 33%|###3      | 1040/3121 [05:30&lt;00:36, 56.69it/s]\n 34%|###3      | 1047/3121 [05:30&lt;00:35, 57.62it/s]\n 34%|###3      | 1053/3121 [05:30&lt;00:35, 57.73it/s]\n 34%|###3      | 1060/3121 [05:30&lt;00:34, 59.26it/s]\n 34%|###4      | 1066/3121 [05:30&lt;00:34, 59.30it/s]\n 34%|###4      | 1072/3121 [05:30&lt;00:36, 56.33it/s]\n 35%|###4      | 1079/3121 [05:30&lt;00:35, 57.62it/s]\n 35%|###4      | 1086/3121 [05:31&lt;00:34, 58.77it/s]\n 35%|###5      | 1093/3121 [05:31&lt;00:34, 58.93it/s]\n 35%|###5      | 1099/3121 [05:31&lt;00:34, 59.08it/s]\n 35%|###5      | 1105/3121 [05:31&lt;00:34, 58.45it/s]\n 36%|###5      | 1111/3121 [05:31&lt;00:35, 55.98it/s]\n 36%|###5      | 1117/3121 [05:31&lt;00:37, 52.99it/s]\n 36%|###5      | 1123/3121 [05:31&lt;00:40, 48.92it/s]\n 36%|###6      | 1128/3121 [05:31&lt;00:45, 43.46it/s]\n 36%|###6      | 1133/3121 [05:32&lt;00:44, 44.73it/s]\n 36%|###6      | 1138/3121 [05:32&lt;00:44, 44.67it/s]\n 37%|###6      | 1143/3121 [05:32&lt;00:43, 45.38it/s]\n 37%|###6      | 1149/3121 [05:32&lt;00:41, 47.83it/s]\n 37%|###7      | 1156/3121 [05:32&lt;00:38, 51.48it/s]\n 37%|###7      | 1163/3121 [05:32&lt;00:36, 54.29it/s]\n 37%|###7      | 1169/3121 [05:32&lt;00:35, 55.52it/s]\n 38%|###7      | 1175/3121 [05:32&lt;00:37, 52.30it/s]\n 38%|###7      | 1181/3121 [05:33&lt;00:37, 51.07it/s]\n 38%|###8      | 1187/3121 [05:33&lt;00:36, 53.35it/s]\n 38%|###8      | 1193/3121 [05:33&lt;00:36, 53.25it/s]\n 38%|###8      | 1199/3121 [05:33&lt;00:35, 54.87it/s]\n 39%|###8      | 1206/3121 [05:33&lt;00:33, 57.10it/s]\n 39%|###8      | 1212/3121 [05:33&lt;00:33, 57.68it/s]\n 39%|###9      | 1218/3121 [05:33&lt;00:32, 57.73it/s]\n 39%|###9      | 1225/3121 [05:33&lt;00:33, 55.80it/s]\n 39%|###9      | 1231/3121 [05:33&lt;00:34, 55.29it/s]\n 40%|###9      | 1237/3121 [05:33&lt;00:34, 54.90it/s]\n 40%|###9      | 1243/3121 [05:34&lt;00:33, 55.71it/s]\n 40%|####      | 1249/3121 [05:34&lt;00:36, 51.39it/s]\n 40%|####      | 1256/3121 [05:34&lt;00:34, 54.17it/s]\n 40%|####      | 1262/3121 [05:34&lt;00:35, 52.51it/s]\n 41%|####      | 1268/3121 [05:34&lt;00:34, 54.25it/s]\n 41%|####      | 1274/3121 [05:34&lt;00:33, 54.54it/s]\n 41%|####1     | 1280/3121 [05:34&lt;00:33, 54.97it/s]\n 41%|####1     | 1286/3121 [05:34&lt;00:33, 54.58it/s]\n 41%|####1     | 1292/3121 [05:35&lt;00:32, 55.71it/s]\n 42%|####1     | 1298/3121 [05:35&lt;00:33, 54.40it/s]\n 42%|####1     | 1304/3121 [05:35&lt;00:33, 53.60it/s]\n 42%|####2     | 1311/3121 [05:35&lt;00:32, 55.92it/s]\n 42%|####2     | 1317/3121 [05:35&lt;00:33, 53.69it/s]\n 42%|####2     | 1323/3121 [05:35&lt;00:33, 54.27it/s]\n 43%|####2     | 1329/3121 [05:35&lt;00:32, 55.12it/s]\n 43%|####2     | 1336/3121 [05:35&lt;00:31, 57.20it/s]\n 43%|####2     | 1342/3121 [05:35&lt;00:31, 56.25it/s]\n 43%|####3     | 1348/3121 [05:36&lt;00:32, 53.84it/s]\n 43%|####3     | 1354/3121 [05:36&lt;00:33, 52.70it/s]\n 44%|####3     | 1360/3121 [05:36&lt;00:34, 51.37it/s]\n 44%|####3     | 1366/3121 [05:36&lt;00:36, 48.43it/s]\n 44%|####3     | 1371/3121 [05:36&lt;00:37, 46.74it/s]\n 44%|####4     | 1376/3121 [05:36&lt;00:37, 46.18it/s]\n 44%|####4     | 1381/3121 [05:36&lt;00:38, 44.68it/s]\n 44%|####4     | 1386/3121 [05:36&lt;00:38, 44.51it/s]\n 45%|####4     | 1391/3121 [05:36&lt;00:37, 45.87it/s]\n 45%|####4     | 1398/3121 [05:37&lt;00:34, 50.31it/s]\n 45%|####4     | 1398/3121 [05:52&lt;00:34, 50.31it/s]\n 45%|####4     | 1399/3121 [06:09&lt;1:05:41,  2.29s/it]\n 45%|####5     | 1405/3121 [06:09&lt;41:10,  1.44s/it]\n 45%|####5     | 1412/3121 [06:09&lt;25:26,  1.12it/s]\n 45%|####5     | 1418/3121 [06:10&lt;17:23,  1.63it/s]\n 46%|####5     | 1425/3121 [06:10&lt;11:28,  2.47it/s]\n 46%|####5     | 1431/3121 [06:10&lt;08:10,  3.44it/s]\n 46%|####6     | 1437/3121 [06:10&lt;05:51,  4.79it/s]\n 46%|####6     | 1444/3121 [06:10&lt;04:02,  6.92it/s]\n 46%|####6     | 1450/3121 [06:10&lt;02:59,  9.29it/s]\n 47%|####6     | 1457/3121 [06:10&lt;02:09, 12.84it/s]\n 47%|####6     | 1463/3121 [06:10&lt;01:40, 16.46it/s]\n 47%|####7     | 1469/3121 [06:10&lt;01:19, 20.78it/s]\n 47%|####7     | 1476/3121 [06:10&lt;01:01, 26.63it/s]\n 48%|####7     | 1483/3121 [06:11&lt;00:50, 32.35it/s]\n 48%|####7     | 1490/3121 [06:11&lt;00:43, 37.78it/s]\n 48%|####7     | 1497/3121 [06:11&lt;00:38, 42.70it/s]\n 48%|####8     | 1504/3121 [06:11&lt;00:34, 46.51it/s]\n 48%|####8     | 1511/3121 [06:11&lt;00:32, 50.23it/s]\n 49%|####8     | 1518/3121 [06:11&lt;00:30, 52.72it/s]\n 49%|####8     | 1524/3121 [06:11&lt;00:29, 54.36it/s]\n 49%|####9     | 1531/3121 [06:11&lt;00:28, 56.15it/s]\n 49%|####9     | 1538/3121 [06:12&lt;00:27, 57.36it/s]\n 49%|####9     | 1540/3121 [06:22&lt;00:27, 57.36it/s]\n 49%|####9     | 1541/3121 [06:44&lt;45:09,  1.71s/it]\n 50%|####9     | 1546/3121 [06:44&lt;32:50,  1.25s/it]\n 50%|####9     | 1552/3121 [06:44&lt;22:27,  1.16it/s]\n 50%|####9     | 1558/3121 [06:44&lt;15:36,  1.67it/s]\n 50%|#####     | 1563/3121 [06:44&lt;11:29,  2.26it/s]\n 50%|#####     | 1568/3121 [06:44&lt;08:25,  3.07it/s]\n 50%|#####     | 1573/3121 [06:45&lt;06:10,  4.18it/s]\n 51%|#####     | 1578/3121 [06:45&lt;04:32,  5.66it/s]\n 51%|#####     | 1583/3121 [06:45&lt;03:21,  7.63it/s]\n 51%|#####     | 1583/3121 [07:02&lt;03:21,  7.63it/s]\n 51%|#####     | 1584/3121 [07:17&lt;1:06:05,  2.58s/it]\n 51%|#####     | 1589/3121 [07:17&lt;42:40,  1.67s/it]\n 51%|#####1    | 1594/3121 [07:17&lt;28:23,  1.12s/it]\n 51%|#####1    | 1599/3121 [07:17&lt;19:17,  1.32it/s]\n 51%|#####1    | 1604/3121 [07:17&lt;13:19,  1.90it/s]\n 52%|#####1    | 1608/3121 [07:32&lt;13:17,  1.90it/s]\n 52%|#####1    | 1609/3121 [07:49&lt;59:50,  2.37s/it]\n 52%|#####1    | 1610/3121 [08:23&lt;2:03:21,  4.90s/it]\n 52%|#####1    | 1616/3121 [08:23&lt;1:12:25,  2.89s/it]\n 52%|#####1    | 1622/3121 [08:23&lt;45:33,  1.82s/it]\n 52%|#####2    | 1628/3121 [08:23&lt;29:48,  1.20s/it]\n 52%|#####2    | 1635/3121 [08:23&lt;18:58,  1.31it/s]\n 53%|#####2    | 1641/3121 [08:23&lt;13:10,  1.87it/s]\n 53%|#####2    | 1648/3121 [08:23&lt;08:47,  2.79it/s]\n 53%|#####2    | 1654/3121 [08:23&lt;06:19,  3.87it/s]\n 53%|#####3    | 1661/3121 [08:23&lt;04:21,  5.59it/s]\n 53%|#####3    | 1667/3121 [08:24&lt;03:12,  7.55it/s]\n 54%|#####3    | 1673/3121 [08:24&lt;02:23, 10.11it/s]\n 54%|#####3    | 1679/3121 [08:24&lt;01:48, 13.32it/s]\n 54%|#####3    | 1685/3121 [08:24&lt;01:23, 17.24it/s]\n 54%|#####4    | 1691/3121 [08:24&lt;01:06, 21.41it/s]\n 54%|#####4    | 1697/3121 [08:24&lt;00:55, 25.76it/s]\n 55%|#####4    | 1703/3121 [08:24&lt;00:45, 31.05it/s]\n 55%|#####4    | 1709/3121 [08:24&lt;00:39, 35.42it/s]\n 55%|#####4    | 1716/3121 [08:24&lt;00:34, 41.13it/s]\n 55%|#####5    | 1723/3121 [08:25&lt;00:30, 45.89it/s]\n 55%|#####5    | 1729/3121 [08:25&lt;00:28, 49.03it/s]\n 56%|#####5    | 1735/3121 [08:25&lt;00:26, 51.62it/s]\n 56%|#####5    | 1742/3121 [08:25&lt;00:25, 54.23it/s]\n 56%|#####6    | 1749/3121 [08:25&lt;00:24, 56.10it/s]\n 56%|#####6    | 1756/3121 [08:25&lt;00:23, 57.44it/s]\n 56%|#####6    | 1762/3121 [08:25&lt;00:25, 54.03it/s]\n 57%|#####6    | 1768/3121 [08:25&lt;00:24, 54.26it/s]\n 57%|#####6    | 1775/3121 [08:25&lt;00:23, 56.67it/s]\n 57%|#####7    | 1781/3121 [08:26&lt;00:23, 56.34it/s]\n 57%|#####7    | 1787/3121 [08:26&lt;00:23, 55.92it/s]\n 57%|#####7    | 1793/3121 [08:26&lt;00:25, 52.55it/s]\n 58%|#####7    | 1799/3121 [08:26&lt;00:24, 54.04it/s]\n 58%|#####7    | 1805/3121 [08:26&lt;00:24, 52.79it/s]\n 58%|#####8    | 1811/3121 [08:26&lt;00:26, 50.38it/s]\n 58%|#####8    | 1818/3121 [08:26&lt;00:24, 53.34it/s]\n 58%|#####8    | 1824/3121 [08:26&lt;00:24, 52.54it/s]\n 59%|#####8    | 1830/3121 [08:26&lt;00:25, 51.54it/s]\n 59%|#####8    | 1836/3121 [08:27&lt;00:26, 48.61it/s]\n 59%|#####8    | 1841/3121 [08:27&lt;00:27, 46.95it/s]\n 59%|#####9    | 1846/3121 [08:27&lt;00:26, 47.23it/s]\n 59%|#####9    | 1852/3121 [08:27&lt;00:25, 49.08it/s]\n 60%|#####9    | 1858/3121 [08:27&lt;00:25, 50.27it/s]\n 60%|#####9    | 1864/3121 [08:27&lt;00:25, 48.75it/s]\n 60%|#####9    | 1869/3121 [08:27&lt;00:26, 47.67it/s]\n 60%|######    | 1875/3121 [08:27&lt;00:25, 48.87it/s]\n 60%|######    | 1882/3121 [08:28&lt;00:23, 52.84it/s]\n 60%|######    | 1888/3121 [08:28&lt;00:22, 54.07it/s]\n 61%|######    | 1894/3121 [08:28&lt;00:22, 53.46it/s]\n 61%|######    | 1900/3121 [08:28&lt;00:23, 52.85it/s]\n 61%|######1   | 1906/3121 [08:28&lt;00:23, 51.54it/s]\n 61%|######1   | 1912/3121 [08:28&lt;00:23, 52.01it/s]\n 61%|######1   | 1918/3121 [08:28&lt;00:24, 49.94it/s]\n 62%|######1   | 1924/3121 [08:28&lt;00:24, 49.67it/s]\n 62%|######1   | 1929/3121 [08:28&lt;00:25, 47.65it/s]\n 62%|######1   | 1934/3121 [08:29&lt;00:25, 46.75it/s]\n 62%|######2   | 1939/3121 [08:29&lt;00:25, 46.55it/s]\n 62%|######2   | 1945/3121 [08:29&lt;00:23, 49.86it/s]\n 63%|######2   | 1951/3121 [08:29&lt;00:22, 52.10it/s]\n 63%|######2   | 1957/3121 [08:29&lt;00:22, 51.97it/s]\n 63%|######2   | 1964/3121 [08:29&lt;00:21, 54.93it/s]\n 63%|######3   | 1970/3121 [08:29&lt;00:22, 52.27it/s]\n 63%|######3   | 1976/3121 [08:29&lt;00:22, 51.00it/s]\n 64%|######3   | 1982/3121 [08:29&lt;00:21, 53.13it/s]\n 64%|######3   | 1988/3121 [08:30&lt;00:21, 53.83it/s]\n 64%|######3   | 1994/3121 [08:30&lt;00:20, 54.55it/s]\n 64%|######4   | 2001/3121 [08:30&lt;00:19, 56.50it/s]\n 64%|######4   | 2007/3121 [08:30&lt;00:19, 56.12it/s]\n 65%|######4   | 2014/3121 [08:30&lt;00:18, 58.84it/s]\n 65%|######4   | 2020/3121 [08:30&lt;00:18, 58.90it/s]\n 65%|######4   | 2026/3121 [08:30&lt;00:18, 59.15it/s]\n 65%|######5   | 2033/3121 [08:30&lt;00:18, 59.59it/s]\n 65%|######5   | 2039/3121 [08:30&lt;00:18, 59.39it/s]\n 66%|######5   | 2046/3121 [08:31&lt;00:17, 59.95it/s]\n 66%|######5   | 2052/3121 [08:31&lt;00:17, 59.71it/s]\n 66%|######5   | 2058/3121 [08:31&lt;00:17, 59.67it/s]\n 66%|######6   | 2065/3121 [08:31&lt;00:17, 59.26it/s]\n 66%|######6   | 2072/3121 [08:31&lt;00:17, 60.12it/s]\n 67%|######6   | 2079/3121 [08:31&lt;00:18, 57.85it/s]\n 67%|######6   | 2085/3121 [08:31&lt;00:18, 55.38it/s]\n 67%|######6   | 2091/3121 [08:31&lt;00:19, 53.57it/s]\n 67%|######7   | 2097/3121 [08:32&lt;00:19, 52.84it/s]\n 67%|######7   | 2103/3121 [08:32&lt;00:19, 50.93it/s]\n 68%|######7   | 2109/3121 [08:32&lt;00:20, 50.34it/s]\n 68%|######7   | 2115/3121 [08:32&lt;00:20, 48.84it/s]\n 68%|######7   | 2120/3121 [08:32&lt;00:21, 47.65it/s]\n 68%|######8   | 2125/3121 [08:32&lt;00:21, 46.01it/s]\n 68%|######8   | 2130/3121 [08:32&lt;00:22, 44.19it/s]\n 68%|######8   | 2135/3121 [08:32&lt;00:21, 45.07it/s]\n 69%|######8   | 2140/3121 [08:32&lt;00:21, 44.93it/s]\n 69%|######8   | 2145/3121 [08:33&lt;00:22, 43.61it/s]\n 69%|######8   | 2150/3121 [08:33&lt;00:22, 42.29it/s]\n 69%|######9   | 2155/3121 [08:33&lt;00:22, 42.76it/s]\n 69%|######9   | 2160/3121 [08:33&lt;00:23, 41.76it/s]\n 69%|######9   | 2165/3121 [08:33&lt;00:22, 42.86it/s]\n 70%|######9   | 2170/3121 [08:33&lt;00:21, 44.15it/s]\n 70%|######9   | 2176/3121 [08:33&lt;00:19, 47.34it/s]\n 70%|######9   | 2182/3121 [08:33&lt;00:19, 48.30it/s]\n 70%|#######   | 2187/3121 [08:34&lt;00:20, 44.86it/s]\n 70%|#######   | 2192/3121 [08:34&lt;00:21, 43.12it/s]\n 70%|#######   | 2197/3121 [08:34&lt;00:21, 42.01it/s]\n 71%|#######   | 2203/3121 [08:34&lt;00:20, 44.84it/s]\n 71%|#######   | 2208/3121 [08:34&lt;00:19, 45.92it/s]\n 71%|#######   | 2213/3121 [08:34&lt;00:19, 46.78it/s]\n 71%|#######1  | 2219/3121 [08:34&lt;00:18, 49.15it/s]\n 71%|#######1  | 2225/3121 [08:34&lt;00:17, 50.54it/s]\n 71%|#######1  | 2231/3121 [08:34&lt;00:16, 52.63it/s]\n 72%|#######1  | 2237/3121 [08:35&lt;00:17, 50.72it/s]\n 72%|#######1  | 2243/3121 [08:35&lt;00:18, 48.38it/s]\n 72%|#######2  | 2249/3121 [08:35&lt;00:17, 51.05it/s]\n 72%|#######2  | 2256/3121 [08:35&lt;00:15, 54.32it/s]\n 73%|#######2  | 2263/3121 [08:35&lt;00:15, 56.46it/s]\n 73%|#######2  | 2269/3121 [08:35&lt;00:14, 56.96it/s]\n 73%|#######2  | 2276/3121 [08:35&lt;00:14, 58.37it/s]\n 73%|#######3  | 2282/3121 [08:35&lt;00:14, 58.79it/s]\n 73%|#######3  | 2288/3121 [08:35&lt;00:14, 59.04it/s]\n 74%|#######3  | 2294/3121 [08:36&lt;00:13, 59.29it/s]\n 74%|#######3  | 2300/3121 [08:36&lt;00:13, 58.84it/s]\n 74%|#######3  | 2307/3121 [08:36&lt;00:13, 60.13it/s]\n 74%|#######4  | 2314/3121 [08:36&lt;00:13, 59.19it/s]\n 74%|#######4  | 2320/3121 [08:36&lt;00:13, 57.71it/s]\n 75%|#######4  | 2326/3121 [08:36&lt;00:13, 57.92it/s]\n 75%|#######4  | 2332/3121 [08:36&lt;00:13, 58.18it/s]\n 75%|#######4  | 2339/3121 [08:36&lt;00:13, 59.28it/s]\n 75%|#######5  | 2345/3121 [08:36&lt;00:13, 58.60it/s]\n 75%|#######5  | 2351/3121 [08:37&lt;00:13, 58.88it/s]\n 76%|#######5  | 2357/3121 [08:37&lt;00:14, 51.10it/s]\n 76%|#######5  | 2363/3121 [08:37&lt;00:14, 51.60it/s]\n 76%|#######5  | 2369/3121 [08:37&lt;00:14, 51.29it/s]\n 76%|#######6  | 2375/3121 [08:37&lt;00:14, 52.37it/s]\n 76%|#######6  | 2381/3121 [08:37&lt;00:13, 54.03it/s]\n 76%|#######6  | 2387/3121 [08:37&lt;00:13, 55.41it/s]\n 77%|#######6  | 2394/3121 [08:37&lt;00:12, 57.56it/s]\n 77%|#######6  | 2401/3121 [08:37&lt;00:12, 58.43it/s]\n 77%|#######7  | 2407/3121 [08:38&lt;00:12, 58.14it/s]\n 77%|#######7  | 2413/3121 [08:38&lt;00:12, 58.55it/s]\n 78%|#######7  | 2419/3121 [08:38&lt;00:11, 58.83it/s]\n 78%|#######7  | 2425/3121 [08:38&lt;00:11, 59.03it/s]\n 78%|#######7  | 2431/3121 [08:38&lt;00:11, 57.84it/s]\n 78%|#######8  | 2437/3121 [08:38&lt;00:11, 58.03it/s]\n 78%|#######8  | 2444/3121 [08:38&lt;00:11, 58.94it/s]\n 79%|#######8  | 2450/3121 [08:38&lt;00:11, 58.17it/s]\n 79%|#######8  | 2457/3121 [08:38&lt;00:11, 58.91it/s]\n 79%|#######8  | 2463/3121 [08:38&lt;00:11, 59.05it/s]\n 79%|#######9  | 2470/3121 [08:39&lt;00:10, 60.59it/s]\n 79%|#######9  | 2477/3121 [08:39&lt;00:10, 58.65it/s]\n 80%|#######9  | 2484/3121 [08:39&lt;00:10, 59.84it/s]\n 80%|#######9  | 2490/3121 [08:39&lt;00:10, 59.72it/s]\n 80%|#######9  | 2496/3121 [08:39&lt;00:10, 59.58it/s]\n 80%|########  | 2502/3121 [08:39&lt;00:10, 57.42it/s]\n 80%|########  | 2508/3121 [08:39&lt;00:11, 54.24it/s]\n 81%|########  | 2514/3121 [08:39&lt;00:11, 51.81it/s]\n 81%|########  | 2520/3121 [08:40&lt;00:12, 47.18it/s]\n 81%|########  | 2525/3121 [08:40&lt;00:12, 46.02it/s]\n 81%|########1 | 2530/3121 [08:40&lt;00:13, 42.65it/s]\n 81%|########1 | 2535/3121 [08:40&lt;00:13, 43.42it/s]\n 81%|########1 | 2540/3121 [08:40&lt;00:13, 44.37it/s]\n 82%|########1 | 2545/3121 [08:40&lt;00:12, 44.76it/s]\n 82%|########1 | 2550/3121 [08:40&lt;00:12, 43.93it/s]\n 82%|########1 | 2555/3121 [08:40&lt;00:12, 43.90it/s]\n 82%|########2 | 2560/3121 [08:40&lt;00:12, 44.06it/s]\n 82%|########2 | 2565/3121 [08:41&lt;00:12, 43.56it/s]\n 82%|########2 | 2570/3121 [08:41&lt;00:12, 43.25it/s]\n 83%|########2 | 2575/3121 [08:41&lt;00:12, 42.80it/s]\n 83%|########2 | 2580/3121 [08:41&lt;00:12, 42.74it/s]\n 83%|########2 | 2585/3121 [08:41&lt;00:12, 43.33it/s]\n 83%|########2 | 2590/3121 [08:41&lt;00:11, 44.48it/s]\n 83%|########3 | 2595/3121 [08:41&lt;00:11, 44.85it/s]\n 83%|########3 | 2601/3121 [08:41&lt;00:10, 48.18it/s]\n 83%|########3 | 2606/3121 [08:42&lt;00:11, 46.72it/s]\n 84%|########3 | 2611/3121 [08:42&lt;00:11, 45.22it/s]\n 84%|########3 | 2616/3121 [08:42&lt;00:11, 44.42it/s]\n 84%|########3 | 2621/3121 [08:42&lt;00:11, 43.62it/s]\n 84%|########4 | 2626/3121 [08:42&lt;00:11, 43.72it/s]\n 84%|########4 | 2632/3121 [08:42&lt;00:10, 46.54it/s]\n 85%|########4 | 2638/3121 [08:42&lt;00:09, 48.97it/s]\n 85%|########4 | 2644/3121 [08:42&lt;00:09, 51.60it/s]\n 85%|########4 | 2650/3121 [08:42&lt;00:08, 52.78it/s]\n 85%|########5 | 2656/3121 [08:43&lt;00:08, 52.52it/s]\n 85%|########5 | 2663/3121 [08:43&lt;00:08, 54.15it/s]\n 86%|########5 | 2669/3121 [08:43&lt;00:08, 53.23it/s]\n 86%|########5 | 2675/3121 [08:43&lt;00:08, 53.85it/s]\n 86%|########5 | 2681/3121 [08:43&lt;00:08, 54.84it/s]\n 86%|########6 | 2687/3121 [08:43&lt;00:07, 54.30it/s]\n 86%|########6 | 2693/3121 [08:43&lt;00:07, 54.03it/s]\n 86%|########6 | 2699/3121 [08:43&lt;00:07, 55.66it/s]\n 87%|########6 | 2705/3121 [08:43&lt;00:07, 55.52it/s]\n 87%|########6 | 2711/3121 [08:44&lt;00:07, 55.27it/s]\n 87%|########7 | 2718/3121 [08:44&lt;00:07, 57.10it/s]\n 87%|########7 | 2724/3121 [08:44&lt;00:06, 57.48it/s]\n 87%|########7 | 2730/3121 [08:44&lt;00:06, 57.68it/s]\n 88%|########7 | 2736/3121 [08:44&lt;00:06, 55.61it/s]\n 88%|########7 | 2743/3121 [08:44&lt;00:06, 56.64it/s]\n 88%|########8 | 2749/3121 [08:44&lt;00:06, 55.58it/s]\n 88%|########8 | 2755/3121 [08:44&lt;00:06, 54.85it/s]\n 88%|########8 | 2761/3121 [08:44&lt;00:06, 55.88it/s]\n 89%|########8 | 2767/3121 [08:45&lt;00:06, 56.67it/s]\n 89%|########8 | 2773/3121 [08:45&lt;00:06, 55.40it/s]\n 89%|########9 | 2779/3121 [08:45&lt;00:06, 55.58it/s]\n 89%|########9 | 2785/3121 [08:45&lt;00:06, 55.70it/s]\n 89%|########9 | 2792/3121 [08:45&lt;00:05, 56.78it/s]\n 90%|########9 | 2798/3121 [08:45&lt;00:05, 54.98it/s]\n 90%|########9 | 2804/3121 [08:45&lt;00:05, 53.62it/s]\n 90%|######### | 2810/3121 [08:45&lt;00:05, 52.17it/s]\n 90%|######### | 2816/3121 [08:45&lt;00:05, 53.22it/s]\n 90%|######### | 2822/3121 [08:46&lt;00:05, 52.12it/s]\n 91%|######### | 2828/3121 [08:46&lt;00:05, 50.53it/s]\n 91%|######### | 2834/3121 [08:46&lt;00:06, 47.66it/s]\n 91%|######### | 2839/3121 [08:46&lt;00:06, 45.78it/s]\n 91%|#########1| 2844/3121 [08:46&lt;00:06, 44.32it/s]\n 91%|#########1| 2849/3121 [08:46&lt;00:06, 43.27it/s]\n 91%|#########1| 2854/3121 [08:46&lt;00:06, 43.26it/s]\n 92%|#########1| 2859/3121 [08:46&lt;00:06, 42.79it/s]\n 92%|#########1| 2864/3121 [08:47&lt;00:06, 42.27it/s]\n 92%|#########1| 2869/3121 [08:47&lt;00:06, 41.73it/s]\n 92%|#########2| 2874/3121 [08:47&lt;00:06, 40.29it/s]\n 92%|#########2| 2879/3121 [08:47&lt;00:05, 41.48it/s]\n 92%|#########2| 2884/3121 [08:47&lt;00:05, 41.25it/s]\n 93%|#########2| 2889/3121 [08:47&lt;00:05, 42.06it/s]\n 93%|#########2| 2894/3121 [08:47&lt;00:05, 41.93it/s]\n 93%|#########2| 2899/3121 [08:47&lt;00:05, 42.02it/s]\n 93%|#########3| 2904/3121 [08:47&lt;00:05, 42.99it/s]\n 93%|#########3| 2910/3121 [08:48&lt;00:04, 45.22it/s]\n 93%|#########3| 2916/3121 [08:48&lt;00:04, 47.70it/s]\n 94%|#########3| 2922/3121 [08:48&lt;00:03, 49.81it/s]\n 94%|#########3| 2928/3121 [08:48&lt;00:03, 50.45it/s]\n 94%|#########4| 2934/3121 [08:48&lt;00:03, 51.32it/s]\n 94%|#########4| 2940/3121 [08:48&lt;00:03, 51.75it/s]\n 94%|#########4| 2946/3121 [08:48&lt;00:03, 53.32it/s]\n 95%|#########4| 2952/3121 [08:48&lt;00:03, 55.15it/s]\n 95%|#########4| 2958/3121 [08:48&lt;00:02, 54.75it/s]\n 95%|#########4| 2964/3121 [08:49&lt;00:02, 55.27it/s]\n 95%|#########5| 2970/3121 [08:49&lt;00:02, 54.55it/s]\n 95%|#########5| 2976/3121 [08:49&lt;00:02, 55.20it/s]\n 96%|#########5| 2982/3121 [08:49&lt;00:02, 54.86it/s]\n 96%|#########5| 2988/3121 [08:49&lt;00:02, 56.19it/s]\n 96%|#########5| 2994/3121 [08:49&lt;00:02, 55.54it/s]\n 96%|#########6| 3000/3121 [08:49&lt;00:02, 53.36it/s]\n 96%|#########6| 3006/3121 [08:49&lt;00:02, 53.89it/s]\n 97%|#########6| 3012/3121 [08:49&lt;00:01, 54.66it/s]\n 97%|#########6| 3018/3121 [08:50&lt;00:02, 50.51it/s]\n 97%|#########6| 3024/3121 [08:50&lt;00:01, 51.41it/s]\n 97%|#########7| 3030/3121 [08:50&lt;00:01, 51.86it/s]\n 97%|#########7| 3036/3121 [08:50&lt;00:01, 51.48it/s]\n 97%|#########7| 3042/3121 [08:50&lt;00:01, 53.63it/s]\n 98%|#########7| 3048/3121 [08:50&lt;00:01, 55.35it/s]\n 98%|#########7| 3054/3121 [08:50&lt;00:01, 56.12it/s]\n 98%|#########7| 3056/3121 [09:02&lt;00:01, 56.12it/s]\n 98%|#########7| 3057/3121 [09:25&lt;02:10,  2.04s/it]\n 98%|#########8| 3063/3121 [09:25&lt;01:18,  1.36s/it]\n 98%|#########8| 3069/3121 [09:25&lt;00:48,  1.08it/s]\n 99%|#########8| 3075/3121 [09:25&lt;00:29,  1.56it/s]\n 99%|#########8| 3082/3121 [09:25&lt;00:16,  2.35it/s]\n 99%|#########8| 3085/3121 [09:42&lt;00:15,  2.35it/s]\n 99%|#########8| 3086/3121 [09:56&lt;01:11,  2.04s/it]\n 99%|#########9| 3092/3121 [09:56&lt;00:40,  1.40s/it]\n 99%|#########9| 3099/3121 [09:57&lt;00:20,  1.09it/s]\n 99%|#########9| 3105/3121 [09:57&lt;00:10,  1.55it/s]\n 99%|#########9| 3105/3121 [10:12&lt;00:10,  1.55it/s]\n100%|#########9| 3106/3121 [10:30&lt;00:41,  2.80s/it]\n100%|#########9| 3108/3121 [11:02&lt;01:04,  4.96s/it]\n100%|#########9| 3112/3121 [11:02&lt;00:30,  3.42s/it]\n100%|#########9| 3114/3121 [11:22&lt;00:23,  3.42s/it]\n100%|#########9| 3115/3121 [11:36&lt;00:31,  5.32s/it]\n100%|#########9| 3116/3121 [12:07&lt;00:40,  8.08s/it]\n100%|#########9| 3118/3121 [12:38&lt;00:29,  9.81s/it]\n100%|##########| 3121/3121 [13:09&lt;00:00,  9.98s/it]\n100%|##########| 3121/3121 [13:09&lt;00:00,  3.96it/s]\n</pre></div>\n</div>\n<figure class=\"align-center\" id=\"id24\">\n<img alt=\"examples_built/07_reconstruction/Kurtosis_tensor_standard_measures_noisy.png\" src=\"examples_built/07_reconstruction/Kurtosis_tensor_standard_measures_noisy.png\" />\n<figcaption>\n<p><span class=\"caption-text\">DKI standard kurtosis measures obtained on unsmoothed data with constrained\noptimization.</span><a class=\"headerlink\" href=\"#id24\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n</section>\n<section id=\"mean-kurtosis-tensor-and-kurtosis-fractional-anisotropy\">\n<h2>Mean kurtosis tensor and kurtosis fractional anisotropy<a class=\"headerlink\" href=\"#mean-kurtosis-tensor-and-kurtosis-fractional-anisotropy\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>As pointed by previous studies <a class=\"reference internal\" href=\"#hansen2013\" id=\"id17\"><span>[Hansen2013]</span></a>, axial, radial and mean kurtosis\ndepends on the information of both diffusion and kurtosis tensor. DKI measures\nthat only depend on the kurtosis tensor include the mean of the kurtosis tensor\n<a class=\"reference internal\" href=\"#hansen2013\" id=\"id18\"><span>[Hansen2013]</span></a>, and the kurtosis fractional anisotropy <a class=\"reference internal\" href=\"#glennr2015\" id=\"id19\"><span>[GlennR2015]</span></a>. These\nmeasures are computed and illustrated below:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">compare_maps</span><span class=\"p\">([</span><span class=\"n\">dkifit_plus</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"s1\">&#39;mkt&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;kfa&#39;</span><span class=\"p\">],</span> <span class=\"n\">fit_labels</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;DKI+&#39;</span><span class=\"p\">],</span>\n             <span class=\"n\">map_kwargs</span><span class=\"o\">=</span><span class=\"p\">[{</span><span class=\"s1\">&#39;vmin&#39;</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"s1\">&#39;vmax&#39;</span><span class=\"p\">:</span> <span class=\"mf\">1.5</span><span class=\"p\">},</span> <span class=\"p\">{</span><span class=\"s1\">&#39;vmin&#39;</span><span class=\"p\">:</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"s1\">&#39;vmax&#39;</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">}],</span>\n             <span class=\"n\">filename</span><span class=\"o\">=</span><span class=\"s1\">&#39;Measures_from_kurtosis_tensor_only.png&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_reconst_dki_005.png\" srcset=\"../../_images/sphx_glr_reconst_dki_005.png\" alt=\"reconst dki\" class = \"sphx-glr-single-img\"/><figure class=\"align-center\" id=\"id25\">\n<img alt=\"examples_built/07_reconstruction/Measures_from_kurtosis_tensor_only.png\" src=\"examples_built/07_reconstruction/Measures_from_kurtosis_tensor_only.png\" />\n<figcaption>\n<p><span class=\"caption-text\">DKI measures obtained from the kurtosis tensor only.</span><a class=\"headerlink\" href=\"#id25\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<p>As reported by <a class=\"reference internal\" href=\"#hansen2013\" id=\"id20\"><span>[Hansen2013]</span></a>, the mean of the kurtosis tensor (MKT) produces\nsimilar maps than the standard mean kurtosis (MK). On the other hand,\nthe kurtosis fractional anisotropy (KFA) maps shows that the kurtosis tensor\nhave different degrees of anisotropy than the FA measures from the diffusion\ntensor.</p>\n<section id=\"references\">\n<h3>References<a class=\"headerlink\" href=\"#references\" title=\"Permalink to this heading\">\u00b6</a></h3>\n<div role=\"list\" class=\"citation-list\">\n<div class=\"citation\" id=\"jensen2005\" role=\"doc-biblioentry\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span>Jensen2005<span class=\"fn-bracket\">]</span></span>\n<span class=\"backrefs\">(<a role=\"doc-backlink\" href=\"#id1\">1</a>,<a role=\"doc-backlink\" href=\"#id8\">2</a>)</span>\n<p>Jensen JH, Helpern JA, Ramani A, Lu H, Kaczynski K (2005).\nDiffusional Kurtosis Imaging: The Quantification of\nNon_Gaussian Water Diffusion by Means of Magnetic Resonance\nImaging. Magnetic Resonance in Medicine 53: 1432-1440</p>\n</div>\n<div class=\"citation\" id=\"jensen2010\" role=\"doc-biblioentry\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id2\">Jensen2010</a><span class=\"fn-bracket\">]</span></span>\n<p>Jensen JH, Helpern JA (2010). MRI quantification of\nnon-Gaussian water diffusion by kurtosis analysis. NMR in\nBiomedicine 23(7): 698-710</p>\n</div>\n<div class=\"citation\" id=\"fierem2011\" role=\"doc-biblioentry\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id3\">Fierem2011</a><span class=\"fn-bracket\">]</span></span>\n<p>Fieremans E, Jensen JH, Helpern JA (2011). White matter\ncharacterization with diffusion kurtosis imaging. NeuroImage\n58: 177-188</p>\n</div>\n<div class=\"citation\" id=\"veraar2011\" role=\"doc-biblioentry\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id10\">Veraar2011</a><span class=\"fn-bracket\">]</span></span>\n<p>Veraart J, Poot DH, Van Hecke W, Blockx I, Van der Linden A,\nVerhoye M, Sijbers J (2011). More Accurate Estimation of\nDiffusion Tensor Parameters Using Diffusion Kurtosis Imaging.\nMagnetic Resonance in Medicine 65(1): 138-145</p>\n</div>\n<div class=\"citation\" id=\"netohe2012\" role=\"doc-biblioentry\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span>NetoHe2012<span class=\"fn-bracket\">]</span></span>\n<span class=\"backrefs\">(<a role=\"doc-backlink\" href=\"#id7\">1</a>,<a role=\"doc-backlink\" href=\"#id9\">2</a>,<a role=\"doc-backlink\" href=\"#id11\">3</a>,<a role=\"doc-backlink\" href=\"#id12\">4</a>)</span>\n<p>Neto Henriques R, Ferreira H, Correia M, (2012). Diffusion\nkurtosis imaging of the healthy human brain. Master\nDissertation Bachelor and Master Programin Biomedical\nEngineering and Biophysics, Faculty of Sciences.\n<a class=\"reference external\" href=\"http://repositorio.ul.pt/bitstream/10451/8511/1/ulfc104137_tm_Rafael_Henriques.pdf\">http://repositorio.ul.pt/bitstream/10451/8511/1/ulfc104137_tm_Rafael_Henriques.pdf</a></p>\n</div>\n<div class=\"citation\" id=\"hansen2013\" role=\"doc-biblioentry\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span>Hansen2013<span class=\"fn-bracket\">]</span></span>\n<span class=\"backrefs\">(<a role=\"doc-backlink\" href=\"#id17\">1</a>,<a role=\"doc-backlink\" href=\"#id18\">2</a>,<a role=\"doc-backlink\" href=\"#id20\">3</a>)</span>\n<p>Hansen B, Lund TE, Sangill R, and Jespersen SN (2013).\nExperimentally and computationally393fast method for estimation\nof a mean kurtosis. Magnetic Resonance in Medicine 69,\n1754\u20131760.394doi:10.1002/mrm.24743</p>\n</div>\n<div class=\"citation\" id=\"glennr2015\" role=\"doc-biblioentry\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id19\">GlennR2015</a><span class=\"fn-bracket\">]</span></span>\n<p>Glenn GR, Helpern JA, Tabesh A, Jensen JH (2015).\nQuantitative assessment of diffusional387kurtosis anisotropy.\nNMR in Biomedicine28, 448\u2013459. doi:10.1002/nbm.3271</p>\n</div>\n<div class=\"citation\" id=\"netohe2015\" role=\"doc-biblioentry\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id4\">NetoHe2015</a><span class=\"fn-bracket\">]</span></span>\n<p>Neto Henriques R, Correia MM, Nunes RG, Ferreira HA (2015).\nExploring the 3D geometry of the diffusion kurtosis tensor -\nImpact on the development of robust tractography procedures and\nnovel biomarkers, NeuroImage 111: 85-99</p>\n</div>\n<div class=\"citation\" id=\"perron2015\" role=\"doc-biblioentry\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id13\">Perron2015</a><span class=\"fn-bracket\">]</span></span>\n<p>Perrone D, Aelterman J, Piz\u030curica A, Jeurissen B, Philips W,\nLeemans A, (2015). The effect of Gibbs ringing artifacts on\nmeasures derived from diffusion MRI. Neuroimage 120, 441-455.\n<a class=\"reference external\" href=\"https://doi.org/10.1016/j.neuroimage.2015.06.068\">https://doi.org/10.1016/j.neuroimage.2015.06.068</a>.</p>\n</div>\n<div class=\"citation\" id=\"taxcmw2015\" role=\"doc-biblioentry\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id6\">TaxCMW2015</a><span class=\"fn-bracket\">]</span></span>\n<p>Tax CMW, Otte WM, Viergever MA, Dijkhuizen RM, Leemans A\n(2014). REKINDLE: Robust extraction of kurtosis INDices with\nlinear estimation. Magnetic Resonance in Medicine 73(2):\n794-808.</p>\n</div>\n<div class=\"citation\" id=\"hansen2016\" role=\"doc-biblioentry\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id5\">Hansen2016</a><span class=\"fn-bracket\">]</span></span>\n<p>Hansen, B, Jespersen, SN (2016). Data for evaluation of fast\nkurtosis strategies, b-value optimization and exploration of\ndiffusion MRI contrast. Scientific Data 3: 160072\ndoi:10.1038/sdata.2016.72</p>\n</div>\n<div class=\"citation\" id=\"netohe2018\" role=\"doc-biblioentry\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id14\">NetoHe2018</a><span class=\"fn-bracket\">]</span></span>\n<p>Neto Henriques R (2018). Advanced Methods for Diffusion MRI\nData Analysis and their Application to the Healthy Ageing Brain\n(Doctoral thesis). <a class=\"reference external\" href=\"https://doi.org/10.17863/CAM.29356\">https://doi.org/10.17863/CAM.29356</a></p>\n</div>\n<div class=\"citation\" id=\"delaha2020\" role=\"doc-biblioentry\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span>DelaHa2020<span class=\"fn-bracket\">]</span></span>\n<span class=\"backrefs\">(<a role=\"doc-backlink\" href=\"#id15\">1</a>,<a role=\"doc-backlink\" href=\"#id16\">2</a>)</span>\n<p>Dela Haije et al. \u201cEnforcing necessary non-negativity\nconstraints for common diffusion MRI models using sum of squares\nprogramming\u201d. NeuroImage 209, 2020, 116405.</p>\n</div>\n</div>\n<p class=\"sphx-glr-timing\"><strong>Total running time of the script:</strong> ( 15 minutes  19.446 seconds)</p>\n<div class=\"sphx-glr-footer sphx-glr-footer-example docutils container\" id=\"sphx-glr-download-examples-built-07-reconstruction-reconst-dki-py\">\n<div class=\"sphx-glr-download sphx-glr-download-python docutils container\">\n<p><a class=\"reference download internal\" download=\"\" href=\"../../../_downloads/03e3554d3a6badaf1eea9121bf84d176/reconst_dki.py\"><code class=\"xref download docutils literal notranslate\"><span class=\"pre\">Download</span> <span class=\"pre\">Python</span> <span class=\"pre\">source</span> <span class=\"pre\">code:</span> <span class=\"pre\">reconst_dki.py</span></code></a></p>\n</div>\n<div class=\"sphx-glr-download sphx-glr-download-jupyter docutils container\">\n<p><a class=\"reference download internal\" download=\"\" href=\"../../../_downloads/ec4bd82a58a936966f3eef94e8e0e7ef/reconst_dki.ipynb\"><code class=\"xref download docutils literal notranslate\"><span class=\"pre\">Download</span> <span class=\"pre\">Jupyter</span> <span class=\"pre\">notebook:</span> <span class=\"pre\">reconst_dki.ipynb</span></code></a></p>\n</div>\n</div>\n<p class=\"sphx-glr-signature\"><a class=\"reference external\" href=\"https://sphinx-gallery.github.io\">Gallery generated by Sphinx-Gallery</a></p>\n</section>\n</section>\n</section>\n", "metatags": "<meta name=\"generator\" content=\"Docutils 0.19: https://docutils.sourceforge.io/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["examples_built/07_reconstruction/kfold_xval", "K-fold cross-validation for model comparison", "N", "next"], ["examples_built/07_reconstruction/reconst_dsi_metrics", "Calculate DSI-based scalar maps", "P", "previous"]], "sourcename": "examples_built/07_reconstruction/reconst_dki.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Reconstruction of the diffusion signal with the kurtosis tensor model</a><ul>\n<li><a class=\"reference internal\" href=\"#constrained-optimization-for-dki\">Constrained optimization for DKI</a></li>\n<li><a class=\"reference internal\" href=\"#mean-kurtosis-tensor-and-kurtosis-fractional-anisotropy\">Mean kurtosis tensor and kurtosis fractional anisotropy</a><ul>\n<li><a class=\"reference internal\" href=\"#references\">References</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "examples_built/07_reconstruction/reconst_dki", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}
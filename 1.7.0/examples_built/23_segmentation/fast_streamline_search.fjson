{"parents": [{"link": "../../../documentation/", "title": "Documentation"}, {"link": "../../", "title": "Examples"}, {"link": "../", "title": "Segmentation"}], "prev": {"link": "../segment_clustering_metrics/", "title": "Tractography Clustering - Available Metrics"}, "next": {"link": "../segment_extending_clustering_framework/", "title": "Enhancing QuickBundles with different metrics and features"}, "title": "Fast Streamline Search", "meta": null, "body": "<div class=\"sphx-glr-download-link-note admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>Click <a class=\"reference internal\" href=\"#sphx-glr-download-examples-built-23-segmentation-fast-streamline-search-py\"><span class=\"std std-ref\">here</span></a>\nto download the full example code</p>\n</div>\n<section class=\"sphx-glr-example-title\" id=\"fast-streamline-search\">\n<span id=\"sphx-glr-examples-built-23-segmentation-fast-streamline-search-py\"></span><h1>Fast Streamline Search<a class=\"headerlink\" href=\"#fast-streamline-search\" title=\"Permalink to this heading\">\u00b6</a></h1>\n<p>This example explains how Fast Streamline Search <a class=\"reference internal\" href=\"#stonge2022\" id=\"id1\"><span>[StOnge2022]</span></a>\ncan be used to find all similar streamlines.</p>\n<p>First import the necessary modules.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.data</span> <span class=\"kn\">import</span> <span class=\"p\">(</span><span class=\"n\">get_target_tractogram_hcp</span><span class=\"p\">,</span> <span class=\"n\">get_two_hcp842_bundles</span><span class=\"p\">,</span>\n                       <span class=\"n\">fetch_bundle_atlas_hcp842</span><span class=\"p\">,</span> <span class=\"n\">fetch_target_tractogram_hcp</span><span class=\"p\">)</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.io.streamline</span> <span class=\"kn\">import</span> <span class=\"n\">load_trk</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.segment.fss</span> <span class=\"kn\">import</span> <span class=\"n\">FastStreamlineSearch</span><span class=\"p\">,</span> <span class=\"n\">nearest_from_matrix_row</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.viz</span> <span class=\"kn\">import</span> <span class=\"n\">actor</span><span class=\"p\">,</span> <span class=\"n\">window</span>\n</pre></div>\n</div>\n<p>Download and read data for this tutorial</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">fetch_bundle_atlas_hcp842</span><span class=\"p\">()</span>\n<span class=\"n\">fetch_target_tractogram_hcp</span><span class=\"p\">()</span>\n\n<span class=\"n\">hcp_file</span> <span class=\"o\">=</span> <span class=\"n\">get_target_tractogram_hcp</span><span class=\"p\">()</span>\n<span class=\"n\">streamlines</span> <span class=\"o\">=</span> <span class=\"n\">load_trk</span><span class=\"p\">(</span><span class=\"n\">hcp_file</span><span class=\"p\">,</span> <span class=\"s2\">&quot;same&quot;</span><span class=\"p\">,</span> <span class=\"n\">bbox_valid_check</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">streamlines</span>\n</pre></div>\n</div>\n<p>Visualize the atlas (ref) bundle and full brain tractogram</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">interactive</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n\n<span class=\"n\">scene</span> <span class=\"o\">=</span> <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">Scene</span><span class=\"p\">()</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">SetBackground</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">actor</span><span class=\"o\">.</span><span class=\"n\">line</span><span class=\"p\">(</span><span class=\"n\">streamlines</span><span class=\"p\">))</span>\n<span class=\"k\">if</span> <span class=\"n\">interactive</span><span class=\"p\">:</span>\n    <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">)</span>\n<span class=\"k\">else</span><span class=\"p\">:</span>\n    <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">record</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">,</span> <span class=\"n\">out_path</span><span class=\"o\">=</span><span class=\"s1\">&#39;tractograms_initial.png&#39;</span><span class=\"p\">,</span> <span class=\"n\">size</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">600</span><span class=\"p\">,</span> <span class=\"mi\">600</span><span class=\"p\">))</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_fast_streamline_search_001.png\" srcset=\"../../_images/sphx_glr_fast_streamline_search_001.png\" alt=\"fast streamline search\" class = \"sphx-glr-single-img\"/><figure class=\"align-center\" id=\"id3\">\n<img alt=\"examples_built/23_segmentation/tractograms_initial.png\" src=\"examples_built/23_segmentation/tractograms_initial.png\" />\n<figcaption>\n<p><span class=\"caption-text\">Atlas bundle and source streamlines before registration.</span><a class=\"headerlink\" href=\"#id3\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<p>Read Arcuate Fasciculus Left and Corticospinal Tract Left bundles from already\nfetched atlas data to use them as model bundle. Let\u2019s visualize the\nArcuate Fasciculus Left model bundle.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">model_af_l_file</span><span class=\"p\">,</span> <span class=\"n\">model_cst_l_file</span> <span class=\"o\">=</span> <span class=\"n\">get_two_hcp842_bundles</span><span class=\"p\">()</span>\n<span class=\"n\">sft_af_l</span> <span class=\"o\">=</span> <span class=\"n\">load_trk</span><span class=\"p\">(</span><span class=\"n\">model_af_l_file</span><span class=\"p\">,</span> <span class=\"s2\">&quot;same&quot;</span><span class=\"p\">,</span> <span class=\"n\">bbox_valid_check</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n<span class=\"n\">model_af_l</span> <span class=\"o\">=</span> <span class=\"n\">sft_af_l</span><span class=\"o\">.</span><span class=\"n\">streamlines</span>\n\n<span class=\"n\">scene</span> <span class=\"o\">=</span> <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">Scene</span><span class=\"p\">()</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">SetBackground</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">actor</span><span class=\"o\">.</span><span class=\"n\">line</span><span class=\"p\">(</span><span class=\"n\">model_af_l</span><span class=\"p\">,</span> <span class=\"n\">colors</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)))</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">set_camera</span><span class=\"p\">(</span><span class=\"n\">focal_point</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">18.17281532</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">19.55606842</span><span class=\"p\">,</span> <span class=\"mf\">6.92485857</span><span class=\"p\">),</span>\n                 <span class=\"n\">position</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">360.11</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">30.46</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">40.44</span><span class=\"p\">),</span>\n                 <span class=\"n\">view_up</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">0.03</span><span class=\"p\">,</span> <span class=\"mf\">0.028</span><span class=\"p\">,</span> <span class=\"mf\">0.89</span><span class=\"p\">))</span>\n<span class=\"k\">if</span> <span class=\"n\">interactive</span><span class=\"p\">:</span>\n    <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">)</span>\n<span class=\"k\">else</span><span class=\"p\">:</span>\n    <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">record</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">,</span> <span class=\"n\">out_path</span><span class=\"o\">=</span><span class=\"s1\">&#39;AF_L_model_bundle.png&#39;</span><span class=\"p\">,</span>\n                  <span class=\"n\">size</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">600</span><span class=\"p\">,</span> <span class=\"mi\">600</span><span class=\"p\">))</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_fast_streamline_search_002.png\" srcset=\"../../_images/sphx_glr_fast_streamline_search_002.png\" alt=\"fast streamline search\" class = \"sphx-glr-single-img\"/><figure class=\"align-center\" id=\"id4\">\n<img alt=\"examples_built/23_segmentation/AF_L_model_bundle.png\" src=\"examples_built/23_segmentation/AF_L_model_bundle.png\" />\n<figcaption>\n<p><span class=\"caption-text\">Model Arcuate Fasciculus Left bundle</span><a class=\"headerlink\" href=\"#id4\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<p>Search for all similar streamlines  <a class=\"reference internal\" href=\"#stonge2022\" id=\"id2\"><span>[StOnge2022]</span></a></p>\n<p>Fast Streamline Search can do a radius search\nto find all streamlines that are similar to from one tractogram to another.\nIt return the distance matrix mapping between both tractograms.\nThe same list of streamlines can be given to recover the self distance matrix.</p>\n<blockquote>\n<div><p>FastStreamlinesSearch Class\n- ref_streamlines : reference streamlines, that will be searched in (tree)\n- max_radius : is the maximum distance that can be used with radius search</p>\n<p>radius_search() function\n- radius : for each streamline search find all similar ones in the</p>\n<blockquote>\n<div><p>\u201cref_streamlines\u201d that are within the given radius</p>\n</div></blockquote>\n<p>Be cautious, a large radius might result in a dense distance computation,\nrequiring a large amount of time and memory.\nRecommended range of the radius is from 1 to 10 mm.</p>\n</div></blockquote>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">radius</span> <span class=\"o\">=</span> <span class=\"mf\">7.0</span>\n<span class=\"n\">fs_tree_af</span> <span class=\"o\">=</span> <span class=\"n\">FastStreamlineSearch</span><span class=\"p\">(</span><span class=\"n\">ref_streamlines</span><span class=\"o\">=</span><span class=\"n\">model_af_l</span><span class=\"p\">,</span> <span class=\"n\">max_radius</span><span class=\"o\">=</span><span class=\"n\">radius</span><span class=\"p\">)</span>\n<span class=\"n\">coo_mdist_mtx</span> <span class=\"o\">=</span> <span class=\"n\">fs_tree_af</span><span class=\"o\">.</span><span class=\"n\">radius_search</span><span class=\"p\">(</span><span class=\"n\">streamlines</span><span class=\"p\">,</span> <span class=\"n\">radius</span><span class=\"o\">=</span><span class=\"n\">radius</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Extract indices of streamlines with an similar ones in the reference</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">ids_s</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">unique</span><span class=\"p\">(</span><span class=\"n\">coo_mdist_mtx</span><span class=\"o\">.</span><span class=\"n\">row</span><span class=\"p\">)</span>\n<span class=\"n\">ids_ref</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">unique</span><span class=\"p\">(</span><span class=\"n\">coo_mdist_mtx</span><span class=\"o\">.</span><span class=\"n\">col</span><span class=\"p\">)</span>\n\n<span class=\"n\">recognized_af_l</span> <span class=\"o\">=</span> <span class=\"n\">streamlines</span><span class=\"p\">[</span><span class=\"n\">ids_s</span><span class=\"p\">]</span>\n</pre></div>\n</div>\n<p>let\u2019s visualize streamlines similar to the Arcuate Fasciculus Left bundle</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">scene</span> <span class=\"o\">=</span> <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">Scene</span><span class=\"p\">()</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">SetBackground</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">actor</span><span class=\"o\">.</span><span class=\"n\">line</span><span class=\"p\">(</span><span class=\"n\">recognized_af_l</span><span class=\"p\">,</span> <span class=\"n\">colors</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)))</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">set_camera</span><span class=\"p\">(</span><span class=\"n\">focal_point</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">18.17281532</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">19.55606842</span><span class=\"p\">,</span> <span class=\"mf\">6.92485857</span><span class=\"p\">),</span>\n                 <span class=\"n\">position</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">360.11</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">30.46</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">40.44</span><span class=\"p\">),</span>\n                 <span class=\"n\">view_up</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">0.03</span><span class=\"p\">,</span> <span class=\"mf\">0.028</span><span class=\"p\">,</span> <span class=\"mf\">0.89</span><span class=\"p\">))</span>\n<span class=\"k\">if</span> <span class=\"n\">interactive</span><span class=\"p\">:</span>\n    <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">)</span>\n<span class=\"k\">else</span><span class=\"p\">:</span>\n    <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">record</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">,</span> <span class=\"n\">out_path</span><span class=\"o\">=</span><span class=\"s1\">&#39;AF_L_recognized_bundle.png&#39;</span><span class=\"p\">,</span>\n                  <span class=\"n\">size</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">600</span><span class=\"p\">,</span> <span class=\"mi\">600</span><span class=\"p\">))</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_fast_streamline_search_003.png\" srcset=\"../../_images/sphx_glr_fast_streamline_search_003.png\" alt=\"fast streamline search\" class = \"sphx-glr-single-img\"/><figure class=\"align-center\" id=\"id5\">\n<img alt=\"examples_built/23_segmentation/AF_L_recognized_bundle.png\" src=\"examples_built/23_segmentation/AF_L_recognized_bundle.png\" />\n<figcaption>\n<p><span class=\"caption-text\">Recognized Arcuate Fasciculus Left bundle</span><a class=\"headerlink\" href=\"#id5\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<p>Color the resulting AF by the nearest streamlines distance</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">nn_s</span><span class=\"p\">,</span> <span class=\"n\">nn_ref</span><span class=\"p\">,</span> <span class=\"n\">nn_dist</span> <span class=\"o\">=</span> <span class=\"n\">nearest_from_matrix_row</span><span class=\"p\">(</span><span class=\"n\">coo_mdist_mtx</span><span class=\"p\">)</span>\n\n<span class=\"n\">scene</span> <span class=\"o\">=</span> <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">Scene</span><span class=\"p\">()</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">SetBackground</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"n\">cmap</span> <span class=\"o\">=</span> <span class=\"n\">actor</span><span class=\"o\">.</span><span class=\"n\">colormap_lookup_table</span><span class=\"p\">(</span><span class=\"n\">scale_range</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"n\">nn_dist</span><span class=\"o\">.</span><span class=\"n\">min</span><span class=\"p\">(),</span> <span class=\"n\">nn_dist</span><span class=\"o\">.</span><span class=\"n\">max</span><span class=\"p\">()))</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">actor</span><span class=\"o\">.</span><span class=\"n\">line</span><span class=\"p\">(</span><span class=\"n\">recognized_af_l</span><span class=\"p\">,</span> <span class=\"n\">colors</span><span class=\"o\">=</span><span class=\"n\">nn_dist</span><span class=\"p\">,</span> <span class=\"n\">lookup_colormap</span><span class=\"o\">=</span><span class=\"n\">cmap</span><span class=\"p\">))</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">actor</span><span class=\"o\">.</span><span class=\"n\">scalar_bar</span><span class=\"p\">(</span><span class=\"n\">cmap</span><span class=\"p\">,</span> <span class=\"n\">title</span><span class=\"o\">=</span><span class=\"s2\">&quot;distance to atlas (mm)&quot;</span><span class=\"p\">))</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">set_camera</span><span class=\"p\">(</span><span class=\"n\">focal_point</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">18.17281532</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">19.55606842</span><span class=\"p\">,</span> <span class=\"mf\">6.92485857</span><span class=\"p\">),</span>\n                 <span class=\"n\">position</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">360.11</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">30.46</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">40.44</span><span class=\"p\">),</span>\n                 <span class=\"n\">view_up</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">0.03</span><span class=\"p\">,</span> <span class=\"mf\">0.028</span><span class=\"p\">,</span> <span class=\"mf\">0.89</span><span class=\"p\">))</span>\n<span class=\"k\">if</span> <span class=\"n\">interactive</span><span class=\"p\">:</span>\n    <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">)</span>\n<span class=\"k\">else</span><span class=\"p\">:</span>\n    <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">record</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">,</span> <span class=\"n\">out_path</span><span class=\"o\">=</span><span class=\"s1\">&#39;AF_L_recognized_bundle_dist.png&#39;</span><span class=\"p\">,</span>\n                  <span class=\"n\">size</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">600</span><span class=\"p\">,</span> <span class=\"mi\">600</span><span class=\"p\">))</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_fast_streamline_search_004.png\" srcset=\"../../_images/sphx_glr_fast_streamline_search_004.png\" alt=\"fast streamline search\" class = \"sphx-glr-single-img\"/><figure class=\"align-center\" id=\"id6\">\n<img alt=\"examples_built/23_segmentation/AF_L_recognized_bundle_dist.png\" src=\"examples_built/23_segmentation/AF_L_recognized_bundle_dist.png\" />\n<figcaption>\n<p><span class=\"caption-text\">Recognized Arcuate Fasciculus Left bundle colored by distance to ref</span><a class=\"headerlink\" href=\"#id6\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<p>Display the streamlines reference reached in green</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># Default red color</span>\n<span class=\"n\">ref_color</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">zeros</span><span class=\"p\">((</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">model_af_l</span><span class=\"p\">),</span> <span class=\"mi\">3</span><span class=\"p\">),</span> <span class=\"n\">dtype</span><span class=\"o\">=</span><span class=\"nb\">float</span><span class=\"p\">)</span>\n<span class=\"n\">ref_color</span><span class=\"p\">[:]</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"mf\">1.0</span><span class=\"p\">,</span> <span class=\"mf\">0.0</span><span class=\"p\">,</span> <span class=\"mf\">0.0</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Reached in green color</span>\n<span class=\"n\">ref_color</span><span class=\"p\">[</span><span class=\"n\">ids_ref</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"mf\">0.0</span><span class=\"p\">,</span> <span class=\"mf\">1.0</span><span class=\"p\">,</span> <span class=\"mf\">0.0</span><span class=\"p\">)</span>\n\n<span class=\"n\">scene</span> <span class=\"o\">=</span> <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">Scene</span><span class=\"p\">()</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">SetBackground</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">actor</span><span class=\"o\">.</span><span class=\"n\">line</span><span class=\"p\">(</span><span class=\"n\">model_af_l</span><span class=\"p\">,</span> <span class=\"n\">ref_color</span><span class=\"p\">))</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">set_camera</span><span class=\"p\">(</span><span class=\"n\">focal_point</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">18.17281532</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">19.55606842</span><span class=\"p\">,</span> <span class=\"mf\">6.92485857</span><span class=\"p\">),</span>\n                 <span class=\"n\">position</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">360.11</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">30.46</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">40.44</span><span class=\"p\">),</span>\n                 <span class=\"n\">view_up</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">0.03</span><span class=\"p\">,</span> <span class=\"mf\">0.028</span><span class=\"p\">,</span> <span class=\"mf\">0.89</span><span class=\"p\">))</span>\n\n<span class=\"k\">if</span> <span class=\"n\">interactive</span><span class=\"p\">:</span>\n    <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">)</span>\n<span class=\"k\">else</span><span class=\"p\">:</span>\n    <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">record</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">,</span> <span class=\"n\">out_path</span><span class=\"o\">=</span><span class=\"s1\">&#39;AF_L_model_bundle_reached.png&#39;</span><span class=\"p\">,</span>\n                  <span class=\"n\">size</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">600</span><span class=\"p\">,</span> <span class=\"mi\">600</span><span class=\"p\">))</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_fast_streamline_search_005.png\" srcset=\"../../_images/sphx_glr_fast_streamline_search_005.png\" alt=\"fast streamline search\" class = \"sphx-glr-single-img\"/><figure class=\"align-center\" id=\"id7\">\n<img alt=\"examples_built/23_segmentation/AF_L_model_bundle_reached.png\" src=\"examples_built/23_segmentation/AF_L_model_bundle_reached.png\" />\n<figcaption>\n<p><span class=\"caption-text\">Arcuate Fasciculus Left model reached (green) in radius</span><a class=\"headerlink\" href=\"#id7\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<section id=\"references\">\n<h2>References<a class=\"headerlink\" href=\"#references\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<div role=\"list\" class=\"citation-list\">\n<div class=\"citation\" id=\"stonge2022\" role=\"doc-biblioentry\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span>StOnge2022<span class=\"fn-bracket\">]</span></span>\n<span class=\"backrefs\">(<a role=\"doc-backlink\" href=\"#id1\">1</a>,<a role=\"doc-backlink\" href=\"#id2\">2</a>)</span>\n<p>St-Onge E. et al. Fast Streamline Search:\nAn Exact Technique for Diffusion MRI Tractography.\nNeuroinformatics, 2022.</p>\n</div>\n</div>\n<p class=\"sphx-glr-timing\"><strong>Total running time of the script:</strong> ( 0 minutes  32.225 seconds)</p>\n<div class=\"sphx-glr-footer sphx-glr-footer-example docutils container\" id=\"sphx-glr-download-examples-built-23-segmentation-fast-streamline-search-py\">\n<div class=\"sphx-glr-download sphx-glr-download-python docutils container\">\n<p><a class=\"reference download internal\" download=\"\" href=\"../../../_downloads/7ae0a7fece25afb7793fe533fe494f7b/fast_streamline_search.py\"><code class=\"xref download docutils literal notranslate\"><span class=\"pre\">Download</span> <span class=\"pre\">Python</span> <span class=\"pre\">source</span> <span class=\"pre\">code:</span> <span class=\"pre\">fast_streamline_search.py</span></code></a></p>\n</div>\n<div class=\"sphx-glr-download sphx-glr-download-jupyter docutils container\">\n<p><a class=\"reference download internal\" download=\"\" href=\"../../../_downloads/3e47624a323d7a9805730aa5b9c7cb3b/fast_streamline_search.ipynb\"><code class=\"xref download docutils literal notranslate\"><span class=\"pre\">Download</span> <span class=\"pre\">Jupyter</span> <span class=\"pre\">notebook:</span> <span class=\"pre\">fast_streamline_search.ipynb</span></code></a></p>\n</div>\n</div>\n<p class=\"sphx-glr-signature\"><a class=\"reference external\" href=\"https://sphinx-gallery.github.io\">Gallery generated by Sphinx-Gallery</a></p>\n</section>\n</section>\n", "metatags": "<meta name=\"generator\" content=\"Docutils 0.19: https://docutils.sourceforge.io/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["examples_built/23_segmentation/segment_extending_clustering_framework", "Enhancing QuickBundles with different metrics and features", "N", "next"], ["examples_built/23_segmentation/segment_clustering_metrics", "Tractography Clustering - Available Metrics", "P", "previous"]], "sourcename": "examples_built/23_segmentation/fast_streamline_search.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Fast Streamline Search</a><ul>\n<li><a class=\"reference internal\" href=\"#references\">References</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "examples_built/23_segmentation/fast_streamline_search", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}
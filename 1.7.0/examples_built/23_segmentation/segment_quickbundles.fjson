{"parents": [{"link": "../../../documentation/", "title": "Documentation"}, {"link": "../../", "title": "Examples"}, {"link": "../", "title": "Segmentation"}], "prev": {"link": "../brain_extraction_dwi_1/", "title": "Brain segmentation with median_otsu"}, "next": {"link": "../tissue_classification/", "title": "Tissue Classification of a T1-weighted Structural Image"}, "title": "Tractography Clustering with QuickBundles", "meta": null, "body": "<div class=\"sphx-glr-download-link-note admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>Click <a class=\"reference internal\" href=\"#sphx-glr-download-examples-built-23-segmentation-segment-quickbundles-py\"><span class=\"std std-ref\">here</span></a>\nto download the full example code</p>\n</div>\n<section class=\"sphx-glr-example-title\" id=\"tractography-clustering-with-quickbundles\">\n<span id=\"sphx-glr-examples-built-23-segmentation-segment-quickbundles-py\"></span><h1>Tractography Clustering with QuickBundles<a class=\"headerlink\" href=\"#tractography-clustering-with-quickbundles\" title=\"Permalink to this heading\">\u00b6</a></h1>\n<p>This example explains how we can use QuickBundles <a class=\"reference internal\" href=\"#garyfallidis12\" id=\"id1\"><span>[Garyfallidis12]</span></a> to\nsimplify/cluster streamlines.</p>\n<p>First import the necessary modules.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.io.streamline</span> <span class=\"kn\">import</span> <span class=\"n\">load_tractogram</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.segment.clustering</span> <span class=\"kn\">import</span> <span class=\"n\">QuickBundles</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.io.pickles</span> <span class=\"kn\">import</span> <span class=\"n\">save_pickle</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.data</span> <span class=\"kn\">import</span> <span class=\"n\">get_fnames</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.viz</span> <span class=\"kn\">import</span> <span class=\"n\">window</span><span class=\"p\">,</span> <span class=\"n\">actor</span><span class=\"p\">,</span> <span class=\"n\">colormap</span>\n</pre></div>\n</div>\n<p>For educational purposes we will try to cluster a small streamline bundle known\nfrom neuroanatomy as the fornix.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">fname</span> <span class=\"o\">=</span> <span class=\"n\">get_fnames</span><span class=\"p\">(</span><span class=\"s1\">&#39;fornix&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Load fornix streamlines.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">fornix</span> <span class=\"o\">=</span> <span class=\"n\">load_tractogram</span><span class=\"p\">(</span><span class=\"n\">fname</span><span class=\"p\">,</span> <span class=\"s1\">&#39;same&#39;</span><span class=\"p\">,</span> <span class=\"n\">bbox_valid_check</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n<span class=\"n\">streamlines</span> <span class=\"o\">=</span> <span class=\"n\">fornix</span><span class=\"o\">.</span><span class=\"n\">streamlines</span>\n</pre></div>\n</div>\n<p>Perform QuickBundles clustering using the MDF metric and a 10mm distance\nthreshold. Keep in mind that since the MDF metric requires streamlines to have\nthe same number of points, the clustering algorithm will internally use a\nrepresentation of streamlines that have been automatically downsampled/upsampled\nso they have only 12 points (To set manually the number of points,\nsee <a class=\"reference internal\" href=\"../segment_clustering_features/#clustering-examples-resamplefeature\"><span class=\"std std-ref\">Resample Feature</span></a>).</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">qb</span> <span class=\"o\">=</span> <span class=\"n\">QuickBundles</span><span class=\"p\">(</span><span class=\"n\">threshold</span><span class=\"o\">=</span><span class=\"mf\">10.</span><span class=\"p\">)</span>\n<span class=\"n\">clusters</span> <span class=\"o\">=</span> <span class=\"n\">qb</span><span class=\"o\">.</span><span class=\"n\">cluster</span><span class=\"p\">(</span><span class=\"n\">streamlines</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p><cite>clusters</cite> is a <cite>ClusterMap</cite> object which contains attributes that\nprovide information about the clustering result.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;Nb. clusters:&quot;</span><span class=\"p\">,</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">clusters</span><span class=\"p\">))</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;Cluster sizes:&quot;</span><span class=\"p\">,</span> <span class=\"nb\">map</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">,</span> <span class=\"n\">clusters</span><span class=\"p\">))</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;Small clusters:&quot;</span><span class=\"p\">,</span> <span class=\"n\">clusters</span> <span class=\"o\">&lt;</span> <span class=\"mi\">10</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;Streamlines indices of the first cluster:</span><span class=\"se\">\\n</span><span class=\"s2\">&quot;</span><span class=\"p\">,</span> <span class=\"n\">clusters</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">indices</span><span class=\"p\">)</span>\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;Centroid of the last cluster:</span><span class=\"se\">\\n</span><span class=\"s2\">&quot;</span><span class=\"p\">,</span> <span class=\"n\">clusters</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">centroid</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"sphx-glr-script-out highlight-none notranslate\"><div class=\"highlight\"><pre><span></span>Nb. clusters: 4\nCluster sizes: &lt;map object at 0x2bdd6dc70&gt;\nSmall clusters: [False False False  True]\nStreamlines indices of the first cluster:\n [0, 7, 8, 10, 11, 12, 13, 14, 15, 18, 26, 30, 33, 35, 41, 65, 66, 85, 100, 101, 105, 115, 116, 119, 122, 123, 124, 125, 126, 128, 129, 135, 139, 142, 143, 144, 148, 151, 159, 167, 175, 180, 181, 185, 200, 208, 210, 224, 237, 246, 249, 251, 256, 267, 270, 280, 284, 293, 296, 297, 299]\nCentroid of the last cluster:\n [[ 84.83774  117.9259    77.322784]\n [ 86.108505 115.84363   81.91885 ]\n [ 86.40357  112.25677   85.7293  ]\n [ 86.48337  107.60328   88.137825]\n [ 86.238976 102.51007   89.29447 ]\n [ 85.04564   97.460205  88.542404]\n [ 82.6024    93.14851   86.84209 ]\n [ 78.98937   89.57682   85.63652 ]\n [ 74.72344   86.60828   84.939186]\n [ 70.40846   85.158745  82.4484  ]\n [ 66.745346  86.002625  78.82582 ]\n [ 64.02451   88.43942   75.06974 ]]\n</pre></div>\n</div>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">Nb</span><span class=\"o\">.</span> <span class=\"n\">clusters</span><span class=\"p\">:</span> <span class=\"mi\">4</span>\n\n<span class=\"n\">Cluster</span> <span class=\"n\">sizes</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"mi\">64</span><span class=\"p\">,</span> <span class=\"mi\">191</span><span class=\"p\">,</span> <span class=\"mi\">47</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]</span>\n\n<span class=\"n\">Small</span> <span class=\"n\">clusters</span><span class=\"p\">:</span> <span class=\"n\">array</span><span class=\"p\">([</span><span class=\"kc\">False</span><span class=\"p\">,</span> <span class=\"kc\">False</span><span class=\"p\">,</span> <span class=\"kc\">False</span><span class=\"p\">,</span> <span class=\"kc\">True</span><span class=\"p\">],</span> <span class=\"n\">dtype</span><span class=\"o\">=</span><span class=\"nb\">bool</span><span class=\"p\">)</span>\n\n<span class=\"n\">Streamlines</span> <span class=\"n\">indices</span> <span class=\"n\">of</span> <span class=\"n\">the</span> <span class=\"n\">first</span> <span class=\"n\">cluster</span><span class=\"p\">:</span>\n<span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">7</span><span class=\"p\">,</span> <span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">11</span><span class=\"p\">,</span> <span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"mi\">13</span><span class=\"p\">,</span> <span class=\"mi\">14</span><span class=\"p\">,</span> <span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"mi\">18</span><span class=\"p\">,</span> <span class=\"mi\">26</span><span class=\"p\">,</span> <span class=\"mi\">30</span><span class=\"p\">,</span> <span class=\"mi\">33</span><span class=\"p\">,</span> <span class=\"mi\">35</span><span class=\"p\">,</span> <span class=\"mi\">41</span><span class=\"p\">,</span> <span class=\"mi\">65</span><span class=\"p\">,</span> <span class=\"mi\">66</span><span class=\"p\">,</span> <span class=\"mi\">85</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">,</span>\n <span class=\"mi\">101</span><span class=\"p\">,</span> <span class=\"mi\">105</span><span class=\"p\">,</span> <span class=\"mi\">115</span><span class=\"p\">,</span> <span class=\"mi\">116</span><span class=\"p\">,</span> <span class=\"mi\">119</span><span class=\"p\">,</span> <span class=\"mi\">122</span><span class=\"p\">,</span> <span class=\"mi\">123</span><span class=\"p\">,</span> <span class=\"mi\">124</span><span class=\"p\">,</span> <span class=\"mi\">125</span><span class=\"p\">,</span> <span class=\"mi\">126</span><span class=\"p\">,</span> <span class=\"mi\">128</span><span class=\"p\">,</span> <span class=\"mi\">129</span><span class=\"p\">,</span> <span class=\"mi\">135</span><span class=\"p\">,</span> <span class=\"mi\">139</span><span class=\"p\">,</span> <span class=\"mi\">142</span><span class=\"p\">,</span>\n <span class=\"mi\">143</span><span class=\"p\">,</span> <span class=\"mi\">144</span><span class=\"p\">,</span> <span class=\"mi\">148</span><span class=\"p\">,</span> <span class=\"mi\">151</span><span class=\"p\">,</span> <span class=\"mi\">159</span><span class=\"p\">,</span> <span class=\"mi\">167</span><span class=\"p\">,</span> <span class=\"mi\">175</span><span class=\"p\">,</span> <span class=\"mi\">180</span><span class=\"p\">,</span> <span class=\"mi\">181</span><span class=\"p\">,</span> <span class=\"mi\">185</span><span class=\"p\">,</span> <span class=\"mi\">200</span><span class=\"p\">,</span> <span class=\"mi\">208</span><span class=\"p\">,</span> <span class=\"mi\">210</span><span class=\"p\">,</span> <span class=\"mi\">224</span><span class=\"p\">,</span> <span class=\"mi\">237</span><span class=\"p\">,</span>\n <span class=\"mi\">246</span><span class=\"p\">,</span> <span class=\"mi\">249</span><span class=\"p\">,</span> <span class=\"mi\">251</span><span class=\"p\">,</span> <span class=\"mi\">256</span><span class=\"p\">,</span> <span class=\"mi\">267</span><span class=\"p\">,</span> <span class=\"mi\">270</span><span class=\"p\">,</span> <span class=\"mi\">280</span><span class=\"p\">,</span> <span class=\"mi\">284</span><span class=\"p\">,</span> <span class=\"mi\">293</span><span class=\"p\">,</span> <span class=\"mi\">296</span><span class=\"p\">,</span> <span class=\"mi\">297</span><span class=\"p\">,</span> <span class=\"mi\">299</span><span class=\"p\">]</span>\n\n<span class=\"n\">Centroid</span> <span class=\"n\">of</span> <span class=\"n\">the</span> <span class=\"n\">last</span> <span class=\"n\">cluster</span><span class=\"p\">:</span>\n<span class=\"n\">array</span><span class=\"p\">([[</span>  <span class=\"mf\">84.83773804</span><span class=\"p\">,</span>  <span class=\"mf\">117.92590332</span><span class=\"p\">,</span>   <span class=\"mf\">77.32278442</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span>  <span class=\"mf\">86.10850525</span><span class=\"p\">,</span>  <span class=\"mf\">115.84362793</span><span class=\"p\">,</span>   <span class=\"mf\">81.91885376</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span>  <span class=\"mf\">86.40357208</span><span class=\"p\">,</span>  <span class=\"mf\">112.25676727</span><span class=\"p\">,</span>   <span class=\"mf\">85.72930145</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span>  <span class=\"mf\">86.48336792</span><span class=\"p\">,</span>  <span class=\"mf\">107.60327911</span><span class=\"p\">,</span>   <span class=\"mf\">88.13782501</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span>  <span class=\"mf\">86.23897552</span><span class=\"p\">,</span>  <span class=\"mf\">102.5100708</span> <span class=\"p\">,</span>   <span class=\"mf\">89.29447174</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span>  <span class=\"mf\">85.04563904</span><span class=\"p\">,</span>   <span class=\"mf\">97.46020508</span><span class=\"p\">,</span>   <span class=\"mf\">88.54240417</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span>  <span class=\"mf\">82.60240173</span><span class=\"p\">,</span>   <span class=\"mf\">93.14851379</span><span class=\"p\">,</span>   <span class=\"mf\">86.84208679</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span>  <span class=\"mf\">78.98937225</span><span class=\"p\">,</span>   <span class=\"mf\">89.57682037</span><span class=\"p\">,</span>   <span class=\"mf\">85.63652039</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span>  <span class=\"mf\">74.72344208</span><span class=\"p\">,</span>   <span class=\"mf\">86.60827637</span><span class=\"p\">,</span>   <span class=\"mf\">84.9391861</span> <span class=\"p\">],</span>\n       <span class=\"p\">[</span>  <span class=\"mf\">70.40846252</span><span class=\"p\">,</span>   <span class=\"mf\">85.15874481</span><span class=\"p\">,</span>   <span class=\"mf\">82.4484024</span> <span class=\"p\">],</span>\n       <span class=\"p\">[</span>  <span class=\"mf\">66.74534607</span><span class=\"p\">,</span>   <span class=\"mf\">86.00262451</span><span class=\"p\">,</span>   <span class=\"mf\">78.82582092</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span>  <span class=\"mf\">64.02451324</span><span class=\"p\">,</span>   <span class=\"mf\">88.43942261</span><span class=\"p\">,</span>   <span class=\"mf\">75.0697403</span> <span class=\"p\">]],</span> <span class=\"n\">dtype</span><span class=\"o\">=</span><span class=\"n\">float32</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p><cite>clusters</cite> also has attributes such as <cite>centroids</cite> (cluster representatives), and\nmethods like <cite>add</cite>, <cite>remove</cite>, and <cite>clear</cite> to modify the clustering result.</p>\n<p>Let\u2019s first show the initial dataset.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># Enables/disables interactive visualization</span>\n<span class=\"n\">interactive</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n\n<span class=\"n\">scene</span> <span class=\"o\">=</span> <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">Scene</span><span class=\"p\">()</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">SetBackground</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">actor</span><span class=\"o\">.</span><span class=\"n\">streamtube</span><span class=\"p\">(</span><span class=\"n\">streamlines</span><span class=\"p\">,</span> <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">colors</span><span class=\"o\">.</span><span class=\"n\">white</span><span class=\"p\">))</span>\n<span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">record</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">,</span> <span class=\"n\">out_path</span><span class=\"o\">=</span><span class=\"s1\">&#39;fornix_initial.png&#39;</span><span class=\"p\">,</span> <span class=\"n\">size</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">600</span><span class=\"p\">,</span> <span class=\"mi\">600</span><span class=\"p\">))</span>\n<span class=\"k\">if</span> <span class=\"n\">interactive</span><span class=\"p\">:</span>\n    <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_segment_quickbundles_001.png\" srcset=\"../../_images/sphx_glr_segment_quickbundles_001.png\" alt=\"segment quickbundles\" class = \"sphx-glr-single-img\"/><figure class=\"align-center\" id=\"id2\">\n<img alt=\"examples_built/23_segmentation/fornix_initial.png\" src=\"examples_built/23_segmentation/fornix_initial.png\" />\n<figcaption>\n<p><span class=\"caption-text\">Initial Fornix dataset.</span><a class=\"headerlink\" href=\"#id2\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<p>Show the centroids of the fornix after clustering (with random colors):</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">colormap</span> <span class=\"o\">=</span> <span class=\"n\">colormap</span><span class=\"o\">.</span><span class=\"n\">create_colormap</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">clusters</span><span class=\"p\">)))</span>\n\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">clear</span><span class=\"p\">()</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">SetBackground</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">actor</span><span class=\"o\">.</span><span class=\"n\">streamtube</span><span class=\"p\">(</span><span class=\"n\">streamlines</span><span class=\"p\">,</span> <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">colors</span><span class=\"o\">.</span><span class=\"n\">white</span><span class=\"p\">,</span> <span class=\"n\">opacity</span><span class=\"o\">=</span><span class=\"mf\">0.05</span><span class=\"p\">))</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">actor</span><span class=\"o\">.</span><span class=\"n\">streamtube</span><span class=\"p\">(</span><span class=\"n\">clusters</span><span class=\"o\">.</span><span class=\"n\">centroids</span><span class=\"p\">,</span> <span class=\"n\">colormap</span><span class=\"p\">,</span> <span class=\"n\">linewidth</span><span class=\"o\">=</span><span class=\"mf\">0.4</span><span class=\"p\">))</span>\n<span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">record</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">,</span> <span class=\"n\">out_path</span><span class=\"o\">=</span><span class=\"s1\">&#39;fornix_centroids.png&#39;</span><span class=\"p\">,</span> <span class=\"n\">size</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">600</span><span class=\"p\">,</span> <span class=\"mi\">600</span><span class=\"p\">))</span>\n<span class=\"k\">if</span> <span class=\"n\">interactive</span><span class=\"p\">:</span>\n    <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_segment_quickbundles_002.png\" srcset=\"../../_images/sphx_glr_segment_quickbundles_002.png\" alt=\"segment quickbundles\" class = \"sphx-glr-single-img\"/><figure class=\"align-center\" id=\"id3\">\n<img alt=\"examples_built/23_segmentation/fornix_centroids.png\" src=\"examples_built/23_segmentation/fornix_centroids.png\" />\n<figcaption>\n<p><span class=\"caption-text\">Showing the different QuickBundles centroids with random colors.</span><a class=\"headerlink\" href=\"#id3\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<p>Show the labeled fornix (colors from centroids).</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">colormap_full</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">ones</span><span class=\"p\">((</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">streamlines</span><span class=\"p\">),</span> <span class=\"mi\">3</span><span class=\"p\">))</span>\n<span class=\"k\">for</span> <span class=\"n\">cluster</span><span class=\"p\">,</span> <span class=\"n\">color</span> <span class=\"ow\">in</span> <span class=\"nb\">zip</span><span class=\"p\">(</span><span class=\"n\">clusters</span><span class=\"p\">,</span> <span class=\"n\">colormap</span><span class=\"p\">):</span>\n    <span class=\"n\">colormap_full</span><span class=\"p\">[</span><span class=\"n\">cluster</span><span class=\"o\">.</span><span class=\"n\">indices</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">color</span>\n\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">clear</span><span class=\"p\">()</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">SetBackground</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"n\">scene</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span><span class=\"n\">actor</span><span class=\"o\">.</span><span class=\"n\">streamtube</span><span class=\"p\">(</span><span class=\"n\">streamlines</span><span class=\"p\">,</span> <span class=\"n\">colormap_full</span><span class=\"p\">))</span>\n<span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">record</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">,</span> <span class=\"n\">out_path</span><span class=\"o\">=</span><span class=\"s1\">&#39;fornix_clusters.png&#39;</span><span class=\"p\">,</span> <span class=\"n\">size</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">600</span><span class=\"p\">,</span> <span class=\"mi\">600</span><span class=\"p\">))</span>\n<span class=\"k\">if</span> <span class=\"n\">interactive</span><span class=\"p\">:</span>\n    <span class=\"n\">window</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">(</span><span class=\"n\">scene</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_segment_quickbundles_003.png\" srcset=\"../../_images/sphx_glr_segment_quickbundles_003.png\" alt=\"segment quickbundles\" class = \"sphx-glr-single-img\"/><figure class=\"align-center\" id=\"id4\">\n<img alt=\"examples_built/23_segmentation/fornix_clusters.png\" src=\"examples_built/23_segmentation/fornix_clusters.png\" />\n<figcaption>\n<p><span class=\"caption-text\">Showing the different clusters.</span><a class=\"headerlink\" href=\"#id4\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<p>It is also possible to save the complete <cite>ClusterMap</cite> object with pickling.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">save_pickle</span><span class=\"p\">(</span><span class=\"s1\">&#39;QB.pkl&#39;</span><span class=\"p\">,</span> <span class=\"n\">clusters</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Finally, here is a video of QuickBundles applied on a larger dataset.</p>\n<iframe width=\"420\" height=\"315\" src=\"http://www.youtube.com/embed/kstL7KKqu94\" frameborder=\"0\" allowfullscreen></iframe><section id=\"references\">\n<h2>References<a class=\"headerlink\" href=\"#references\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<div role=\"list\" class=\"citation-list\">\n<div class=\"citation\" id=\"garyfallidis12\" role=\"doc-biblioentry\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id1\">Garyfallidis12</a><span class=\"fn-bracket\">]</span></span>\n<p>Garyfallidis E. et al., QuickBundles a method for\ntractography simplification, Frontiers in Neuroscience, vol\n6, no 175, 2012.</p>\n</div>\n</div>\n<p class=\"sphx-glr-timing\"><strong>Total running time of the script:</strong> ( 0 minutes  0.293 seconds)</p>\n<div class=\"sphx-glr-footer sphx-glr-footer-example docutils container\" id=\"sphx-glr-download-examples-built-23-segmentation-segment-quickbundles-py\">\n<div class=\"sphx-glr-download sphx-glr-download-python docutils container\">\n<p><a class=\"reference download internal\" download=\"\" href=\"../../../_downloads/2efbfb6edeae69520afc63ebaa0b5064/segment_quickbundles.py\"><code class=\"xref download docutils literal notranslate\"><span class=\"pre\">Download</span> <span class=\"pre\">Python</span> <span class=\"pre\">source</span> <span class=\"pre\">code:</span> <span class=\"pre\">segment_quickbundles.py</span></code></a></p>\n</div>\n<div class=\"sphx-glr-download sphx-glr-download-jupyter docutils container\">\n<p><a class=\"reference download internal\" download=\"\" href=\"../../../_downloads/0e9cd82beb791454ba270b645dc25bba/segment_quickbundles.ipynb\"><code class=\"xref download docutils literal notranslate\"><span class=\"pre\">Download</span> <span class=\"pre\">Jupyter</span> <span class=\"pre\">notebook:</span> <span class=\"pre\">segment_quickbundles.ipynb</span></code></a></p>\n</div>\n</div>\n<p class=\"sphx-glr-signature\"><a class=\"reference external\" href=\"https://sphinx-gallery.github.io\">Gallery generated by Sphinx-Gallery</a></p>\n</section>\n</section>\n", "metatags": "<meta name=\"generator\" content=\"Docutils 0.19: https://docutils.sourceforge.io/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["examples_built/23_segmentation/tissue_classification", "Tissue Classification of a T1-weighted Structural Image", "N", "next"], ["examples_built/23_segmentation/brain_extraction_dwi_1", "Brain segmentation with median_otsu", "P", "previous"]], "sourcename": "examples_built/23_segmentation/segment_quickbundles.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Tractography Clustering with QuickBundles</a><ul>\n<li><a class=\"reference internal\" href=\"#references\">References</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "examples_built/23_segmentation/segment_quickbundles", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}
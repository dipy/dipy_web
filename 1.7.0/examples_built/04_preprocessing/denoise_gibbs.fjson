{"parents": [{"link": "../../../documentation/", "title": "Documentation"}, {"link": "../../", "title": "Examples"}, {"link": "../", "title": "Preprocessing"}], "prev": {"link": "../denoise_mppca/", "title": "Denoise images using the Marcenko-Pastur PCA algorithm"}, "next": {"link": "../../07_reconstruction/", "title": "Reconstruction"}, "title": "Suppress Gibbs oscillations", "meta": null, "body": "<div class=\"sphx-glr-download-link-note admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>Click <a class=\"reference internal\" href=\"#sphx-glr-download-examples-built-04-preprocessing-denoise-gibbs-py\"><span class=\"std std-ref\">here</span></a>\nto download the full example code</p>\n</div>\n<section class=\"sphx-glr-example-title\" id=\"suppress-gibbs-oscillations\">\n<span id=\"sphx-glr-examples-built-04-preprocessing-denoise-gibbs-py\"></span><h1>Suppress Gibbs oscillations<a class=\"headerlink\" href=\"#suppress-gibbs-oscillations\" title=\"Permalink to this heading\">\u00b6</a></h1>\n<p>Magnetic Resonance (MR) images are reconstructed from the Fourier coefficients\nof acquired k-space images. Since only a finite number of Fourier coefficients\ncan be acquired in practice, reconstructed MR images can be corrupted by Gibbs\nartefacts, which is manifested by intensity oscillations adjacent to edges of\ndifferent tissues types <a class=\"footnote-reference brackets\" href=\"#id9\" id=\"id1\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>1<span class=\"fn-bracket\">]</span></a>. Although this artefact affects MR images in\ngeneral, in the context of diffusion-weighted imaging, Gibbs oscillations\ncan be magnified in derived diffusion-based estimates <a class=\"footnote-reference brackets\" href=\"#id9\" id=\"id2\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>1<span class=\"fn-bracket\">]</span></a>, <a class=\"footnote-reference brackets\" href=\"#id10\" id=\"id3\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>2<span class=\"fn-bracket\">]</span></a>.</p>\n<p>In the following example, we show how to suppress Gibbs artefacts of MR images.\nThis algorithm is based on an adapted version of a sub-voxel Gibbs suppression\nprocedure <a class=\"footnote-reference brackets\" href=\"#id11\" id=\"id4\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>3<span class=\"fn-bracket\">]</span></a>. Full details of the implemented algorithm can be found in\nchapter 3 of <a class=\"footnote-reference brackets\" href=\"#id12\" id=\"id5\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>4<span class=\"fn-bracket\">]</span></a>  (please cite <a class=\"footnote-reference brackets\" href=\"#id11\" id=\"id6\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>3<span class=\"fn-bracket\">]</span></a>, <a class=\"footnote-reference brackets\" href=\"#id12\" id=\"id7\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>4<span class=\"fn-bracket\">]</span></a> if you are using this code).</p>\n<p>The algorithm to suppress Gibbs oscillations can be imported from the denoise\nmodule of dipy:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">dipy.denoise.gibbs</span> <span class=\"kn\">import</span> <span class=\"n\">gibbs_removal</span>\n</pre></div>\n</div>\n<p>We first apply this algorithm to a T1-weighted dataset which can be fetched\nusing the following code:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">dipy.data</span> <span class=\"kn\">import</span> <span class=\"n\">get_fnames</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.io.image</span> <span class=\"kn\">import</span> <span class=\"n\">load_nifti_data</span>\n\n\n<span class=\"n\">t1_fname</span><span class=\"p\">,</span> <span class=\"n\">t1_denoised_fname</span><span class=\"p\">,</span> <span class=\"n\">ap_fname</span> <span class=\"o\">=</span> <span class=\"n\">get_fnames</span><span class=\"p\">(</span><span class=\"s1\">&#39;tissue_data&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">t1</span> <span class=\"o\">=</span> <span class=\"n\">load_nifti_data</span><span class=\"p\">(</span><span class=\"n\">t1_denoised_fname</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Let\u2019s plot a slice of this dataset.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">matplotlib.pyplot</span> <span class=\"k\">as</span> <span class=\"nn\">plt</span>\n<span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n\n<span class=\"n\">axial_slice</span> <span class=\"o\">=</span> <span class=\"mi\">88</span>\n<span class=\"n\">t1_slice</span> <span class=\"o\">=</span> <span class=\"n\">t1</span><span class=\"p\">[</span><span class=\"o\">...</span><span class=\"p\">,</span> <span class=\"n\">axial_slice</span><span class=\"p\">]</span>\n\n<span class=\"n\">fig</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">figure</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">15</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">))</span>\n<span class=\"n\">fig</span><span class=\"o\">.</span><span class=\"n\">subplots_adjust</span><span class=\"p\">(</span><span class=\"n\">wspace</span><span class=\"o\">=</span><span class=\"mf\">0.2</span><span class=\"p\">)</span>\n\n<span class=\"n\">t1_slice</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">rot90</span><span class=\"p\">(</span><span class=\"n\">t1_slice</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplot</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">t1_slice</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mi\">400</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">colorbar</span><span class=\"p\">()</span>\n<span class=\"n\">fig</span><span class=\"o\">.</span><span class=\"n\">savefig</span><span class=\"p\">(</span><span class=\"s1\">&#39;structural.png&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_denoise_gibbs_001.png\" srcset=\"../../_images/sphx_glr_denoise_gibbs_001.png\" alt=\"denoise gibbs\" class = \"sphx-glr-single-img\"/><figure class=\"align-center\" id=\"id14\">\n<img alt=\"examples_built/04_preprocessing/structural.png\" src=\"examples_built/04_preprocessing/structural.png\" />\n<figcaption>\n<p><span class=\"caption-text\">Representative slice of a T1-weighted structural image.</span><a class=\"headerlink\" href=\"#id14\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<p>Due to the high quality of the data, Gibbs artefacts are not visually\nevident in this dataset. Therefore, to analyse the benefits of the Gibbs\nsuppression algorithm, Gibbs artefacts are artificially introduced by\nremoving high frequencies of the image\u2019s Fourier transform.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">c</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">fft</span><span class=\"o\">.</span><span class=\"n\">fft2</span><span class=\"p\">(</span><span class=\"n\">t1_slice</span><span class=\"p\">)</span>\n<span class=\"n\">c</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">fft</span><span class=\"o\">.</span><span class=\"n\">fftshift</span><span class=\"p\">(</span><span class=\"n\">c</span><span class=\"p\">)</span>\n<span class=\"n\">N</span> <span class=\"o\">=</span> <span class=\"n\">c</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n<span class=\"n\">c_crop</span> <span class=\"o\">=</span> <span class=\"n\">c</span><span class=\"p\">[</span><span class=\"mi\">64</span><span class=\"p\">:</span> <span class=\"mi\">192</span><span class=\"p\">,</span> <span class=\"mi\">64</span><span class=\"p\">:</span> <span class=\"mi\">192</span><span class=\"p\">]</span>\n<span class=\"n\">N</span> <span class=\"o\">=</span> <span class=\"n\">c_crop</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n<span class=\"n\">t1_gibbs</span> <span class=\"o\">=</span> <span class=\"nb\">abs</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">fft</span><span class=\"o\">.</span><span class=\"n\">ifft2</span><span class=\"p\">(</span><span class=\"n\">c_crop</span><span class=\"p\">)</span><span class=\"o\">/</span><span class=\"mi\">4</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Gibbs oscillation suppression of this single data slice can be performed by\nrunning the following command:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">t1_unring</span> <span class=\"o\">=</span> <span class=\"n\">gibbs_removal</span><span class=\"p\">(</span><span class=\"n\">t1_gibbs</span><span class=\"p\">,</span> <span class=\"n\">inplace</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Let\u2019s plot the results:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">fig1</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">),</span>\n                        <span class=\"n\">subplot_kw</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">&#39;xticks&#39;</span><span class=\"p\">:</span> <span class=\"p\">[],</span> <span class=\"s1\">&#39;yticks&#39;</span><span class=\"p\">:</span> <span class=\"p\">[]})</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">t1_gibbs</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s2\">&quot;gray&quot;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mi\">400</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">annotate</span><span class=\"p\">(</span><span class=\"s1\">&#39;Rings&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">xy</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">81</span><span class=\"p\">,</span> <span class=\"mi\">70</span><span class=\"p\">),</span>\n                    <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span>\n                    <span class=\"n\">xycoords</span><span class=\"o\">=</span><span class=\"s1\">&#39;data&#39;</span><span class=\"p\">,</span> <span class=\"n\">xytext</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">30</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">),</span>\n                    <span class=\"n\">textcoords</span><span class=\"o\">=</span><span class=\"s1\">&#39;offset points&#39;</span><span class=\"p\">,</span>\n                    <span class=\"n\">arrowprops</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">arrowstyle</span><span class=\"o\">=</span><span class=\"s2\">&quot;-&gt;&quot;</span><span class=\"p\">,</span>\n                                    <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">))</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">annotate</span><span class=\"p\">(</span><span class=\"s1\">&#39;Rings&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">xy</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">75</span><span class=\"p\">,</span> <span class=\"mi\">50</span><span class=\"p\">),</span>\n                    <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span>\n                    <span class=\"n\">xycoords</span><span class=\"o\">=</span><span class=\"s1\">&#39;data&#39;</span><span class=\"p\">,</span> <span class=\"n\">xytext</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">30</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">),</span>\n                    <span class=\"n\">textcoords</span><span class=\"o\">=</span><span class=\"s1\">&#39;offset points&#39;</span><span class=\"p\">,</span>\n                    <span class=\"n\">arrowprops</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">arrowstyle</span><span class=\"o\">=</span><span class=\"s2\">&quot;-&gt;&quot;</span><span class=\"p\">,</span>\n                                    <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">))</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">t1_unring</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s2\">&quot;gray&quot;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mi\">400</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">annotate</span><span class=\"p\">(</span><span class=\"s1\">&#39;WM/GM&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">xy</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">75</span><span class=\"p\">,</span> <span class=\"mi\">50</span><span class=\"p\">),</span>\n                    <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">,</span>\n                    <span class=\"n\">xycoords</span><span class=\"o\">=</span><span class=\"s1\">&#39;data&#39;</span><span class=\"p\">,</span> <span class=\"n\">xytext</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">30</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">),</span>\n                    <span class=\"n\">textcoords</span><span class=\"o\">=</span><span class=\"s1\">&#39;offset points&#39;</span><span class=\"p\">,</span>\n                    <span class=\"n\">arrowprops</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">arrowstyle</span><span class=\"o\">=</span><span class=\"s2\">&quot;-&gt;&quot;</span><span class=\"p\">,</span>\n                                    <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;green&#39;</span><span class=\"p\">))</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">t1_unring</span> <span class=\"o\">-</span> <span class=\"n\">t1_gibbs</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s2\">&quot;gray&quot;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">annotate</span><span class=\"p\">(</span><span class=\"s1\">&#39;Rings&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">xy</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">81</span><span class=\"p\">,</span> <span class=\"mi\">70</span><span class=\"p\">),</span>\n                    <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span>\n                    <span class=\"n\">xycoords</span><span class=\"o\">=</span><span class=\"s1\">&#39;data&#39;</span><span class=\"p\">,</span> <span class=\"n\">xytext</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">30</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">),</span>\n                    <span class=\"n\">textcoords</span><span class=\"o\">=</span><span class=\"s1\">&#39;offset points&#39;</span><span class=\"p\">,</span>\n                    <span class=\"n\">arrowprops</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">arrowstyle</span><span class=\"o\">=</span><span class=\"s2\">&quot;-&gt;&quot;</span><span class=\"p\">,</span>\n                                    <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">))</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">annotate</span><span class=\"p\">(</span><span class=\"s1\">&#39;Rings&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">xy</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">75</span><span class=\"p\">,</span> <span class=\"mi\">50</span><span class=\"p\">),</span>\n                    <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span>\n                    <span class=\"n\">xycoords</span><span class=\"o\">=</span><span class=\"s1\">&#39;data&#39;</span><span class=\"p\">,</span> <span class=\"n\">xytext</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">30</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">),</span>\n                    <span class=\"n\">textcoords</span><span class=\"o\">=</span><span class=\"s1\">&#39;offset points&#39;</span><span class=\"p\">,</span>\n                    <span class=\"n\">arrowprops</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">arrowstyle</span><span class=\"o\">=</span><span class=\"s2\">&quot;-&gt;&quot;</span><span class=\"p\">,</span>\n                                    <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">))</span>\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n<span class=\"n\">fig1</span><span class=\"o\">.</span><span class=\"n\">savefig</span><span class=\"p\">(</span><span class=\"s1\">&#39;Gibbs_suppression_structural.png&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_denoise_gibbs_002.png\" srcset=\"../../_images/sphx_glr_denoise_gibbs_002.png\" alt=\"denoise gibbs\" class = \"sphx-glr-single-img\"/><figure class=\"align-center\" id=\"id15\">\n<img alt=\"examples_built/04_preprocessing/Gibbs_suppression_structural.png\" src=\"examples_built/04_preprocessing/Gibbs_suppression_structural.png\" />\n<figcaption>\n<p><span class=\"caption-text\">Uncorrected and corrected structural images are shown in the left\nand middle panels, while the difference between these images is shown\nin the right panel.</span><a class=\"headerlink\" href=\"#id15\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<p>The image artificially corrupted with Gibb\u2019s artefacts is shown in the left\npanel. In this panel, the characteristic ringing profile of Gibbs artefacts\ncan be visually appreciated (see intensity oscillations pointed by the red\narrows). The corrected image is shown in the middle panel. One can appreciate\nthat artefactual oscillations are visually suppressed without compromising\nthe contrast between white and grey matter (e.g. details pointed by the green\narrow). The difference between uncorrected and corrected data is plotted in\nthe right panel which highlights the suppressed Gibbs ringing profile.</p>\n<p>Now let\u2019s show how to use the Gibbs suppression algorithm in diffusion-weighted\nimages. We fetch the multi-shell diffusion-weighted dataset which was kindly\nsupplied by Romain Valabr\u00e8gue, CENIR, ICM, Paris <a class=\"footnote-reference brackets\" href=\"#id13\" id=\"id8\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>5<span class=\"fn-bracket\">]</span></a>.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">dipy.data</span> <span class=\"kn\">import</span> <span class=\"n\">read_cenir_multib</span>\n\n<span class=\"n\">bvals</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"mi\">200</span><span class=\"p\">,</span> <span class=\"mi\">400</span><span class=\"p\">,</span> <span class=\"mi\">1000</span><span class=\"p\">,</span> <span class=\"mi\">2000</span><span class=\"p\">]</span>\n\n<span class=\"n\">img</span><span class=\"p\">,</span> <span class=\"n\">gtab</span> <span class=\"o\">=</span> <span class=\"n\">read_cenir_multib</span><span class=\"p\">(</span><span class=\"n\">bvals</span><span class=\"p\">)</span>\n\n<span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">asarray</span><span class=\"p\">(</span><span class=\"n\">img</span><span class=\"o\">.</span><span class=\"n\">dataobj</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>For illustration purposes, we select two slices of this dataset</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">data_slices</span> <span class=\"o\">=</span> <span class=\"n\">data</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"mi\">40</span><span class=\"p\">:</span><span class=\"mi\">42</span><span class=\"p\">,</span> <span class=\"p\">:]</span>\n</pre></div>\n</div>\n<p>Gibbs oscillation suppression of all multi-shell data and all slices\ncan be performed in the following way:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">data_corrected</span> <span class=\"o\">=</span> <span class=\"n\">gibbs_removal</span><span class=\"p\">(</span><span class=\"n\">data_slices</span><span class=\"p\">,</span> <span class=\"n\">slice_axis</span><span class=\"o\">=</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">num_processes</span><span class=\"o\">=-</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Due to the high dimensionality of diffusion-weighted data, we recommend\nthat you specify which is the axis of data matrix that corresponds to different\nslices in the above step. This is done by using the optional parameter\n\u2018slice_axis\u2019.</p>\n<p>Below we plot the results for an image acquired with b-value=0:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">fig2</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">),</span>\n                        <span class=\"n\">subplot_kw</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">&#39;xticks&#39;</span><span class=\"p\">:</span> <span class=\"p\">[],</span> <span class=\"s1\">&#39;yticks&#39;</span><span class=\"p\">:</span> <span class=\"p\">[]})</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">data_slices</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">,</span>\n                  <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mi\">10000</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Uncorrected b0&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">data_corrected</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span>\n                  <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mi\">10000</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Corrected b0&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">data_corrected</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span> <span class=\"o\">-</span> <span class=\"n\">data_slices</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span>\n                  <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=-</span><span class=\"mi\">500</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mi\">500</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;Gibbs residuals&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n<span class=\"n\">fig2</span><span class=\"o\">.</span><span class=\"n\">savefig</span><span class=\"p\">(</span><span class=\"s1\">&#39;Gibbs_suppression_b0.png&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_denoise_gibbs_003.png\" srcset=\"../../_images/sphx_glr_denoise_gibbs_003.png\" alt=\"denoise gibbs\" class = \"sphx-glr-single-img\"/><figure class=\"align-center\" id=\"id16\">\n<img alt=\"examples_built/04_preprocessing/Gibbs_suppression_b0.png\" src=\"examples_built/04_preprocessing/Gibbs_suppression_b0.png\" />\n<figcaption>\n<p><span class=\"caption-text\">Uncorrected (left panel) and corrected (middle panel) b-value=0 images. For\nreference, the difference between uncorrected and corrected images is shown\nin the right panel.</span><a class=\"headerlink\" href=\"#id16\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<p>The above figure shows that the benefits of suppressing Gibbs artefacts is hard\nto observe on b-value=0 data. Therefore, diffusion derived metrics for both\nuncorrected and corrected data are computed using the mean signal diffusion\nkurtosis image technique (<span class=\"xref std std-ref\">example_reconst_msdki</span>).</p>\n<p>To avoid unnecessary calculations on the background of the image, we also\ncompute a brain mask.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># Create a brain mask</span>\n<span class=\"kn\">from</span> <span class=\"nn\">dipy.segment.mask</span> <span class=\"kn\">import</span> <span class=\"n\">median_otsu</span>\n\n<span class=\"n\">maskdata</span><span class=\"p\">,</span> <span class=\"n\">mask</span> <span class=\"o\">=</span> <span class=\"n\">median_otsu</span><span class=\"p\">(</span><span class=\"n\">data_slices</span><span class=\"p\">,</span> <span class=\"n\">vol_idx</span><span class=\"o\">=</span><span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">50</span><span class=\"p\">),</span>\n                             <span class=\"n\">median_radius</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">numpass</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">autocrop</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span>\n                             <span class=\"n\">dilate</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Define mean signal diffusion kurtosis model</span>\n<span class=\"kn\">import</span> <span class=\"nn\">dipy.reconst.msdki</span> <span class=\"k\">as</span> <span class=\"nn\">msdki</span>\n\n<span class=\"n\">dki_model</span> <span class=\"o\">=</span> <span class=\"n\">msdki</span><span class=\"o\">.</span><span class=\"n\">MeanDiffusionKurtosisModel</span><span class=\"p\">(</span><span class=\"n\">gtab</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># Fit the uncorrected data</span>\n<span class=\"n\">dki_fit</span> <span class=\"o\">=</span> <span class=\"n\">dki_model</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">data_slices</span><span class=\"p\">,</span> <span class=\"n\">mask</span><span class=\"o\">=</span><span class=\"n\">mask</span><span class=\"p\">)</span>\n<span class=\"n\">MSKini</span> <span class=\"o\">=</span> <span class=\"n\">dki_fit</span><span class=\"o\">.</span><span class=\"n\">msk</span>\n\n<span class=\"c1\"># Fit the corrected data</span>\n<span class=\"n\">dki_fit</span> <span class=\"o\">=</span> <span class=\"n\">dki_model</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">data_corrected</span><span class=\"p\">,</span> <span class=\"n\">mask</span><span class=\"o\">=</span><span class=\"n\">mask</span><span class=\"p\">)</span>\n<span class=\"n\">MSKgib</span> <span class=\"o\">=</span> <span class=\"n\">dki_fit</span><span class=\"o\">.</span><span class=\"n\">msk</span>\n</pre></div>\n</div>\n<p>Let\u2019s plot the results</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">fig3</span><span class=\"p\">,</span> <span class=\"n\">ax</span> <span class=\"o\">=</span> <span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">subplots</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"mi\">12</span><span class=\"p\">),</span>\n                        <span class=\"n\">subplot_kw</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">&#39;xticks&#39;</span><span class=\"p\">:</span> <span class=\"p\">[],</span> <span class=\"s1\">&#39;yticks&#39;</span><span class=\"p\">:</span> <span class=\"p\">[]})</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">MSKini</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">,</span>\n                  <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mf\">1.5</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;MSK (uncorrected)&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">annotate</span><span class=\"p\">(</span><span class=\"s1\">&#39;Rings&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"n\">xy</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">59</span><span class=\"p\">,</span> <span class=\"mi\">63</span><span class=\"p\">),</span>\n                    <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span>\n                    <span class=\"n\">xycoords</span><span class=\"o\">=</span><span class=\"s1\">&#39;data&#39;</span><span class=\"p\">,</span> <span class=\"n\">xytext</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">45</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">),</span>\n                    <span class=\"n\">textcoords</span><span class=\"o\">=</span><span class=\"s1\">&#39;offset points&#39;</span><span class=\"p\">,</span>\n                    <span class=\"n\">arrowprops</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">arrowstyle</span><span class=\"o\">=</span><span class=\"s2\">&quot;-&gt;&quot;</span><span class=\"p\">,</span>\n                                    <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">))</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">MSKgib</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span> <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">,</span>\n                  <span class=\"n\">vmin</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mf\">1.5</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;MSK (corrected)&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">MSKgib</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span> <span class=\"o\">-</span> <span class=\"n\">MSKini</span><span class=\"p\">[:,</span> <span class=\"p\">:,</span> <span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"s1\">&#39;gray&#39;</span><span class=\"p\">,</span>\n                  <span class=\"n\">origin</span><span class=\"o\">=</span><span class=\"s1\">&#39;lower&#39;</span><span class=\"p\">,</span> <span class=\"n\">vmin</span><span class=\"o\">=-</span><span class=\"mf\">0.2</span><span class=\"p\">,</span> <span class=\"n\">vmax</span><span class=\"o\">=</span><span class=\"mf\">0.2</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">set_title</span><span class=\"p\">(</span><span class=\"s1\">&#39;MSK (uncorrected - corrected&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">ax</span><span class=\"o\">.</span><span class=\"n\">flat</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">annotate</span><span class=\"p\">(</span><span class=\"s1\">&#39;Rings&#39;</span><span class=\"p\">,</span> <span class=\"n\">fontsize</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"n\">xy</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">59</span><span class=\"p\">,</span> <span class=\"mi\">63</span><span class=\"p\">),</span>\n                    <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">,</span>\n                    <span class=\"n\">xycoords</span><span class=\"o\">=</span><span class=\"s1\">&#39;data&#39;</span><span class=\"p\">,</span> <span class=\"n\">xytext</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mi\">45</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">),</span>\n                    <span class=\"n\">textcoords</span><span class=\"o\">=</span><span class=\"s1\">&#39;offset points&#39;</span><span class=\"p\">,</span>\n                    <span class=\"n\">arrowprops</span><span class=\"o\">=</span><span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">arrowstyle</span><span class=\"o\">=</span><span class=\"s2\">&quot;-&gt;&quot;</span><span class=\"p\">,</span>\n                                    <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"s1\">&#39;red&#39;</span><span class=\"p\">))</span>\n\n<span class=\"n\">plt</span><span class=\"o\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n<span class=\"n\">fig3</span><span class=\"o\">.</span><span class=\"n\">savefig</span><span class=\"p\">(</span><span class=\"s1\">&#39;Gibbs_suppression_msdki.png&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<img src=\"../../_images/sphx_glr_denoise_gibbs_004.png\" srcset=\"../../_images/sphx_glr_denoise_gibbs_004.png\" alt=\"denoise gibbs\" class = \"sphx-glr-single-img\"/><figure class=\"align-center\" id=\"id17\">\n<img alt=\"examples_built/04_preprocessing/Gibbs_suppression_msdki.png\" src=\"examples_built/04_preprocessing/Gibbs_suppression_msdki.png\" />\n<figcaption>\n<p><span class=\"caption-text\">Uncorrected and corrected mean signal kurtosis images are shown in the left\nand middle panels. The difference between uncorrected and corrected images\nare show in the right panel.</span><a class=\"headerlink\" href=\"#id17\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<p>In the left panel of the figure above, Gibbs artefacts can be appreciated by\nthe negative values of mean signal kurtosis (black voxels) adjacent to the\nbrain ventricle (red arrows). These negative values seem to be suppressed\nafter the <cite>gibbs_removal</cite> function is applied. For a better visualization of\nGibbs oscillations, the difference between corrected and uncorrected images are\nshown in the right panel.</p>\n<section id=\"references\">\n<h2>References<a class=\"headerlink\" href=\"#references\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<aside class=\"footnote-list brackets\">\n<aside class=\"footnote brackets\" id=\"id9\" role=\"note\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span>1<span class=\"fn-bracket\">]</span></span>\n<span class=\"backrefs\">(<a role=\"doc-backlink\" href=\"#id1\">1</a>,<a role=\"doc-backlink\" href=\"#id2\">2</a>)</span>\n<p>Veraart, J., Fieremans, E., Jelescu, I.O., Knoll, F., Novikov, D.S.,\n2015. Gibbs Ringing in Diffusion MRI. Magn Reson Med 76(1): 301-314.\n<a class=\"reference external\" href=\"https://doi.org/10.1002/mrm.25866\">https://doi.org/10.1002/mrm.25866</a></p>\n</aside>\n<aside class=\"footnote brackets\" id=\"id10\" role=\"note\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id3\">2</a><span class=\"fn-bracket\">]</span></span>\n<p>Perrone, D., Aelterman, J., Piz\u030curica, A., Jeurissen, B., Philips, W.,\nLeemans A., 2015. The effect of Gibbs ringing artifacts on measures\nderived from diffusion MRI. Neuroimage 120, 441-455.\n<a class=\"reference external\" href=\"https://doi.org/10.1016/j.neuroimage.2015.06.068\">https://doi.org/10.1016/j.neuroimage.2015.06.068</a>.</p>\n</aside>\n<aside class=\"footnote brackets\" id=\"id11\" role=\"note\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span>3<span class=\"fn-bracket\">]</span></span>\n<span class=\"backrefs\">(<a role=\"doc-backlink\" href=\"#id4\">1</a>,<a role=\"doc-backlink\" href=\"#id6\">2</a>)</span>\n<p>Kellner, E., Dhital, B., Kiselev, V.G, Reisert, M., 2016. Gibbs\u2010ringing\nartifact removal based on local subvoxel\u2010shifts. Magn Reson Med\n76:1574\u20131581.\n<a class=\"reference external\" href=\"https://doi.org/10.1002/mrm.26054\">https://doi.org/10.1002/mrm.26054</a>.</p>\n</aside>\n<aside class=\"footnote brackets\" id=\"id12\" role=\"note\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span>4<span class=\"fn-bracket\">]</span></span>\n<span class=\"backrefs\">(<a role=\"doc-backlink\" href=\"#id5\">1</a>,<a role=\"doc-backlink\" href=\"#id7\">2</a>)</span>\n<p>Neto Henriques, R., 2018. Advanced Methods for Diffusion MRI Data\nAnalysis and their Application to the Healthy Ageing Brain\n(Doctoral thesis). <a class=\"reference external\" href=\"https://doi.org/10.17863/CAM.29356\">https://doi.org/10.17863/CAM.29356</a></p>\n</aside>\n<aside class=\"footnote brackets\" id=\"id13\" role=\"note\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id8\">5</a><span class=\"fn-bracket\">]</span></span>\n<p>Valabr\u00e8gue, R. (2015). Diffusion MRI measured at multiple b-values.\nRetrieved from:\n<a class=\"reference external\" href=\"https://digital.lib.washington.edu/researchworks/handle/1773/33311\">https://digital.lib.washington.edu/researchworks/handle/1773/33311</a></p>\n</aside>\n</aside>\n<p class=\"sphx-glr-timing\"><strong>Total running time of the script:</strong> ( 0 minutes  22.172 seconds)</p>\n<div class=\"sphx-glr-footer sphx-glr-footer-example docutils container\" id=\"sphx-glr-download-examples-built-04-preprocessing-denoise-gibbs-py\">\n<div class=\"sphx-glr-download sphx-glr-download-python docutils container\">\n<p><a class=\"reference download internal\" download=\"\" href=\"../../../_downloads/5512c5ce07997e91d23132aebd0fe221/denoise_gibbs.py\"><code class=\"xref download docutils literal notranslate\"><span class=\"pre\">Download</span> <span class=\"pre\">Python</span> <span class=\"pre\">source</span> <span class=\"pre\">code:</span> <span class=\"pre\">denoise_gibbs.py</span></code></a></p>\n</div>\n<div class=\"sphx-glr-download sphx-glr-download-jupyter docutils container\">\n<p><a class=\"reference download internal\" download=\"\" href=\"../../../_downloads/ca37e22c5bbae688a8fed1ed5107db70/denoise_gibbs.ipynb\"><code class=\"xref download docutils literal notranslate\"><span class=\"pre\">Download</span> <span class=\"pre\">Jupyter</span> <span class=\"pre\">notebook:</span> <span class=\"pre\">denoise_gibbs.ipynb</span></code></a></p>\n</div>\n</div>\n<p class=\"sphx-glr-signature\"><a class=\"reference external\" href=\"https://sphinx-gallery.github.io\">Gallery generated by Sphinx-Gallery</a></p>\n</section>\n</section>\n", "metatags": "<meta name=\"generator\" content=\"Docutils 0.19: https://docutils.sourceforge.io/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["examples_built/07_reconstruction/index", "Reconstruction", "N", "next"], ["examples_built/04_preprocessing/denoise_mppca", "Denoise images using the Marcenko-Pastur PCA algorithm", "P", "previous"]], "sourcename": "examples_built/04_preprocessing/denoise_gibbs.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Suppress Gibbs oscillations</a><ul>\n<li><a class=\"reference internal\" href=\"#references\">References</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "examples_built/04_preprocessing/denoise_gibbs", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}
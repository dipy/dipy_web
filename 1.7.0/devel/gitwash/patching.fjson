{"parents": [{"link": "../../../documentation/", "title": "Documentation"}, {"link": "../../", "title": "DIPY development"}, {"link": "../", "title": "Working with DIPY source code"}], "prev": {"link": "../following_latest/", "title": "Following the latest source"}, "next": {"link": "../git_development/", "title": "Git for development"}, "title": "Making a patch", "meta": {}, "body": "<section id=\"making-a-patch\">\n<h1>Making a patch<a class=\"headerlink\" href=\"#making-a-patch\" title=\"Permalink to this heading\">\u00b6</a></h1>\n<p>You\u2019ve discovered a bug or something else you want to change\nin <a class=\"reference external\" href=\"https://dipy.org\">DIPY</a> \u2014 excellent!</p>\n<p>You\u2019ve worked out a way to fix it \u2014 even better!</p>\n<p>You want to tell us about it \u2014 best of all!</p>\n<p>The easiest way is to make a <em>patch</em> or set of patches.  Here\nwe explain how.  Making a patch is the simplest and quickest,\nbut if you\u2019re going to be doing anything more than simple\nquick things, please consider following the\n<a class=\"reference internal\" href=\"../git_development/#git-development\"><span class=\"std std-ref\">Git for development</span></a> model instead.</p>\n<section id=\"making-patches\">\n<span id=\"id1\"></span><h2>Making patches<a class=\"headerlink\" href=\"#making-patches\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<section id=\"overview\">\n<h3>Overview<a class=\"headerlink\" href=\"#overview\" title=\"Permalink to this heading\">\u00b6</a></h3>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># tell git who you are</span>\n<span class=\"n\">git</span> <span class=\"n\">config</span> <span class=\"o\">--</span><span class=\"k\">global</span> <span class=\"n\">user</span><span class=\"o\">.</span><span class=\"n\">email</span> <span class=\"n\">you</span><span class=\"nd\">@yourdomain</span><span class=\"o\">.</span><span class=\"n\">example</span><span class=\"o\">.</span><span class=\"n\">com</span>\n<span class=\"n\">git</span> <span class=\"n\">config</span> <span class=\"o\">--</span><span class=\"k\">global</span> <span class=\"n\">user</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"s2\">&quot;Your Name Comes Here&quot;</span>\n<span class=\"c1\"># get the repository if you don&#39;t have it</span>\n<span class=\"n\">git</span> <span class=\"n\">clone</span> <span class=\"n\">git</span><span class=\"p\">:</span><span class=\"o\">//</span><span class=\"n\">github</span><span class=\"o\">.</span><span class=\"n\">com</span><span class=\"o\">/</span><span class=\"n\">dipy</span><span class=\"o\">/</span><span class=\"n\">dipy</span><span class=\"o\">.</span><span class=\"n\">git</span>\n<span class=\"c1\"># make a branch for your patching</span>\n<span class=\"n\">cd</span> <span class=\"n\">dipy</span>\n<span class=\"n\">git</span> <span class=\"n\">branch</span> <span class=\"n\">the</span><span class=\"o\">-</span><span class=\"n\">fix</span><span class=\"o\">-</span><span class=\"n\">im</span><span class=\"o\">-</span><span class=\"n\">thinking</span><span class=\"o\">-</span><span class=\"n\">of</span>\n<span class=\"n\">git</span> <span class=\"n\">checkout</span> <span class=\"n\">the</span><span class=\"o\">-</span><span class=\"n\">fix</span><span class=\"o\">-</span><span class=\"n\">im</span><span class=\"o\">-</span><span class=\"n\">thinking</span><span class=\"o\">-</span><span class=\"n\">of</span>\n<span class=\"c1\"># hack, hack, hack</span>\n<span class=\"c1\"># Tell git about any new files you&#39;ve made</span>\n<span class=\"n\">git</span> <span class=\"n\">add</span> <span class=\"n\">somewhere</span><span class=\"o\">/</span><span class=\"n\">tests</span><span class=\"o\">/</span><span class=\"n\">test_my_bug</span><span class=\"o\">.</span><span class=\"n\">py</span>\n<span class=\"c1\"># commit work in progress as you go</span>\n<span class=\"n\">git</span> <span class=\"n\">commit</span> <span class=\"o\">-</span><span class=\"n\">am</span> <span class=\"s1\">&#39;BF - added tests for Funny bug&#39;</span>\n<span class=\"c1\"># hack hack, hack</span>\n<span class=\"n\">git</span> <span class=\"n\">commit</span> <span class=\"o\">-</span><span class=\"n\">am</span> <span class=\"s1\">&#39;BF - added fix for Funny bug&#39;</span>\n<span class=\"c1\"># make the patch files</span>\n<span class=\"n\">git</span> <span class=\"nb\">format</span><span class=\"o\">-</span><span class=\"n\">patch</span> <span class=\"o\">-</span><span class=\"n\">M</span> <span class=\"o\">-</span><span class=\"n\">C</span> <span class=\"n\">master</span>\n</pre></div>\n</div>\n<p>Then, send the generated patch files to the <a class=\"reference external\" href=\"https://mail.python.org/mailman/listinfo/neuroimaging\">DIPY\nmailing list</a> \u2014 where we will thank you warmly.</p>\n</section>\n<section id=\"in-detail\">\n<h3>In detail<a class=\"headerlink\" href=\"#in-detail\" title=\"Permalink to this heading\">\u00b6</a></h3>\n<ol class=\"arabic\">\n<li><p>Tell git who you are so it can label the commits you\u2019ve\nmade:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">git</span> <span class=\"n\">config</span> <span class=\"o\">--</span><span class=\"k\">global</span> <span class=\"n\">user</span><span class=\"o\">.</span><span class=\"n\">email</span> <span class=\"n\">you</span><span class=\"nd\">@yourdomain</span><span class=\"o\">.</span><span class=\"n\">example</span><span class=\"o\">.</span><span class=\"n\">com</span>\n<span class=\"n\">git</span> <span class=\"n\">config</span> <span class=\"o\">--</span><span class=\"k\">global</span> <span class=\"n\">user</span><span class=\"o\">.</span><span class=\"n\">name</span> <span class=\"s2\">&quot;Your Name Comes Here&quot;</span>\n</pre></div>\n</div>\n</li>\n<li><p>If you don\u2019t already have one, clone a copy of the\n<a class=\"reference external\" href=\"https://dipy.org\">dipy</a> repository:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">git</span> <span class=\"n\">clone</span> <span class=\"n\">git</span><span class=\"p\">:</span><span class=\"o\">//</span><span class=\"n\">github</span><span class=\"o\">.</span><span class=\"n\">com</span><span class=\"o\">/</span><span class=\"n\">dipy</span><span class=\"o\">/</span><span class=\"n\">dipy</span><span class=\"o\">.</span><span class=\"n\">git</span>\n<span class=\"n\">cd</span> <span class=\"n\">dipy</span>\n</pre></div>\n</div>\n</li>\n<li><p>Make a \u2018feature branch\u2019.  This will be where you work on\nyour bug fix.  It\u2019s nice and safe and leaves you with\naccess to an unmodified copy of the code in the main\nbranch:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">git</span> <span class=\"n\">branch</span> <span class=\"n\">the</span><span class=\"o\">-</span><span class=\"n\">fix</span><span class=\"o\">-</span><span class=\"n\">im</span><span class=\"o\">-</span><span class=\"n\">thinking</span><span class=\"o\">-</span><span class=\"n\">of</span>\n<span class=\"n\">git</span> <span class=\"n\">checkout</span> <span class=\"n\">the</span><span class=\"o\">-</span><span class=\"n\">fix</span><span class=\"o\">-</span><span class=\"n\">im</span><span class=\"o\">-</span><span class=\"n\">thinking</span><span class=\"o\">-</span><span class=\"n\">of</span>\n</pre></div>\n</div>\n</li>\n<li><p>Do some edits, and commit them as you go:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># hack, hack, hack</span>\n<span class=\"c1\"># Tell git about any new files you&#39;ve made</span>\n<span class=\"n\">git</span> <span class=\"n\">add</span> <span class=\"n\">somewhere</span><span class=\"o\">/</span><span class=\"n\">tests</span><span class=\"o\">/</span><span class=\"n\">test_my_bug</span><span class=\"o\">.</span><span class=\"n\">py</span>\n<span class=\"c1\"># commit work in progress as you go</span>\n<span class=\"n\">git</span> <span class=\"n\">commit</span> <span class=\"o\">-</span><span class=\"n\">am</span> <span class=\"s1\">&#39;BF - added tests for Funny bug&#39;</span>\n<span class=\"c1\"># hack hack, hack</span>\n<span class=\"n\">git</span> <span class=\"n\">commit</span> <span class=\"o\">-</span><span class=\"n\">am</span> <span class=\"s1\">&#39;BF - added fix for Funny bug&#39;</span>\n</pre></div>\n</div>\n<p>Note the <code class=\"docutils literal notranslate\"><span class=\"pre\">-am</span></code> options to <code class=\"docutils literal notranslate\"><span class=\"pre\">commit</span></code>. The <code class=\"docutils literal notranslate\"><span class=\"pre\">m</span></code> flag just\nsignals that you\u2019re going to type a message on the command\nline.  The <code class=\"docutils literal notranslate\"><span class=\"pre\">a</span></code> flag \u2014 you can just take on faith \u2014\nor see <a class=\"reference external\" href=\"http://www.gitready.com/beginner/2009/01/18/the-staging-area.html\">why the -a flag?</a>.</p>\n</li>\n<li><p>When you have finished, check you have committed all your\nchanges:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">git</span> <span class=\"n\">status</span>\n</pre></div>\n</div>\n</li>\n<li><p>Finally, make your commits into patches.  You want all the\ncommits since you branched from the <code class=\"docutils literal notranslate\"><span class=\"pre\">master</span></code> branch:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">git</span> <span class=\"nb\">format</span><span class=\"o\">-</span><span class=\"n\">patch</span> <span class=\"o\">-</span><span class=\"n\">M</span> <span class=\"o\">-</span><span class=\"n\">C</span> <span class=\"n\">master</span>\n</pre></div>\n</div>\n<p>You will now have several files named for the commits:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"mi\">0001</span><span class=\"o\">-</span><span class=\"n\">BF</span><span class=\"o\">-</span><span class=\"n\">added</span><span class=\"o\">-</span><span class=\"n\">tests</span><span class=\"o\">-</span><span class=\"k\">for</span><span class=\"o\">-</span><span class=\"n\">Funny</span><span class=\"o\">-</span><span class=\"n\">bug</span><span class=\"o\">.</span><span class=\"n\">patch</span>\n<span class=\"mi\">0002</span><span class=\"o\">-</span><span class=\"n\">BF</span><span class=\"o\">-</span><span class=\"n\">added</span><span class=\"o\">-</span><span class=\"n\">fix</span><span class=\"o\">-</span><span class=\"k\">for</span><span class=\"o\">-</span><span class=\"n\">Funny</span><span class=\"o\">-</span><span class=\"n\">bug</span><span class=\"o\">.</span><span class=\"n\">patch</span>\n</pre></div>\n</div>\n<p>Send these files to the <a class=\"reference external\" href=\"https://mail.python.org/mailman/listinfo/neuroimaging\">DIPY mailing list</a>.</p>\n</li>\n</ol>\n<p>When you are done, to switch back to the main copy of the\ncode, just return to the <code class=\"docutils literal notranslate\"><span class=\"pre\">master</span></code> branch:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">git</span> <span class=\"n\">checkout</span> <span class=\"n\">master</span>\n</pre></div>\n</div>\n</section>\n</section>\n<section id=\"moving-from-patching-to-development\">\n<h2>Moving from patching to development<a class=\"headerlink\" href=\"#moving-from-patching-to-development\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>If you find you have done some patches, and you have one or\nmore feature branches, you will probably want to switch to\ndevelopment mode.  You can do this with the repository you\nhave.</p>\n<p>Fork the <a class=\"reference external\" href=\"https://dipy.org\">dipy</a> repository on github \u2014 <a class=\"reference internal\" href=\"../forking_hell/#forking\"><span class=\"std std-ref\">Making your own copy (fork) of DIPY</span></a>.\nThen:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># checkout and refresh master branch from main repo</span>\n<span class=\"n\">git</span> <span class=\"n\">checkout</span> <span class=\"n\">master</span>\n<span class=\"n\">git</span> <span class=\"n\">pull</span> <span class=\"n\">origin</span> <span class=\"n\">master</span>\n<span class=\"c1\"># rename pointer to main repository to &#39;upstream&#39;</span>\n<span class=\"n\">git</span> <span class=\"n\">remote</span> <span class=\"n\">rename</span> <span class=\"n\">origin</span> <span class=\"n\">upstream</span>\n<span class=\"c1\"># point your repo to default read / write to your fork on github</span>\n<span class=\"n\">git</span> <span class=\"n\">remote</span> <span class=\"n\">add</span> <span class=\"n\">origin</span> <span class=\"n\">git</span><span class=\"nd\">@github</span><span class=\"o\">.</span><span class=\"n\">com</span><span class=\"p\">:</span><span class=\"n\">your</span><span class=\"o\">-</span><span class=\"n\">user</span><span class=\"o\">-</span><span class=\"n\">name</span><span class=\"o\">/</span><span class=\"n\">dipy</span><span class=\"o\">.</span><span class=\"n\">git</span>\n<span class=\"c1\"># push up any branches you&#39;ve made and want to keep</span>\n<span class=\"n\">git</span> <span class=\"n\">push</span> <span class=\"n\">origin</span> <span class=\"n\">the</span><span class=\"o\">-</span><span class=\"n\">fix</span><span class=\"o\">-</span><span class=\"n\">im</span><span class=\"o\">-</span><span class=\"n\">thinking</span><span class=\"o\">-</span><span class=\"n\">of</span>\n</pre></div>\n</div>\n<p>Then you can, if you want, follow the\n<a class=\"reference internal\" href=\"../development_workflow/#development-workflow\"><span class=\"std std-ref\">Development workflow</span></a>.</p>\n</section>\n</section>\n", "metatags": "<meta name=\"generator\" content=\"Docutils 0.19: https://docutils.sourceforge.io/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["devel/gitwash/git_development", "Git for development", "N", "next"], ["devel/gitwash/following_latest", "Following the latest source", "P", "previous"]], "sourcename": "devel/gitwash/patching.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Making a patch</a><ul>\n<li><a class=\"reference internal\" href=\"#making-patches\">Making patches</a><ul>\n<li><a class=\"reference internal\" href=\"#overview\">Overview</a></li>\n<li><a class=\"reference internal\" href=\"#in-detail\">In detail</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#moving-from-patching-to-development\">Moving from patching to development</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "devel/gitwash/patching", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}
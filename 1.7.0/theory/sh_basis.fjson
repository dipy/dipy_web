{"parents": [{"link": "../../documentation/", "title": "Documentation"}, {"link": "../", "title": "Theory and concepts"}], "prev": {"link": "../spherical/", "title": "Spherical coordinates"}, "next": {"link": "../../reference/", "title": "API Reference"}, "title": "Spherical Harmonic bases", "meta": {}, "body": "<section id=\"spherical-harmonic-bases\">\n<span id=\"sh-basis\"></span><h1>Spherical Harmonic bases<a class=\"headerlink\" href=\"#spherical-harmonic-bases\" title=\"Permalink to this heading\">\u00b6</a></h1>\n<p>Spherical Harmonics (SH) are functions defined on the sphere. A collection of\nSH can be used as a basis function to represent and reconstruct any function on\nthe surface of a unit sphere.</p>\n<p>Spherical harmonics are orthonormal functions defined by:</p>\n<div class=\"math notranslate nohighlight\">\n\\[Y_l^m(\\theta, \\phi) = \\sqrt{\\frac{2l + 1}{4 \\pi} \\frac{(l - m)!}{(l + m)!}} P_l^m( cos \\theta) e^{i m \\phi}\\]</div>\n<p>where <span class=\"math notranslate nohighlight\">\\(l\\)</span> is the order, <span class=\"math notranslate nohighlight\">\\(m\\)</span> is the degree, <span class=\"math notranslate nohighlight\">\\(P_l^m\\)</span> is an associated\n<span class=\"math notranslate nohighlight\">\\(l\\)</span>-th order, <span class=\"math notranslate nohighlight\">\\(m\\)</span>-th degree Legendre polynomial, and <span class=\"math notranslate nohighlight\">\\((\\theta, \\phi)\\)</span> is the\nrepresentation of the direction vector in spherical coordinates. The relation\nbetween <span class=\"math notranslate nohighlight\">\\(Y_l^{m}\\)</span> and <span class=\"math notranslate nohighlight\">\\(Y_l^{-m}\\)</span> is given by:</p>\n<div class=\"math notranslate nohighlight\">\n\\[Y_l^{-m}(\\theta, \\phi) = (-1)^m \\overline{Y_l^m}\\]</div>\n<p>where <span class=\"math notranslate nohighlight\">\\(\\overline{Y_l^m}\\)</span> is the complex conjugate of <span class=\"math notranslate nohighlight\">\\(Y_l^m\\)</span> defined as\n<span class=\"math notranslate nohighlight\">\\(\\overline{Y_l^m} = \\Re(Y_l^m) - \\Im(Y_l^m)\\)</span>.</p>\n<p>A function <span class=\"math notranslate nohighlight\">\\(f(\\theta, \\phi)\\)</span> can be represented using a spherical harmonics\nbasis using the spherical harmonics coefficients <span class=\"math notranslate nohighlight\">\\(a_l^m\\)</span>, which can be\ncomputed using the expression:</p>\n<div class=\"math notranslate nohighlight\">\n\\[a_l^m = \\int_S f(\\theta, \\phi) Y_l^m(\\theta, \\phi) ds\\]</div>\n<p>Once the coefficients are computed, the function <span class=\"math notranslate nohighlight\">\\(f(\\theta, \\phi)\\)</span> can be\ncomputed as:</p>\n<div class=\"math notranslate nohighlight\">\n\\[f(\\theta, \\phi) = \\sum_{l = 0}^{\\infty} \\sum_{m = -l}^{l} a^m_l Y_l^m(\\theta, \\phi)\\]</div>\n<p>In HARDI, the Orientation Distribution Function (ODF) is a function on the\nsphere. Therefore, SH functions offer the ideal framework for reconstructing\nthe ODF. Descoteaux <em>et al.</em> <a class=\"footnote-reference brackets\" href=\"#id10\" id=\"id1\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>1<span class=\"fn-bracket\">]</span></a> use the Q-Ball Imaging (QBI) formalization\nto recover the ODF, while Tournier <em>et al.</em> <a class=\"footnote-reference brackets\" href=\"#id11\" id=\"id2\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>2<span class=\"fn-bracket\">]</span></a> use the Spherical Deconvolution\n(SD) framework.</p>\n<p>Several modified SH bases have been proposed in the diffusion imaging literature\nfor the computation of the ODF. DIPY implements two of these in the\n<a class=\"reference internal\" href=\"../../reference/dipy.reconst/#module-dipy.reconst.shm\" title=\"dipy.reconst.shm\"><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">shm</span></code></a> module. Below are the formal definitions taken\ndirectly from the literature.</p>\n<ul class=\"simple\">\n<li><p>The basis proposed by Descoteaux <em>et al.</em> <a class=\"footnote-reference brackets\" href=\"#id10\" id=\"id3\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>1<span class=\"fn-bracket\">]</span></a>:</p></li>\n</ul>\n<div class=\"math notranslate nohighlight\">\n\\[\\begin{split}Y_i(\\theta, \\phi) =\n \\begin{cases}\n \\sqrt{2} \\Re(Y_l^{m}(\\theta, \\phi)) &amp; -l \\leq m &lt; 0, \\\\\n Y_l^0(\\theta, \\phi) &amp; m = 0, \\\\\n \\sqrt{2} \\Im(Y_l^m(\\theta, \\phi)) &amp; 0 &lt; m \\leq l\n \\end{cases}\\end{split}\\]</div>\n<ul class=\"simple\">\n<li><p>The basis proposed by Tournier <em>et al.</em> <a class=\"footnote-reference brackets\" href=\"#id11\" id=\"id4\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>2<span class=\"fn-bracket\">]</span></a>:</p></li>\n</ul>\n<div class=\"math notranslate nohighlight\">\n\\[\\begin{split}Y_i(\\theta, \\phi) =\n \\begin{cases}\n \\Im(Y_l^{m}(\\theta, \\phi)) &amp; -l \\leq m &lt; 0, \\\\\n Y_l^0(\\theta, \\phi) &amp; m = 0, \\\\\n \\Re(Y_{l}^m(\\theta, \\phi)) &amp; 0 &lt; m \\leq l\n \\end{cases}\\end{split}\\]</div>\n<p>In both cases, <span class=\"math notranslate nohighlight\">\\(\\Re\\)</span> denotes the real part of the spherical harmonic basis, and\n<span class=\"math notranslate nohighlight\">\\(\\Im\\)</span> denotes the imaginary part. The SH bases are both orthogonal and real. Moreover,\nthe <cite>descoteaux07</cite> basis is orthonormal.</p>\n<p>In both cases, <span class=\"math notranslate nohighlight\">\\(\\Re\\)</span> denotes the real part of the SH basis, and <span class=\"math notranslate nohighlight\">\\(\\Im\\)</span> denotes\nthe imaginary part. By alternately selecting the real or imaginary part of the\noriginal SH basis, the modified SH bases have the properties of being both\northogonal and real. Moreover, due to the presence of the <span class=\"math notranslate nohighlight\">\\(\\sqrt{2}\\)</span> factor,\nthe basis proposed by Descoteaux <em>et al.</em> is orthonormal.</p>\n<p>The SH bases implemented in DIPY for versions 1.2 and below differ slightly\nfrom the literature. Their implementation is given below.</p>\n<ul class=\"simple\">\n<li><p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">descoteaux07</span></code> basis is based on the one proposed by Descoteaux <em>et al.</em>\n<a class=\"footnote-reference brackets\" href=\"#id10\" id=\"id5\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>1<span class=\"fn-bracket\">]</span></a> and is given by:</p></li>\n</ul>\n<div class=\"math notranslate nohighlight\">\n\\[\\begin{split}Y_i(\\theta, \\phi) =\n \\begin{cases}\n \\sqrt{2} \\Re(Y_l^{|m|}(\\theta, \\phi)) &amp; -l \\leq m &lt; 0, \\\\\n Y_l^0(\\theta, \\phi) &amp; m = 0, \\\\\n \\sqrt{2} \\Im(Y_l^m(\\theta, \\phi)) &amp; 0 &lt; m \\leq l\n \\end{cases}\\end{split}\\]</div>\n<ul class=\"simple\">\n<li><p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">tournier07</span></code> basis is based on the one proposed by Tournier <em>et al.</em>\n<a class=\"footnote-reference brackets\" href=\"#id11\" id=\"id6\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>2<span class=\"fn-bracket\">]</span></a> and is given by:</p></li>\n</ul>\n<div class=\"math notranslate nohighlight\">\n\\[\\begin{split}Y_i(\\theta, \\phi) =\n \\begin{cases}\n \\Im(Y_l^{|m|}(\\theta, \\phi)) &amp; -l \\leq m &lt; 0, \\\\\n Y_l^0(\\theta, \\phi) &amp; m = 0, \\\\\n \\Re(Y_{l}^m(\\theta, \\phi)) &amp; 0 &lt; m \\leq l\n \\end{cases}\\end{split}\\]</div>\n<p>These bases differ from the literature by the presence of an absolute value around\n<span class=\"math notranslate nohighlight\">\\(m\\)</span> when <span class=\"math notranslate nohighlight\">\\(m &lt; 0\\)</span>. Due to relations <span class=\"math notranslate nohighlight\">\\(-p = |p| ; \\forall p &lt; 0\\)</span> and\n<span class=\"math notranslate nohighlight\">\\(Y_l^{-m}(\\theta, \\phi) = (-1)^m \\overline{Y_l^m}\\)</span>, the effect of this change is a\nsign flip for the SH functions of even degree <span class=\"math notranslate nohighlight\">\\(m &lt; 0\\)</span>. This has no effect on the\nmathematical properties of each basis.</p>\n<p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">tournier07</span></code> SH basis defined above is the basis used in MRtrix 0.2 <a class=\"footnote-reference brackets\" href=\"#id12\" id=\"id7\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>3<span class=\"fn-bracket\">]</span></a>.\nHowever, the omission of the <span class=\"math notranslate nohighlight\">\\(\\sqrt{2}\\)</span> factor seen in the basis from Descoteaux\n<em>et al.</em> <a class=\"footnote-reference brackets\" href=\"#id10\" id=\"id8\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>1<span class=\"fn-bracket\">]</span></a> makes it non-orthonormal. For this reason, the MRtrix3 <a class=\"footnote-reference brackets\" href=\"#id13\" id=\"id9\" role=\"doc-noteref\"><span class=\"fn-bracket\">[</span>4<span class=\"fn-bracket\">]</span></a> SH\nbasis uses a new basis including the normalization factor.</p>\n<p>Since DIPY 1.3, the <code class=\"docutils literal notranslate\"><span class=\"pre\">descoteaux07</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">tournier07</span></code> SH bases have been\nupdated in order to agree with the literature and the latest MRtrix3\nimplementation. While previous bases are still available as <em>legacy</em> bases,\nthe <code class=\"docutils literal notranslate\"><span class=\"pre\">descoteaux07</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">tournier07</span></code> bases now default to:</p>\n<div class=\"math notranslate nohighlight\">\n\\[\\begin{split}Y_i(\\theta, \\phi) =\n \\begin{cases}\n \\sqrt{2} \\Re(Y_l^{m}(\\theta, \\phi)) &amp; -l \\leq m &lt; 0, \\\\\n Y_l^0(\\theta, \\phi) &amp; m = 0, \\\\\n \\sqrt{2} \\Im(Y_l^m(\\theta, \\phi)) &amp; 0 &lt; m \\leq l\n \\end{cases}\\end{split}\\]</div>\n<p>for the <code class=\"docutils literal notranslate\"><span class=\"pre\">descoteaux07</span></code> basis and</p>\n<div class=\"math notranslate nohighlight\">\n\\[\\begin{split}Y_i(\\theta, \\phi) =\n \\begin{cases}\n \\sqrt{2} \\Im(Y_l^{|m|}(\\theta, \\phi)) &amp; -l \\leq m &lt; 0, \\\\\n Y_l^0(\\theta, \\phi) &amp; m = 0, \\\\\n \\sqrt{2} \\Re(Y_{l}^m(\\theta, \\phi)) &amp; 0 &lt; m \\leq l\n \\end{cases}\\end{split}\\]</div>\n<p>for the <code class=\"docutils literal notranslate\"><span class=\"pre\">tournier07</span></code> basis. Both bases are very similar, with their only\ndifference being the sign of <span class=\"math notranslate nohighlight\">\\(m\\)</span> for which the imaginary and real parts of\nthe spherical harmonic <span class=\"math notranslate nohighlight\">\\(Y_{l}^m\\)</span> are used.</p>\n<p>In practice, a maximum order <span class=\"math notranslate nohighlight\">\\(k\\)</span> is used to truncate the SH series. By\nonly taking into account even order SH functions, the above bases can be used\nto reconstruct symmetric spherical functions. The choice of an even order is\nmotivated by the symmetry of the diffusion process around the origin.</p>\n<p>Both bases are also available as full SH bases, where odd order SH functions\nare also taken into account when reconstructing a spherical function. These\nfull bases can successfully reconstruct asymmetric signals as well as\nsymmetric signals.</p>\n<section id=\"references\">\n<h2>References<a class=\"headerlink\" href=\"#references\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<aside class=\"footnote-list brackets\">\n<aside class=\"footnote brackets\" id=\"id10\" role=\"note\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span>1<span class=\"fn-bracket\">]</span></span>\n<span class=\"backrefs\">(<a role=\"doc-backlink\" href=\"#id1\">1</a>,<a role=\"doc-backlink\" href=\"#id3\">2</a>,<a role=\"doc-backlink\" href=\"#id5\">3</a>,<a role=\"doc-backlink\" href=\"#id8\">4</a>)</span>\n<p>Descoteaux, M., Angelino, E., Fitzgibbons, S. and Deriche, R.\nRegularized, Fast, and Robust Analytical Q\u2010ball Imaging.\nMagn. Reson. Med. 2007;58:497-510.</p>\n</aside>\n<aside class=\"footnote brackets\" id=\"id11\" role=\"note\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span>2<span class=\"fn-bracket\">]</span></span>\n<span class=\"backrefs\">(<a role=\"doc-backlink\" href=\"#id2\">1</a>,<a role=\"doc-backlink\" href=\"#id4\">2</a>,<a role=\"doc-backlink\" href=\"#id6\">3</a>)</span>\n<p>Tournier J.D., Calamante F. and Connelly A. Robust determination\nof the fibre orientation distribution in diffusion MRI:\nNon-negativity constrained super-resolved spherical deconvolution.\nNeuroImage. 2007;35(4):1459\u20131472.</p>\n</aside>\n<aside class=\"footnote brackets\" id=\"id12\" role=\"note\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id7\">3</a><span class=\"fn-bracket\">]</span></span>\n<p>Tournier J-D, Smith R, Raffelt D, Tabbara R, Dhollander T,\nPietsch M, et al. MRtrix3: A fast, flexible and open software\nframework for medical image processing and visualisation.\nNeuroImage. 2019 Nov 15;202:116-137.</p>\n</aside>\n<aside class=\"footnote brackets\" id=\"id13\" role=\"note\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id9\">4</a><span class=\"fn-bracket\">]</span></span>\n<p>Tournier J-D, Smith R, Raffelt D, Tabbara R, Dhollander T,\nPietsch M, et al. MRtrix3: A fast, flexible and open software\nframework for medical image processing and visualisation.\nNeuroImage. 2019 Nov 15;202:116-137.</p>\n</aside>\n</aside>\n</section>\n</section>\n", "metatags": "<meta name=\"generator\" content=\"Docutils 0.19: https://docutils.sourceforge.io/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["reference/index", "API Reference", "N", "next"], ["theory/spherical", "Spherical coordinates", "P", "previous"]], "sourcename": "theory/sh_basis.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Spherical Harmonic bases</a><ul>\n<li><a class=\"reference internal\" href=\"#references\">References</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "theory/sh_basis", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}
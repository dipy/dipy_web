{"parents": [], "prev": null, "next": null, "title": "Nonrigid White Matter Bundle Registration with BundleWarp", "meta": {}, "body": "<section id=\"nonrigid-white-matter-bundle-registration-with-bundlewarp\">\n<span id=\"bundlewarp-registration-flow\"></span><h1>Nonrigid White Matter Bundle Registration with BundleWarp<a class=\"headerlink\" href=\"#nonrigid-white-matter-bundle-registration-with-bundlewarp\" title=\"Permalink to this heading\">\u00b6</a></h1>\n<p>This tutorial explains how we can use BundleWarp <a class=\"reference internal\" href=\"../../reference_cmd/dipy_bundlewarp/#chandio2023\" id=\"id1\"><span>[Chandio2023]</span></a> to nonlinearly\nregister two bundles.</p>\n<p>First, we need to download static and moving bundles for this tutorial. Here,\nwe two uncinate fasciculus bundles in the left hemisphere of the brain from:</p>\n<blockquote>\n<div><p><a class=\"reference external\" href=\"hhttps://figshare.com/articles/dataset/Test_Bundles_for_DIPY/22557733\">hhttps://figshare.com/articles/dataset/Test_Bundles_for_DIPY/22557733</a></p>\n</div></blockquote>\n<p>Let\u2019s say we have moving bundle (bundle to be registered) named <code class=\"docutils literal notranslate\"><span class=\"pre\">m_UF_L.trk</span></code>\nand static/fixed bundle named <code class=\"docutils literal notranslate\"><span class=\"pre\">s_UF_L.trk</span></code>.</p>\n<p>Visualizing the moving and static bundles before registration:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">dipy_horizon</span> <span class=\"s2\">&quot;m_UF.trk&quot;</span> <span class=\"s2\">&quot;s_UF_LI.trk&quot;</span> <span class=\"o\">--</span><span class=\"n\">random_color</span>\n</pre></div>\n</div>\n<figure class=\"align-center\" id=\"id4\">\n<a class=\"reference internal image-reference\" href=\"https://github.com/dipy/dipy_data/blob/master/before_bw_registration.png?raw=true\"><img alt=\"alternate text\" src=\"https://github.com/dipy/dipy_data/blob/master/before_bw_registration.png?raw=true\" style=\"width: 70%;\" /></a>\n<figcaption>\n<p><span class=\"caption-text\">Moving bundle in green and static bundle in pink before registration.</span><a class=\"headerlink\" href=\"#id4\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<p>BundleWarp provides the capacity to either partially or fully deform the\nmoving bundle using a single regularization parameter, alpha (represented with\n\u03bb in BundleWarp paper). Where alpha controls the trade-off between regularizing\nthe deformation and having points match very closely. The lower the value of\nalpha, the more closely the bundles would match. Here, we investigate how to\nwarp moving bundle with different levels of deformations using BundleWarp\nregistration method <a class=\"reference internal\" href=\"../../examples_built/20_registration/bundlewarp_registration/#chandio23\" id=\"id2\"><span>[Chandio23]</span></a>.</p>\n<section id=\"partially-deformable-bundlewarp-registration\">\n<h2>Partially Deformable BundleWarp Registration<a class=\"headerlink\" href=\"#partially-deformable-bundlewarp-registration\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>Here, we partially deform/warp moving bundle to align it with static bundle.\npartial deformations improve linear registration while preserving the anatomical\nshape and structures of the moving bundle. Here, we use relatively higher value\nof alpha=0.03. By default, BundleWarp partially deforms the bundle to preserve\nthe key characteristics of the original bundle.</p>\n<dl class=\"simple\">\n<dt>The following BundleWarp workflows requirse two positional input arguments;</dt><dd><p><code class=\"docutils literal notranslate\"><span class=\"pre\">static</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">moving</span></code> .trk files. In our case, the <code class=\"docutils literal notranslate\"><span class=\"pre\">static</span></code> input bundle</p>\n</dd>\n</dl>\n<p>is the <code class=\"docutils literal notranslate\"><span class=\"pre\">s_UF_L.trk</span></code> and the <code class=\"docutils literal notranslate\"><span class=\"pre\">moving</span></code> is <code class=\"docutils literal notranslate\"><span class=\"pre\">m_UF_L.trk</span></code>.</p>\n<p>Run the following workflow:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">dipy_bundlewarp</span> <span class=\"s2\">&quot;s_UF_L.trk&quot;</span> <span class=\"s2\">&quot;m_UF_L.trk&quot;</span> <span class=\"o\">--</span><span class=\"n\">alpha</span> <span class=\"mf\">0.01</span> <span class=\"o\">--</span><span class=\"n\">force</span>\n</pre></div>\n</div>\n<p>Per default, the BundleWarp workflow will save a nonlinearly transformed bundle\nas <code class=\"docutils literal notranslate\"><span class=\"pre\">nonlinearly_moved.trk</span></code>.</p>\n<p>Visualizing the moved and static bundles after registration:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">dipy_horizon</span> <span class=\"s2\">&quot;nonlinearly_moved.trk&quot;</span> <span class=\"s2\">&quot;s_UF_L.trk&quot;</span> <span class=\"o\">--</span><span class=\"n\">random_color</span>\n</pre></div>\n</div>\n<figure class=\"align-center\" id=\"id5\">\n<a class=\"reference internal image-reference\" href=\"https://github.com/dipy/dipy_data/blob/master/partially_deformable_bw_registration.png?raw=true\"><img alt=\"alternate text\" src=\"https://github.com/dipy/dipy_data/blob/master/partially_deformable_bw_registration.png?raw=true\" style=\"width: 70%;\" /></a>\n<figcaption>\n<p><span class=\"caption-text\">Partially moved bundle in green and static bundle in pink after registration.</span><a class=\"headerlink\" href=\"#id5\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n</section>\n<section id=\"fully-deformable-bundlewarp-registration\">\n<h2>Fully Deformable BundleWarp Registration<a class=\"headerlink\" href=\"#fully-deformable-bundlewarp-registration\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<p>Here, we fully deform/warp moving bundle to make it completely aligned with\nthe static bundle. Here, we use lower value of alpha=0.01.\nNOTE: Be caustious with setting lower value of alpha as it can completely\nchange the original anatomical shape of the moving bundle.</p>\n<p>Run the following workflow:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">dipy_bundlewarp</span> <span class=\"s2\">&quot;s_UF_L.trk&quot;</span> <span class=\"s2\">&quot;m_UF_L.trk&quot;</span> <span class=\"o\">--</span><span class=\"n\">alpha</span> <span class=\"mf\">0.01</span> <span class=\"o\">--</span><span class=\"n\">force</span>\n</pre></div>\n</div>\n<p>Per default, the BundleWarp workflow will save a nonlinearly transformed bundle\nas <code class=\"docutils literal notranslate\"><span class=\"pre\">nonlinearly_moved.trk</span></code>.</p>\n<p>Visualizing the moved and static bundles after registration:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">dipy_horizon</span> <span class=\"s2\">&quot;nonlinearly_moved.trk&quot;</span> <span class=\"s2\">&quot;s_UF_L.trk&quot;</span> <span class=\"o\">--</span><span class=\"n\">random_color</span>\n</pre></div>\n</div>\n<figure class=\"align-center\" id=\"id6\">\n<a class=\"reference internal image-reference\" href=\"https://github.com/dipy/dipy_data/blob/master/fully_deformable_bw_registration.png?raw=true\"><img alt=\"alternate text\" src=\"https://github.com/dipy/dipy_data/blob/master/fully_deformable_bw_registration.png?raw=true\" style=\"width: 70%;\" /></a>\n<figcaption>\n<p><span class=\"caption-text\">Fully moved bundle in green and static bundle in pink after registration.</span><a class=\"headerlink\" href=\"#id6\" title=\"Permalink to this image\">\u00b6</a></p>\n</figcaption>\n</figure>\n<p>For more information about each command line, please visit DIPY website <a class=\"reference external\" href=\"https://dipy.org/\">https://dipy.org/</a> .</p>\n<p>If you are using any of these commands please be sure to cite the relevant papers and\nDIPY <a class=\"reference internal\" href=\"../../examples_built/20_registration/bundle_registration/#garyfallidis14\" id=\"id3\"><span>[Garyfallidis14]</span></a>.</p>\n</section>\n<section id=\"references\">\n<h2>References<a class=\"headerlink\" href=\"#references\" title=\"Permalink to this heading\">\u00b6</a></h2>\n<div role=\"list\" class=\"citation-list\">\n<div class=\"citation\" id=\"chandio2023\" role=\"doc-biblioentry\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id1\">Chandio2023</a><span class=\"fn-bracket\">]</span></span>\n<p>Chandio et al. \u201cBundleWarp, streamline-based nonlinear\nregistration of white matter tracts.\u201d bioRxiv (2023): 2023-01</p>\n</div>\n<div class=\"citation\" id=\"garyfallidis14\" role=\"doc-biblioentry\">\n<span class=\"label\"><span class=\"fn-bracket\">[</span><a role=\"doc-backlink\" href=\"#id3\">Garyfallidis14</a><span class=\"fn-bracket\">]</span></span>\n<p>Garyfallidis, E., M. Brett, B. Amirbekian, A. Rokem,\nS. Van Der Walt, M. Descoteaux, and I. Nimmo-Smith.\n\u201cDIPY, a library for the analysis of diffusion MRI data\u201d.\nFrontiers in Neuroinformatics, 1-18, 2014.</p>\n</div>\n</div>\n</section>\n</section>\n", "metatags": "<meta name=\"generator\" content=\"Docutils 0.19: https://docutils.sourceforge.io/\" />\n", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"]], "sourcename": "interfaces/bundlewarp_registration_flow.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">Nonrigid White Matter Bundle Registration with BundleWarp</a><ul>\n<li><a class=\"reference internal\" href=\"#partially-deformable-bundlewarp-registration\">Partially Deformable BundleWarp Registration</a></li>\n<li><a class=\"reference internal\" href=\"#fully-deformable-bundlewarp-registration\">Fully Deformable BundleWarp Registration</a></li>\n<li><a class=\"reference internal\" href=\"#references\">References</a></li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "interfaces/bundlewarp_registration_flow", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12"}
{"parents": [{"link": "../../documentation/", "title": "Documentation"}, {"link": "../", "title": "API Reference"}], "prev": null, "next": {"link": "../dipy.tracking/", "title": "<code class=\"docutils literal notranslate\"><span class=\"pre\">tracking</span></code>"}, "title": "<code class=\"docutils literal notranslate\"><span class=\"pre\">sims</span></code>", "meta": {}, "body": "<div class=\"section\" id=\"module-dipy.sims\">\n<span id=\"sims\"></span><h1><code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">sims</span></code><a class=\"headerlink\" href=\"#module-dipy.sims\" title=\"Permalink to this headline\">\u00b6</a></h1>\n<table border=\"1\" class=\"longtable docutils\">\n<colgroup>\n<col width=\"10%\" />\n<col width=\"90%\" />\n</colgroup>\n<tbody valign=\"top\">\n</tbody>\n</table>\n<div class=\"section\" id=\"module-dipy.sims.phantom\">\n<span id=\"module-sims-phantom\"></span><h2>Module: <code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">sims.phantom</span></code><a class=\"headerlink\" href=\"#module-dipy.sims.phantom\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<table border=\"1\" class=\"longtable docutils\">\n<colgroup>\n<col width=\"10%\" />\n<col width=\"90%\" />\n</colgroup>\n<tbody valign=\"top\">\n<tr class=\"row-odd\"><td><a class=\"reference internal\" href=\"#dipy.sims.phantom.SingleTensor\" title=\"dipy.sims.phantom.SingleTensor\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">SingleTensor</span></code></a>(gtab[,&nbsp;S0,&nbsp;evals,&nbsp;evecs,&nbsp;snr])</td>\n<td>Simulated Q-space signal with a single tensor.</td>\n</tr>\n<tr class=\"row-even\"><td><a class=\"reference internal\" href=\"#dipy.sims.phantom.add_noise\" title=\"dipy.sims.phantom.add_noise\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">add_noise</span></code></a>(vol[,&nbsp;snr,&nbsp;S0,&nbsp;noise_type])</td>\n<td>Add noise of specified distribution to a 4D array.</td>\n</tr>\n<tr class=\"row-odd\"><td><a class=\"reference internal\" href=\"#dipy.sims.phantom.diff2eigenvectors\" title=\"dipy.sims.phantom.diff2eigenvectors\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">diff2eigenvectors</span></code></a>(dx,&nbsp;dy,&nbsp;dz)</td>\n<td>numerical derivatives 2 eigenvectors</td>\n</tr>\n<tr class=\"row-even\"><td><a class=\"reference internal\" href=\"#dipy.sims.phantom.get_fnames\" title=\"dipy.sims.phantom.get_fnames\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">get_fnames</span></code></a>([name])</td>\n<td>provides filenames of some test datasets or other useful parametrisations</td>\n</tr>\n<tr class=\"row-odd\"><td><a class=\"reference internal\" href=\"#dipy.sims.phantom.gradient_table\" title=\"dipy.sims.phantom.gradient_table\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">gradient_table</span></code></a>(bvals[,&nbsp;bvecs,&nbsp;big_delta,&nbsp;\u2026])</td>\n<td>A general function for creating diffusion MR gradients.</td>\n</tr>\n<tr class=\"row-even\"><td><a class=\"reference internal\" href=\"#dipy.sims.phantom.orbital_phantom\" title=\"dipy.sims.phantom.orbital_phantom\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">orbital_phantom</span></code></a>([gtab,&nbsp;evals,&nbsp;func,&nbsp;t,&nbsp;\u2026])</td>\n<td>Create a phantom based on a 3-D orbit <code class=\"docutils literal notranslate\"><span class=\"pre\">f(t)</span> <span class=\"pre\">-&gt;</span> <span class=\"pre\">(x,y,z)</span></code>.</td>\n</tr>\n<tr class=\"row-odd\"><td><a class=\"reference internal\" href=\"#dipy.sims.phantom.vec2vec_rotmat\" title=\"dipy.sims.phantom.vec2vec_rotmat\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">vec2vec_rotmat</span></code></a>(u,&nbsp;v)</td>\n<td>rotation matrix from 2 unit vectors</td>\n</tr>\n</tbody>\n</table>\n</div>\n<div class=\"section\" id=\"module-dipy.sims.voxel\">\n<span id=\"module-sims-voxel\"></span><h2>Module: <code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">sims.voxel</span></code><a class=\"headerlink\" href=\"#module-dipy.sims.voxel\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<table border=\"1\" class=\"longtable docutils\">\n<colgroup>\n<col width=\"10%\" />\n<col width=\"90%\" />\n</colgroup>\n<tbody valign=\"top\">\n<tr class=\"row-odd\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.MultiTensor\" title=\"dipy.sims.voxel.MultiTensor\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">MultiTensor</span></code></a>(gtab,&nbsp;mevals[,&nbsp;S0,&nbsp;angles,&nbsp;\u2026])</td>\n<td>Simulate a Multi-Tensor signal.</td>\n</tr>\n<tr class=\"row-even\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.SingleTensor\" title=\"dipy.sims.voxel.SingleTensor\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">SingleTensor</span></code></a>(gtab[,&nbsp;S0,&nbsp;evals,&nbsp;evecs,&nbsp;snr])</td>\n<td>Simulated Q-space signal with a single tensor.</td>\n</tr>\n<tr class=\"row-odd\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.SticksAndBall\" title=\"dipy.sims.voxel.SticksAndBall\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">SticksAndBall</span></code></a>(gtab[,&nbsp;d,&nbsp;S0,&nbsp;angles,&nbsp;\u2026])</td>\n<td>Simulate the signal for a Sticks &amp; Ball model.</td>\n</tr>\n<tr class=\"row-even\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.add_noise\" title=\"dipy.sims.voxel.add_noise\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">add_noise</span></code></a>(signal,&nbsp;snr,&nbsp;S0[,&nbsp;noise_type])</td>\n<td>Add noise of specified distribution to the signal from a single voxel.</td>\n</tr>\n<tr class=\"row-odd\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.all_tensor_evecs\" title=\"dipy.sims.voxel.all_tensor_evecs\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">all_tensor_evecs</span></code></a>(e0)</td>\n<td>Given the principle tensor axis, return the array of all eigenvectors column-wise (or, the rotation matrix that orientates the tensor).</td>\n</tr>\n<tr class=\"row-even\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.callaghan_perpendicular\" title=\"dipy.sims.voxel.callaghan_perpendicular\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">callaghan_perpendicular</span></code></a>(q,&nbsp;radius)</td>\n<td>Calculates the perpendicular diffusion signal E(q) in a cylinder of radius R using the Soderman model <a class=\"reference internal\" href=\"#r16c3255383f0-1\" id=\"id1\">[1]</a>.</td>\n</tr>\n<tr class=\"row-odd\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.cylinders_and_ball_soderman\" title=\"dipy.sims.voxel.cylinders_and_ball_soderman\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">cylinders_and_ball_soderman</span></code></a>(gtab,&nbsp;tau[,&nbsp;\u2026])</td>\n<td>Calculates the three-dimensional signal attenuation E(q) originating from within a cylinder of radius R using the Soderman approximation <a class=\"reference internal\" href=\"#re2fab78a2424-1\" id=\"id2\">[1]</a>.</td>\n</tr>\n<tr class=\"row-even\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.dki_design_matrix\" title=\"dipy.sims.voxel.dki_design_matrix\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">dki_design_matrix</span></code></a>(gtab)</td>\n<td>Constructs B design matrix for DKI</td>\n</tr>\n<tr class=\"row-odd\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.dki_signal\" title=\"dipy.sims.voxel.dki_signal\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">dki_signal</span></code></a>(gtab,&nbsp;dt,&nbsp;kt[,&nbsp;S0,&nbsp;snr])</td>\n<td>Simulated signal based on the diffusion and diffusion kurtosis tensors of a single voxel.</td>\n</tr>\n<tr class=\"row-even\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.dot\" title=\"dipy.sims.voxel.dot\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">dot</span></code></a>(a,&nbsp;b[,&nbsp;out])</td>\n<td>Dot product of two arrays.</td>\n</tr>\n<tr class=\"row-odd\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.gaussian_parallel\" title=\"dipy.sims.voxel.gaussian_parallel\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">gaussian_parallel</span></code></a>(q,&nbsp;tau[,&nbsp;D])</td>\n<td>Calculates the parallel Gaussian diffusion signal.</td>\n</tr>\n<tr class=\"row-even\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.kurtosis_element\" title=\"dipy.sims.voxel.kurtosis_element\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">kurtosis_element</span></code></a>(D_comps,&nbsp;frac,&nbsp;ind_i,&nbsp;\u2026)</td>\n<td>Computes the diffusion kurtosis tensor element (with indexes i, j, k and l) based on the individual diffusion tensor components of a multicompartmental model.</td>\n</tr>\n<tr class=\"row-odd\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.multi_tensor\" title=\"dipy.sims.voxel.multi_tensor\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">multi_tensor</span></code></a>(gtab,&nbsp;mevals[,&nbsp;S0,&nbsp;angles,&nbsp;\u2026])</td>\n<td>Simulate a Multi-Tensor signal.</td>\n</tr>\n<tr class=\"row-even\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.multi_tensor_dki\" title=\"dipy.sims.voxel.multi_tensor_dki\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">multi_tensor_dki</span></code></a>(gtab,&nbsp;mevals[,&nbsp;S0,&nbsp;angles,&nbsp;\u2026])</td>\n<td>Simulate the diffusion-weight signal, diffusion and kurtosis tensors based on the DKI model</td>\n</tr>\n<tr class=\"row-odd\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.multi_tensor_msd\" title=\"dipy.sims.voxel.multi_tensor_msd\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">multi_tensor_msd</span></code></a>(mf[,&nbsp;mevals,&nbsp;tau])</td>\n<td>Simulate a Multi-Tensor rtop.</td>\n</tr>\n<tr class=\"row-even\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.multi_tensor_odf\" title=\"dipy.sims.voxel.multi_tensor_odf\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">multi_tensor_odf</span></code></a>(odf_verts,&nbsp;mevals,&nbsp;angles,&nbsp;\u2026)</td>\n<td>Simulate a Multi-Tensor ODF.</td>\n</tr>\n<tr class=\"row-odd\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.multi_tensor_pdf\" title=\"dipy.sims.voxel.multi_tensor_pdf\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">multi_tensor_pdf</span></code></a>(pdf_points,&nbsp;mevals,&nbsp;angles,&nbsp;\u2026)</td>\n<td>Simulate a Multi-Tensor ODF.</td>\n</tr>\n<tr class=\"row-even\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.multi_tensor_rtop\" title=\"dipy.sims.voxel.multi_tensor_rtop\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">multi_tensor_rtop</span></code></a>(mf[,&nbsp;mevals,&nbsp;tau])</td>\n<td>Simulate a Multi-Tensor rtop.</td>\n</tr>\n<tr class=\"row-odd\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.single_tensor\" title=\"dipy.sims.voxel.single_tensor\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">single_tensor</span></code></a>(gtab[,&nbsp;S0,&nbsp;evals,&nbsp;evecs,&nbsp;snr])</td>\n<td>Simulated Q-space signal with a single tensor.</td>\n</tr>\n<tr class=\"row-even\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.single_tensor_msd\" title=\"dipy.sims.voxel.single_tensor_msd\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">single_tensor_msd</span></code></a>([evals,&nbsp;tau])</td>\n<td>Simulate a Multi-Tensor rtop.</td>\n</tr>\n<tr class=\"row-odd\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.single_tensor_odf\" title=\"dipy.sims.voxel.single_tensor_odf\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">single_tensor_odf</span></code></a>(r[,&nbsp;evals,&nbsp;evecs])</td>\n<td>Simulated ODF with a single tensor.</td>\n</tr>\n<tr class=\"row-even\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.single_tensor_pdf\" title=\"dipy.sims.voxel.single_tensor_pdf\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">single_tensor_pdf</span></code></a>(r[,&nbsp;evals,&nbsp;evecs,&nbsp;tau])</td>\n<td>Simulated ODF with a single tensor.</td>\n</tr>\n<tr class=\"row-odd\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.single_tensor_rtop\" title=\"dipy.sims.voxel.single_tensor_rtop\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">single_tensor_rtop</span></code></a>([evals,&nbsp;tau])</td>\n<td>Simulate a Multi-Tensor rtop.</td>\n</tr>\n<tr class=\"row-even\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.sphere2cart\" title=\"dipy.sims.voxel.sphere2cart\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">sphere2cart</span></code></a>(r,&nbsp;theta,&nbsp;phi)</td>\n<td>Spherical to Cartesian coordinates</td>\n</tr>\n<tr class=\"row-odd\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.sticks_and_ball\" title=\"dipy.sims.voxel.sticks_and_ball\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">sticks_and_ball</span></code></a>(gtab[,&nbsp;d,&nbsp;S0,&nbsp;angles,&nbsp;\u2026])</td>\n<td>Simulate the signal for a Sticks &amp; Ball model.</td>\n</tr>\n<tr class=\"row-even\"><td><a class=\"reference internal\" href=\"#dipy.sims.voxel.vec2vec_rotmat\" title=\"dipy.sims.voxel.vec2vec_rotmat\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">vec2vec_rotmat</span></code></a>(u,&nbsp;v)</td>\n<td>rotation matrix from 2 unit vectors</td>\n</tr>\n</tbody>\n</table>\n<div class=\"section\" id=\"singletensor\">\n<h3>SingleTensor<a class=\"headerlink\" href=\"#singletensor\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.phantom.SingleTensor\">\n<code class=\"descclassname\">dipy.sims.phantom.</code><code class=\"descname\">SingleTensor</code><span class=\"sig-paren\">(</span><em>gtab</em>, <em>S0=1</em>, <em>evals=None</em>, <em>evecs=None</em>, <em>snr=None</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.phantom.SingleTensor\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Simulated Q-space signal with a single tensor.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>gtab</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">GradientTable</span></dt>\n<dd><p class=\"first last\">Measurement directions.</p>\n</dd>\n<dt><strong>S0</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">double,</span></dt>\n<dd><p class=\"first last\">Strength of signal in the presence of no diffusion gradient (also\ncalled the <code class=\"docutils literal notranslate\"><span class=\"pre\">b=0</span></code> value).</p>\n</dd>\n<dt><strong>evals</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(3,) ndarray</span></dt>\n<dd><p class=\"first last\">Eigenvalues of the diffusion tensor.  By default, values typical for\nprolate white matter are used.</p>\n</dd>\n<dt><strong>evecs</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(3, 3) ndarray</span></dt>\n<dd><p class=\"first last\">Eigenvectors of the tensor.  You can also think of this as a rotation\nmatrix that transforms the direction of the tensor. The eigenvectors\nneed to be column wise.</p>\n</dd>\n<dt><strong>snr</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Signal to noise ratio, assuming Rician noise.  None implies no noise.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>S</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(N,) ndarray</span></dt>\n<dd><p class=\"first last\">Simulated signal: <code class=\"docutils literal notranslate\"><span class=\"pre\">S(q,</span> <span class=\"pre\">tau)</span> <span class=\"pre\">=</span> <span class=\"pre\">S_0</span> <span class=\"pre\">e^(-b</span> <span class=\"pre\">g^T</span> <span class=\"pre\">R</span> <span class=\"pre\">D</span> <span class=\"pre\">R.T</span> <span class=\"pre\">g)</span></code>.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"r85eacbdb4b11-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id3\">[1]</a></td><td>M. Descoteaux, \u201cHigh Angular Resolution Diffusion MRI: from Local\nEstimation to Segmentation and Tractography\u201d, PhD thesis,\nUniversity of Nice-Sophia Antipolis, p. 42, 2008.</td></tr>\n</tbody>\n</table>\n<table class=\"docutils citation\" frame=\"void\" id=\"r85eacbdb4b11-2\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id4\">[2]</a></td><td>E. Stejskal and J. Tanner, \u201cSpin diffusion measurements: spin echos\nin the presence of a time-dependent field gradient\u201d, Journal of\nChemical Physics, nr. 42, pp. 288\u2013292, 1965.</td></tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"add-noise\">\n<h3>add_noise<a class=\"headerlink\" href=\"#add-noise\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.phantom.add_noise\">\n<code class=\"descclassname\">dipy.sims.phantom.</code><code class=\"descname\">add_noise</code><span class=\"sig-paren\">(</span><em>vol</em>, <em>snr=1.0</em>, <em>S0=None</em>, <em>noise_type='rician'</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.phantom.add_noise\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Add noise of specified distribution to a 4D array.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>vol</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape (X,Y,Z,W)</span></dt>\n<dd><p class=\"first last\">Diffusion measurements in <cite>W</cite> directions at each <code class=\"docutils literal notranslate\"><span class=\"pre\">(X,</span> <span class=\"pre\">Y,</span> <span class=\"pre\">Z)</span></code> voxel\nposition.</p>\n</dd>\n<dt><strong>snr</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float, optional</span></dt>\n<dd><p class=\"first last\">The desired signal-to-noise ratio.  (See notes below.)</p>\n</dd>\n<dt><strong>S0</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float, optional</span></dt>\n<dd><p class=\"first last\">Reference signal for specifying <cite>snr</cite> (defaults to 1).</p>\n</dd>\n<dt><strong>noise_type</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">string, optional</span></dt>\n<dd><p class=\"first last\">The distribution of noise added. Can be either \u2018gaussian\u2019 for Gaussian\ndistributed noise, \u2018rician\u2019 for Rice-distributed noise (default) or\n\u2018rayleigh\u2019 for a Rayleigh distribution.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>vol</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, same shape as vol</span></dt>\n<dd><p class=\"first last\">Volume with added noise.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">Notes</p>\n<p>SNR is defined here, following <a class=\"reference internal\" href=\"#ra8cfe81751ec-1\" id=\"id5\">[1]</a>, as <code class=\"docutils literal notranslate\"><span class=\"pre\">S0</span> <span class=\"pre\">/</span> <span class=\"pre\">sigma</span></code>, where <code class=\"docutils literal notranslate\"><span class=\"pre\">sigma</span></code> is\nthe standard deviation of the two Gaussian distributions forming the real\nand imaginary components of the Rician noise distribution (see <a class=\"reference internal\" href=\"#ra8cfe81751ec-2\" id=\"id6\">[2]</a>).</p>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"ra8cfe81751ec-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\">[1]</td><td><em>(<a class=\"fn-backref\" href=\"#id5\">1</a>, <a class=\"fn-backref\" href=\"#id7\">2</a>)</em> Descoteaux, Angelino, Fitzgibbons and Deriche (2007) Regularized,\nfast and robust q-ball imaging. MRM, 58: 497-510</td></tr>\n</tbody>\n</table>\n<table class=\"docutils citation\" frame=\"void\" id=\"ra8cfe81751ec-2\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\">[2]</td><td><em>(<a class=\"fn-backref\" href=\"#id6\">1</a>, <a class=\"fn-backref\" href=\"#id8\">2</a>)</em> Gudbjartson and Patz (2008). The Rician distribution of noisy MRI\ndata. MRM 34: 910-914.</td></tr>\n</tbody>\n</table>\n<p class=\"rubric\">Examples</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">signal</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"mi\">800</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">signal_w_noise</span> <span class=\"o\">=</span> <span class=\"n\">add_noise</span><span class=\"p\">(</span><span class=\"n\">signal</span><span class=\"p\">,</span> <span class=\"n\">snr</span><span class=\"o\">=</span><span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">noise_type</span><span class=\"o\">=</span><span class=\"s1\">&#39;rician&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"diff2eigenvectors\">\n<h3>diff2eigenvectors<a class=\"headerlink\" href=\"#diff2eigenvectors\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.phantom.diff2eigenvectors\">\n<code class=\"descclassname\">dipy.sims.phantom.</code><code class=\"descname\">diff2eigenvectors</code><span class=\"sig-paren\">(</span><em>dx</em>, <em>dy</em>, <em>dz</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.phantom.diff2eigenvectors\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>numerical derivatives 2 eigenvectors</p>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"get-fnames\">\n<h3>get_fnames<a class=\"headerlink\" href=\"#get-fnames\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.phantom.get_fnames\">\n<code class=\"descclassname\">dipy.sims.phantom.</code><code class=\"descname\">get_fnames</code><span class=\"sig-paren\">(</span><em>name='small_64D'</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.phantom.get_fnames\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>provides filenames of some test datasets or other useful parametrisations</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>name</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">str</span></dt>\n<dd><p class=\"first\">the filename/s of which dataset to return, one of:\n\u2018small_64D\u2019 small region of interest nifti,bvecs,bvals 64 directions\n\u2018small_101D\u2019 small region of interest nifti,bvecs,bvals 101 directions\n\u2018aniso_vox\u2019 volume with anisotropic voxel size as Nifti\n\u2018fornix\u2019 300 tracks in Trackvis format (from Pittsburgh</p>\n<blockquote>\n<div><p>Brain Competition)</p>\n</div></blockquote>\n<dl class=\"docutils\">\n<dt>\u2018gqi_vectors\u2019 the scanner wave vectors needed for a GQI acquisitions</dt>\n<dd><p class=\"first last\">of 101 directions tested on Siemens 3T Trio</p>\n</dd>\n</dl>\n<p class=\"last\">\u2018small_25\u2019 small ROI (10x8x2) DTI data (b value 2000, 25 directions)\n\u2018test_piesno\u2019 slice of N=8, K=14 diffusion data\n\u2018reg_c\u2019 small 2D image used for validating registration\n\u2018reg_o\u2019 small 2D image used for validation registration\n\u2018cb_2\u2019 two vectorized cingulum bundles</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>fnames</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">tuple</span></dt>\n<dd><p class=\"first last\">filenames for dataset</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">Examples</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.data</span> <span class=\"k\">import</span> <span class=\"n\">get_fnames</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">fimg</span><span class=\"p\">,</span><span class=\"n\">fbvals</span><span class=\"p\">,</span><span class=\"n\">fbvecs</span><span class=\"o\">=</span><span class=\"n\">get_fnames</span><span class=\"p\">(</span><span class=\"s1\">&#39;small_101D&#39;</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">bvals</span><span class=\"o\">=</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">loadtxt</span><span class=\"p\">(</span><span class=\"n\">fbvals</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">bvecs</span><span class=\"o\">=</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">loadtxt</span><span class=\"p\">(</span><span class=\"n\">fbvecs</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">T</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">import</span> <span class=\"nn\">nibabel</span> <span class=\"k\">as</span> <span class=\"nn\">nib</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">img</span><span class=\"o\">=</span><span class=\"n\">nib</span><span class=\"o\">.</span><span class=\"n\">load</span><span class=\"p\">(</span><span class=\"n\">fimg</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"n\">img</span><span class=\"o\">.</span><span class=\"n\">get_data</span><span class=\"p\">()</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">data</span><span class=\"o\">.</span><span class=\"n\">shape</span> <span class=\"o\">==</span> <span class=\"p\">(</span><span class=\"mi\">6</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">102</span><span class=\"p\">)</span>\n<span class=\"go\">True</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">bvals</span><span class=\"o\">.</span><span class=\"n\">shape</span> <span class=\"o\">==</span> <span class=\"p\">(</span><span class=\"mi\">102</span><span class=\"p\">,)</span>\n<span class=\"go\">True</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">bvecs</span><span class=\"o\">.</span><span class=\"n\">shape</span> <span class=\"o\">==</span> <span class=\"p\">(</span><span class=\"mi\">102</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">)</span>\n<span class=\"go\">True</span>\n</pre></div>\n</div>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"gradient-table\">\n<h3>gradient_table<a class=\"headerlink\" href=\"#gradient-table\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.phantom.gradient_table\">\n<code class=\"descclassname\">dipy.sims.phantom.</code><code class=\"descname\">gradient_table</code><span class=\"sig-paren\">(</span><em>bvals</em>, <em>bvecs=None</em>, <em>big_delta=None</em>, <em>small_delta=None</em>, <em>b0_threshold=50</em>, <em>atol=0.01</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.phantom.gradient_table\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>A general function for creating diffusion MR gradients.</p>\n<p>It reads, loads and prepares scanner parameters like the b-values and\nb-vectors so that they can be useful during the reconstruction process.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>bvals</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">can be any of the four options</span></dt>\n<dd><ol class=\"first last arabic simple\">\n<li>an array of shape (N,) or (1, N) or (N, 1) with the b-values.</li>\n<li>a path for the file which contains an array like the above (1).</li>\n<li>an array of shape (N, 4) or (4, N). Then this parameter is\nconsidered to be a b-table which contains both bvals and bvecs. In\nthis case the next parameter is skipped.</li>\n<li>a path for the file which contains an array like the one at (3).</li>\n</ol>\n</dd>\n<dt><strong>bvecs</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">can be any of two options</span></dt>\n<dd><ol class=\"first last arabic simple\">\n<li>an array of shape (N, 3) or (3, N) with the b-vectors.</li>\n<li>a path for the file which contains an array like the previous.</li>\n</ol>\n</dd>\n<dt><strong>big_delta</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">acquisition pulse separation time in seconds (default None)</p>\n</dd>\n<dt><strong>small_delta</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">acquisition pulse duration time in seconds (default None)</p>\n</dd>\n<dt><strong>b0_threshold</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">All b-values with values less than or equal to <cite>bo_threshold</cite> are\nconsidered as b0s i.e. without diffusion weighting.</p>\n</dd>\n<dt><strong>atol</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">All b-vectors need to be unit vectors up to a tolerance.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>gradients</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">GradientTable</span></dt>\n<dd><p class=\"first last\">A GradientTable with all the gradient information.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">Notes</p>\n<ol class=\"arabic simple\">\n<li>Often b0s (b-values which correspond to images without diffusion\nweighting) have 0 values however in some cases the scanner cannot\nprovide b0s of an exact 0 value and it gives a bit higher values\ne.g. 6 or 12. This is the purpose of the b0_threshold in the __init__.</li>\n<li>We assume that the minimum number of b-values is 7.</li>\n<li>B-vectors should be unit vectors.</li>\n</ol>\n<p class=\"rubric\">Examples</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.core.gradients</span> <span class=\"k\">import</span> <span class=\"n\">gradient_table</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">bvals</span> <span class=\"o\">=</span> <span class=\"mi\">1500</span> <span class=\"o\">*</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">ones</span><span class=\"p\">(</span><span class=\"mi\">7</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">bvals</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">sq2</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sqrt</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">)</span> <span class=\"o\">/</span> <span class=\"mi\">2</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">bvecs</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">],</span>\n<span class=\"gp\">... </span>                  <span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">],</span>\n<span class=\"gp\">... </span>                  <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">],</span>\n<span class=\"gp\">... </span>                  <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">],</span>\n<span class=\"gp\">... </span>                  <span class=\"p\">[</span><span class=\"n\">sq2</span><span class=\"p\">,</span> <span class=\"n\">sq2</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">],</span>\n<span class=\"gp\">... </span>                  <span class=\"p\">[</span><span class=\"n\">sq2</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">sq2</span><span class=\"p\">],</span>\n<span class=\"gp\">... </span>                  <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">sq2</span><span class=\"p\">,</span> <span class=\"n\">sq2</span><span class=\"p\">]])</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">gt</span> <span class=\"o\">=</span> <span class=\"n\">gradient_table</span><span class=\"p\">(</span><span class=\"n\">bvals</span><span class=\"p\">,</span> <span class=\"n\">bvecs</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">bvecs</span><span class=\"o\">.</span><span class=\"n\">shape</span> <span class=\"o\">==</span> <span class=\"n\">bvecs</span><span class=\"o\">.</span><span class=\"n\">shape</span>\n<span class=\"go\">True</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">gt</span> <span class=\"o\">=</span> <span class=\"n\">gradient_table</span><span class=\"p\">(</span><span class=\"n\">bvals</span><span class=\"p\">,</span> <span class=\"n\">bvecs</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">gt</span><span class=\"o\">.</span><span class=\"n\">bvecs</span><span class=\"o\">.</span><span class=\"n\">shape</span> <span class=\"o\">==</span> <span class=\"n\">bvecs</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"o\">.</span><span class=\"n\">shape</span>\n<span class=\"go\">False</span>\n</pre></div>\n</div>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"orbital-phantom\">\n<h3>orbital_phantom<a class=\"headerlink\" href=\"#orbital-phantom\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.phantom.orbital_phantom\">\n<code class=\"descclassname\">dipy.sims.phantom.</code><code class=\"descname\">orbital_phantom</code><span class=\"sig-paren\">(</span><em>gtab=None</em>, <em>evals=array([0.0015</em>, <em>0.0004</em>, <em>0.0004])</em>, <em>func=None</em>, <em>t=array([0.</em>, <em>0.00628947</em>, <em>0.01257895</em>, <em>0.01886842</em>, <em>0.0251579</em>, <em>0.03144737</em>, <em>0.03773685</em>, <em>0.04402632</em>, <em>0.0503158</em>, <em>0.05660527</em>, <em>0.06289475</em>, <em>0.06918422</em>, <em>0.0754737</em>, <em>0.08176317</em>, <em>0.08805265</em>, <em>0.09434212</em>, <em>0.1006316</em>, <em>0.10692107</em>, <em>0.11321055</em>, <em>0.11950002</em>, <em>0.1257895</em>, <em>0.13207897</em>, <em>0.13836845</em>, <em>0.14465792</em>, <em>0.15094739</em>, <em>0.15723687</em>, <em>0.16352634</em>, <em>0.16981582</em>, <em>0.17610529</em>, <em>0.18239477</em>, <em>0.18868424</em>, <em>0.19497372</em>, <em>0.20126319</em>, <em>0.20755267</em>, <em>0.21384214</em>, <em>0.22013162</em>, <em>0.22642109</em>, <em>0.23271057</em>, <em>0.23900004</em>, <em>0.24528952</em>, <em>0.25157899</em>, <em>0.25786847</em>, <em>0.26415794</em>, <em>0.27044742</em>, <em>0.27673689</em>, <em>0.28302637</em>, <em>0.28931584</em>, <em>0.29560531</em>, <em>0.30189479</em>, <em>0.30818426</em>, <em>0.31447374</em>, <em>0.32076321</em>, <em>0.32705269</em>, <em>0.33334216</em>, <em>0.33963164</em>, <em>0.34592111</em>, <em>0.35221059</em>, <em>0.35850006</em>, <em>0.36478954</em>, <em>0.37107901</em>, <em>0.37736849</em>, <em>0.38365796</em>, <em>0.38994744</em>, <em>0.39623691</em>, <em>0.40252639</em>, <em>0.40881586</em>, <em>0.41510534</em>, <em>0.42139481</em>, <em>0.42768429</em>, <em>0.43397376</em>, <em>0.44026323</em>, <em>0.44655271</em>, <em>0.45284218</em>, <em>0.45913166</em>, <em>0.46542113</em>, <em>0.47171061</em>, <em>0.47800008</em>, <em>0.48428956</em>, <em>0.49057903</em>, <em>0.49686851</em>, <em>0.50315798</em>, <em>0.50944746</em>, <em>0.51573693</em>, <em>0.52202641</em>, <em>0.52831588</em>, <em>0.53460536</em>, <em>0.54089483</em>, <em>0.54718431</em>, <em>0.55347378</em>, <em>0.55976326</em>, <em>0.56605273</em>, <em>0.57234221</em>, <em>0.57863168</em>, <em>0.58492115</em>, <em>0.59121063</em>, <em>0.5975001</em>, <em>0.60378958</em>, <em>0.61007905</em>, <em>0.61636853</em>, <em>0.622658</em>, <em>0.62894748</em>, <em>0.63523695</em>, <em>0.64152643</em>, <em>0.6478159</em>, <em>0.65410538</em>, <em>0.66039485</em>, <em>0.66668433</em>, <em>0.6729738</em>, <em>0.67926328</em>, <em>0.68555275</em>, <em>0.69184223</em>, <em>0.6981317</em>, <em>0.70442118</em>, <em>0.71071065</em>, <em>0.71700013</em>, <em>0.7232896</em>, <em>0.72957907</em>, <em>0.73586855</em>, <em>0.74215802</em>, <em>0.7484475</em>, <em>0.75473697</em>, <em>0.76102645</em>, <em>0.76731592</em>, <em>0.7736054</em>, <em>0.77989487</em>, <em>0.78618435</em>, <em>0.79247382</em>, <em>0.7987633</em>, <em>0.80505277</em>, <em>0.81134225</em>, <em>0.81763172</em>, <em>0.8239212</em>, <em>0.83021067</em>, <em>0.83650015</em>, <em>0.84278962</em>, <em>0.8490791</em>, <em>0.85536857</em>, <em>0.86165805</em>, <em>0.86794752</em>, <em>0.87423699</em>, <em>0.88052647</em>, <em>0.88681594</em>, <em>0.89310542</em>, <em>0.89939489</em>, <em>0.90568437</em>, <em>0.91197384</em>, <em>0.91826332</em>, <em>0.92455279</em>, <em>0.93084227</em>, <em>0.93713174</em>, <em>0.94342122</em>, <em>0.94971069</em>, <em>0.95600017</em>, <em>0.96228964</em>, <em>0.96857912</em>, <em>0.97486859</em>, <em>0.98115807</em>, <em>0.98744754</em>, <em>0.99373702</em>, <em>1.00002649</em>, <em>1.00631597</em>, <em>1.01260544</em>, <em>1.01889491</em>, <em>1.02518439</em>, <em>1.03147386</em>, <em>1.03776334</em>, <em>1.04405281</em>, <em>1.05034229</em>, <em>1.05663176</em>, <em>1.06292124</em>, <em>1.06921071</em>, <em>1.07550019</em>, <em>1.08178966</em>, <em>1.08807914</em>, <em>1.09436861</em>, <em>1.10065809</em>, <em>1.10694756</em>, <em>1.11323704</em>, <em>1.11952651</em>, <em>1.12581599</em>, <em>1.13210546</em>, <em>1.13839494</em>, <em>1.14468441</em>, <em>1.15097389</em>, <em>1.15726336</em>, <em>1.16355283</em>, <em>1.16984231</em>, <em>1.17613178</em>, <em>1.18242126</em>, <em>1.18871073</em>, <em>1.19500021</em>, <em>1.20128968</em>, <em>1.20757916</em>, <em>1.21386863</em>, <em>1.22015811</em>, <em>1.22644758</em>, <em>1.23273706</em>, <em>1.23902653</em>, <em>1.24531601</em>, <em>1.25160548</em>, <em>1.25789496</em>, <em>1.26418443</em>, <em>1.27047391</em>, <em>1.27676338</em>, <em>1.28305286</em>, <em>1.28934233</em>, <em>1.29563181</em>, <em>1.30192128</em>, <em>1.30821075</em>, <em>1.31450023</em>, <em>1.3207897</em>, <em>1.32707918</em>, <em>1.33336865</em>, <em>1.33965813</em>, <em>1.3459476</em>, <em>1.35223708</em>, <em>1.35852655</em>, <em>1.36481603</em>, <em>1.3711055</em>, <em>1.37739498</em>, <em>1.38368445</em>, <em>1.38997393</em>, <em>1.3962634</em>, <em>1.40255288</em>, <em>1.40884235</em>, <em>1.41513183</em>, <em>1.4214213</em>, <em>1.42771078</em>, <em>1.43400025</em>, <em>1.44028973</em>, <em>1.4465792</em>, <em>1.45286867</em>, <em>1.45915815</em>, <em>1.46544762</em>, <em>1.4717371</em>, <em>1.47802657</em>, <em>1.48431605</em>, <em>1.49060552</em>, <em>1.496895</em>, <em>1.50318447</em>, <em>1.50947395</em>, <em>1.51576342</em>, <em>1.5220529</em>, <em>1.52834237</em>, <em>1.53463185</em>, <em>1.54092132</em>, <em>1.5472108</em>, <em>1.55350027</em>, <em>1.55978975</em>, <em>1.56607922</em>, <em>1.5723687</em>, <em>1.57865817</em>, <em>1.58494765</em>, <em>1.59123712</em>, <em>1.59752659</em>, <em>1.60381607</em>, <em>1.61010554</em>, <em>1.61639502</em>, <em>1.62268449</em>, <em>1.62897397</em>, <em>1.63526344</em>, <em>1.64155292</em>, <em>1.64784239</em>, <em>1.65413187</em>, <em>1.66042134</em>, <em>1.66671082</em>, <em>1.67300029</em>, <em>1.67928977</em>, <em>1.68557924</em>, <em>1.69186872</em>, <em>1.69815819</em>, <em>1.70444767</em>, <em>1.71073714</em>, <em>1.71702662</em>, <em>1.72331609</em>, <em>1.72960557</em>, <em>1.73589504</em>, <em>1.74218451</em>, <em>1.74847399</em>, <em>1.75476346</em>, <em>1.76105294</em>, <em>1.76734241</em>, <em>1.77363189</em>, <em>1.77992136</em>, <em>1.78621084</em>, <em>1.79250031</em>, <em>1.79878979</em>, <em>1.80507926</em>, <em>1.81136874</em>, <em>1.81765821</em>, <em>1.82394769</em>, <em>1.83023716</em>, <em>1.83652664</em>, <em>1.84281611</em>, <em>1.84910559</em>, <em>1.85539506</em>, <em>1.86168454</em>, <em>1.86797401</em>, <em>1.87426349</em>, <em>1.88055296</em>, <em>1.88684243</em>, <em>1.89313191</em>, <em>1.89942138</em>, <em>1.90571086</em>, <em>1.91200033</em>, <em>1.91828981</em>, <em>1.92457928</em>, <em>1.93086876</em>, <em>1.93715823</em>, <em>1.94344771</em>, <em>1.94973718</em>, <em>1.95602666</em>, <em>1.96231613</em>, <em>1.96860561</em>, <em>1.97489508</em>, <em>1.98118456</em>, <em>1.98747403</em>, <em>1.99376351</em>, <em>2.00005298</em>, <em>2.00634246</em>, <em>2.01263193</em>, <em>2.01892141</em>, <em>2.02521088</em>, <em>2.03150035</em>, <em>2.03778983</em>, <em>2.0440793</em>, <em>2.05036878</em>, <em>2.05665825</em>, <em>2.06294773</em>, <em>2.0692372</em>, <em>2.07552668</em>, <em>2.08181615</em>, <em>2.08810563</em>, <em>2.0943951</em>, <em>2.10068458</em>, <em>2.10697405</em>, <em>2.11326353</em>, <em>2.119553</em>, <em>2.12584248</em>, <em>2.13213195</em>, <em>2.13842143</em>, <em>2.1447109</em>, <em>2.15100038</em>, <em>2.15728985</em>, <em>2.16357932</em>, <em>2.1698688</em>, <em>2.17615827</em>, <em>2.18244775</em>, <em>2.18873722</em>, <em>2.1950267</em>, <em>2.20131617</em>, <em>2.20760565</em>, <em>2.21389512</em>, <em>2.2201846</em>, <em>2.22647407</em>, <em>2.23276355</em>, <em>2.23905302</em>, <em>2.2453425</em>, <em>2.25163197</em>, <em>2.25792145</em>, <em>2.26421092</em>, <em>2.2705004</em>, <em>2.27678987</em>, <em>2.28307935</em>, <em>2.28936882</em>, <em>2.2956583</em>, <em>2.30194777</em>, <em>2.30823724</em>, <em>2.31452672</em>, <em>2.32081619</em>, <em>2.32710567</em>, <em>2.33339514</em>, <em>2.33968462</em>, <em>2.34597409</em>, <em>2.35226357</em>, <em>2.35855304</em>, <em>2.36484252</em>, <em>2.37113199</em>, <em>2.37742147</em>, <em>2.38371094</em>, <em>2.39000042</em>, <em>2.39628989</em>, <em>2.40257937</em>, <em>2.40886884</em>, <em>2.41515832</em>, <em>2.42144779</em>, <em>2.42773727</em>, <em>2.43402674</em>, <em>2.44031622</em>, <em>2.44660569</em>, <em>2.45289516</em>, <em>2.45918464</em>, <em>2.46547411</em>, <em>2.47176359</em>, <em>2.47805306</em>, <em>2.48434254</em>, <em>2.49063201</em>, <em>2.49692149</em>, <em>2.50321096</em>, <em>2.50950044</em>, <em>2.51578991</em>, <em>2.52207939</em>, <em>2.52836886</em>, <em>2.53465834</em>, <em>2.54094781</em>, <em>2.54723729</em>, <em>2.55352676</em>, <em>2.55981624</em>, <em>2.56610571</em>, <em>2.57239519</em>, <em>2.57868466</em>, <em>2.58497414</em>, <em>2.59126361</em>, <em>2.59755308</em>, <em>2.60384256</em>, <em>2.61013203</em>, <em>2.61642151</em>, <em>2.62271098</em>, <em>2.62900046</em>, <em>2.63528993</em>, <em>2.64157941</em>, <em>2.64786888</em>, <em>2.65415836</em>, <em>2.66044783</em>, <em>2.66673731</em>, <em>2.67302678</em>, <em>2.67931626</em>, <em>2.68560573</em>, <em>2.69189521</em>, <em>2.69818468</em>, <em>2.70447416</em>, <em>2.71076363</em>, <em>2.71705311</em>, <em>2.72334258</em>, <em>2.72963206</em>, <em>2.73592153</em>, <em>2.742211</em>, <em>2.74850048</em>, <em>2.75478995</em>, <em>2.76107943</em>, <em>2.7673689</em>, <em>2.77365838</em>, <em>2.77994785</em>, <em>2.78623733</em>, <em>2.7925268</em>, <em>2.79881628</em>, <em>2.80510575</em>, <em>2.81139523</em>, <em>2.8176847</em>, <em>2.82397418</em>, <em>2.83026365</em>, <em>2.83655313</em>, <em>2.8428426</em>, <em>2.84913208</em>, <em>2.85542155</em>, <em>2.86171103</em>, <em>2.8680005</em>, <em>2.87428998</em>, <em>2.88057945</em>, <em>2.88686892</em>, <em>2.8931584</em>, <em>2.89944787</em>, <em>2.90573735</em>, <em>2.91202682</em>, <em>2.9183163</em>, <em>2.92460577</em>, <em>2.93089525</em>, <em>2.93718472</em>, <em>2.9434742</em>, <em>2.94976367</em>, <em>2.95605315</em>, <em>2.96234262</em>, <em>2.9686321</em>, <em>2.97492157</em>, <em>2.98121105</em>, <em>2.98750052</em>, <em>2.99379</em>, <em>3.00007947</em>, <em>3.00636895</em>, <em>3.01265842</em>, <em>3.0189479</em>, <em>3.02523737</em>, <em>3.03152684</em>, <em>3.03781632</em>, <em>3.04410579</em>, <em>3.05039527</em>, <em>3.05668474</em>, <em>3.06297422</em>, <em>3.06926369</em>, <em>3.07555317</em>, <em>3.08184264</em>, <em>3.08813212</em>, <em>3.09442159</em>, <em>3.10071107</em>, <em>3.10700054</em>, <em>3.11329002</em>, <em>3.11957949</em>, <em>3.12586897</em>, <em>3.13215844</em>, <em>3.13844792</em>, <em>3.14473739</em>, <em>3.15102687</em>, <em>3.15731634</em>, <em>3.16360582</em>, <em>3.16989529</em>, <em>3.17618476</em>, <em>3.18247424</em>, <em>3.18876371</em>, <em>3.19505319</em>, <em>3.20134266</em>, <em>3.20763214</em>, <em>3.21392161</em>, <em>3.22021109</em>, <em>3.22650056</em>, <em>3.23279004</em>, <em>3.23907951</em>, <em>3.24536899</em>, <em>3.25165846</em>, <em>3.25794794</em>, <em>3.26423741</em>, <em>3.27052689</em>, <em>3.27681636</em>, <em>3.28310584</em>, <em>3.28939531</em>, <em>3.29568479</em>, <em>3.30197426</em>, <em>3.30826374</em>, <em>3.31455321</em>, <em>3.32084268</em>, <em>3.32713216</em>, <em>3.33342163</em>, <em>3.33971111</em>, <em>3.34600058</em>, <em>3.35229006</em>, <em>3.35857953</em>, <em>3.36486901</em>, <em>3.37115848</em>, <em>3.37744796</em>, <em>3.38373743</em>, <em>3.39002691</em>, <em>3.39631638</em>, <em>3.40260586</em>, <em>3.40889533</em>, <em>3.41518481</em>, <em>3.42147428</em>, <em>3.42776376</em>, <em>3.43405323</em>, <em>3.44034271</em>, <em>3.44663218</em>, <em>3.45292166</em>, <em>3.45921113</em>, <em>3.4655006</em>, <em>3.47179008</em>, <em>3.47807955</em>, <em>3.48436903</em>, <em>3.4906585</em>, <em>3.49694798</em>, <em>3.50323745</em>, <em>3.50952693</em>, <em>3.5158164</em>, <em>3.52210588</em>, <em>3.52839535</em>, <em>3.53468483</em>, <em>3.5409743</em>, <em>3.54726378</em>, <em>3.55355325</em>, <em>3.55984273</em>, <em>3.5661322</em>, <em>3.57242168</em>, <em>3.57871115</em>, <em>3.58500063</em>, <em>3.5912901</em>, <em>3.59757958</em>, <em>3.60386905</em>, <em>3.61015852</em>, <em>3.616448</em>, <em>3.62273747</em>, <em>3.62902695</em>, <em>3.63531642</em>, <em>3.6416059</em>, <em>3.64789537</em>, <em>3.65418485</em>, <em>3.66047432</em>, <em>3.6667638</em>, <em>3.67305327</em>, <em>3.67934275</em>, <em>3.68563222</em>, <em>3.6919217</em>, <em>3.69821117</em>, <em>3.70450065</em>, <em>3.71079012</em>, <em>3.7170796</em>, <em>3.72336907</em>, <em>3.72965855</em>, <em>3.73594802</em>, <em>3.7422375</em>, <em>3.74852697</em>, <em>3.75481644</em>, <em>3.76110592</em>, <em>3.76739539</em>, <em>3.77368487</em>, <em>3.77997434</em>, <em>3.78626382</em>, <em>3.79255329</em>, <em>3.79884277</em>, <em>3.80513224</em>, <em>3.81142172</em>, <em>3.81771119</em>, <em>3.82400067</em>, <em>3.83029014</em>, <em>3.83657962</em>, <em>3.84286909</em>, <em>3.84915857</em>, <em>3.85544804</em>, <em>3.86173752</em>, <em>3.86802699</em>, <em>3.87431647</em>, <em>3.88060594</em>, <em>3.88689542</em>, <em>3.89318489</em>, <em>3.89947436</em>, <em>3.90576384</em>, <em>3.91205331</em>, <em>3.91834279</em>, <em>3.92463226</em>, <em>3.93092174</em>, <em>3.93721121</em>, <em>3.94350069</em>, <em>3.94979016</em>, <em>3.95607964</em>, <em>3.96236911</em>, <em>3.96865859</em>, <em>3.97494806</em>, <em>3.98123754</em>, <em>3.98752701</em>, <em>3.99381649</em>, <em>4.00010596</em>, <em>4.00639544</em>, <em>4.01268491</em>, <em>4.01897439</em>, <em>4.02526386</em>, <em>4.03155334</em>, <em>4.03784281</em>, <em>4.04413228</em>, <em>4.05042176</em>, <em>4.05671123</em>, <em>4.06300071</em>, <em>4.06929018</em>, <em>4.07557966</em>, <em>4.08186913</em>, <em>4.08815861</em>, <em>4.09444808</em>, <em>4.10073756</em>, <em>4.10702703</em>, <em>4.11331651</em>, <em>4.11960598</em>, <em>4.12589546</em>, <em>4.13218493</em>, <em>4.13847441</em>, <em>4.14476388</em>, <em>4.15105336</em>, <em>4.15734283</em>, <em>4.16363231</em>, <em>4.16992178</em>, <em>4.17621126</em>, <em>4.18250073</em>, <em>4.1887902</em>, <em>4.19507968</em>, <em>4.20136915</em>, <em>4.20765863</em>, <em>4.2139481</em>, <em>4.22023758</em>, <em>4.22652705</em>, <em>4.23281653</em>, <em>4.239106</em>, <em>4.24539548</em>, <em>4.25168495</em>, <em>4.25797443</em>, <em>4.2642639</em>, <em>4.27055338</em>, <em>4.27684285</em>, <em>4.28313233</em>, <em>4.2894218</em>, <em>4.29571128</em>, <em>4.30200075</em>, <em>4.30829023</em>, <em>4.3145797</em>, <em>4.32086918</em>, <em>4.32715865</em>, <em>4.33344812</em>, <em>4.3397376</em>, <em>4.34602707</em>, <em>4.35231655</em>, <em>4.35860602</em>, <em>4.3648955</em>, <em>4.37118497</em>, <em>4.37747445</em>, <em>4.38376392</em>, <em>4.3900534</em>, <em>4.39634287</em>, <em>4.40263235</em>, <em>4.40892182</em>, <em>4.4152113</em>, <em>4.42150077</em>, <em>4.42779025</em>, <em>4.43407972</em>, <em>4.4403692</em>, <em>4.44665867</em>, <em>4.45294815</em>, <em>4.45923762</em>, <em>4.4655271</em>, <em>4.47181657</em>, <em>4.47810604</em>, <em>4.48439552</em>, <em>4.49068499</em>, <em>4.49697447</em>, <em>4.50326394</em>, <em>4.50955342</em>, <em>4.51584289</em>, <em>4.52213237</em>, <em>4.52842184</em>, <em>4.53471132</em>, <em>4.54100079</em>, <em>4.54729027</em>, <em>4.55357974</em>, <em>4.55986922</em>, <em>4.56615869</em>, <em>4.57244817</em>, <em>4.57873764</em>, <em>4.58502712</em>, <em>4.59131659</em>, <em>4.59760607</em>, <em>4.60389554</em>, <em>4.61018502</em>, <em>4.61647449</em>, <em>4.62276396</em>, <em>4.62905344</em>, <em>4.63534291</em>, <em>4.64163239</em>, <em>4.64792186</em>, <em>4.65421134</em>, <em>4.66050081</em>, <em>4.66679029</em>, <em>4.67307976</em>, <em>4.67936924</em>, <em>4.68565871</em>, <em>4.69194819</em>, <em>4.69823766</em>, <em>4.70452714</em>, <em>4.71081661</em>, <em>4.71710609</em>, <em>4.72339556</em>, <em>4.72968504</em>, <em>4.73597451</em>, <em>4.74226399</em>, <em>4.74855346</em>, <em>4.75484294</em>, <em>4.76113241</em>, <em>4.76742188</em>, <em>4.77371136</em>, <em>4.78000083</em>, <em>4.78629031</em>, <em>4.79257978</em>, <em>4.79886926</em>, <em>4.80515873</em>, <em>4.81144821</em>, <em>4.81773768</em>, <em>4.82402716</em>, <em>4.83031663</em>, <em>4.83660611</em>, <em>4.84289558</em>, <em>4.84918506</em>, <em>4.85547453</em>, <em>4.86176401</em>, <em>4.86805348</em>, <em>4.87434296</em>, <em>4.88063243</em>, <em>4.88692191</em>, <em>4.89321138</em>, <em>4.89950086</em>, <em>4.90579033</em>, <em>4.9120798</em>, <em>4.91836928</em>, <em>4.92465875</em>, <em>4.93094823</em>, <em>4.9372377</em>, <em>4.94352718</em>, <em>4.94981665</em>, <em>4.95610613</em>, <em>4.9623956</em>, <em>4.96868508</em>, <em>4.97497455</em>, <em>4.98126403</em>, <em>4.9875535</em>, <em>4.99384298</em>, <em>5.00013245</em>, <em>5.00642193</em>, <em>5.0127114</em>, <em>5.01900088</em>, <em>5.02529035</em>, <em>5.03157983</em>, <em>5.0378693</em>, <em>5.04415878</em>, <em>5.05044825</em>, <em>5.05673772</em>, <em>5.0630272</em>, <em>5.06931667</em>, <em>5.07560615</em>, <em>5.08189562</em>, <em>5.0881851</em>, <em>5.09447457</em>, <em>5.10076405</em>, <em>5.10705352</em>, <em>5.113343</em>, <em>5.11963247</em>, <em>5.12592195</em>, <em>5.13221142</em>, <em>5.1385009</em>, <em>5.14479037</em>, <em>5.15107985</em>, <em>5.15736932</em>, <em>5.1636588</em>, <em>5.16994827</em>, <em>5.17623775</em>, <em>5.18252722</em>, <em>5.1888167</em>, <em>5.19510617</em>, <em>5.20139564</em>, <em>5.20768512</em>, <em>5.21397459</em>, <em>5.22026407</em>, <em>5.22655354</em>, <em>5.23284302</em>, <em>5.23913249</em>, <em>5.24542197</em>, <em>5.25171144</em>, <em>5.25800092</em>, <em>5.26429039</em>, <em>5.27057987</em>, <em>5.27686934</em>, <em>5.28315882</em>, <em>5.28944829</em>, <em>5.29573777</em>, <em>5.30202724</em>, <em>5.30831672</em>, <em>5.31460619</em>, <em>5.32089567</em>, <em>5.32718514</em>, <em>5.33347462</em>, <em>5.33976409</em>, <em>5.34605356</em>, <em>5.35234304</em>, <em>5.35863251</em>, <em>5.36492199</em>, <em>5.37121146</em>, <em>5.37750094</em>, <em>5.38379041</em>, <em>5.39007989</em>, <em>5.39636936</em>, <em>5.40265884</em>, <em>5.40894831</em>, <em>5.41523779</em>, <em>5.42152726</em>, <em>5.42781674</em>, <em>5.43410621</em>, <em>5.44039569</em>, <em>5.44668516</em>, <em>5.45297464</em>, <em>5.45926411</em>, <em>5.46555359</em>, <em>5.47184306</em>, <em>5.47813254</em>, <em>5.48442201</em>, <em>5.49071148</em>, <em>5.49700096</em>, <em>5.50329043</em>, <em>5.50957991</em>, <em>5.51586938</em>, <em>5.52215886</em>, <em>5.52844833</em>, <em>5.53473781</em>, <em>5.54102728</em>, <em>5.54731676</em>, <em>5.55360623</em>, <em>5.55989571</em>, <em>5.56618518</em>, <em>5.57247466</em>, <em>5.57876413</em>, <em>5.58505361</em>, <em>5.59134308</em>, <em>5.59763256</em>, <em>5.60392203</em>, <em>5.61021151</em>, <em>5.61650098</em>, <em>5.62279046</em>, <em>5.62907993</em>, <em>5.6353694</em>, <em>5.64165888</em>, <em>5.64794835</em>, <em>5.65423783</em>, <em>5.6605273</em>, <em>5.66681678</em>, <em>5.67310625</em>, <em>5.67939573</em>, <em>5.6856852</em>, <em>5.69197468</em>, <em>5.69826415</em>, <em>5.70455363</em>, <em>5.7108431</em>, <em>5.71713258</em>, <em>5.72342205</em>, <em>5.72971153</em>, <em>5.736001</em>, <em>5.74229048</em>, <em>5.74857995</em>, <em>5.75486943</em>, <em>5.7611589</em>, <em>5.76744838</em>, <em>5.77373785</em>, <em>5.78002732</em>, <em>5.7863168</em>, <em>5.79260627</em>, <em>5.79889575</em>, <em>5.80518522</em>, <em>5.8114747</em>, <em>5.81776417</em>, <em>5.82405365</em>, <em>5.83034312</em>, <em>5.8366326</em>, <em>5.84292207</em>, <em>5.84921155</em>, <em>5.85550102</em>, <em>5.8617905</em>, <em>5.86807997</em>, <em>5.87436945</em>, <em>5.88065892</em>, <em>5.8869484</em>, <em>5.89323787</em>, <em>5.89952735</em>, <em>5.90581682</em>, <em>5.9121063</em>, <em>5.91839577</em>, <em>5.92468524</em>, <em>5.93097472</em>, <em>5.93726419</em>, <em>5.94355367</em>, <em>5.94984314</em>, <em>5.95613262</em>, <em>5.96242209</em>, <em>5.96871157</em>, <em>5.97500104</em>, <em>5.98129052</em>, <em>5.98757999</em>, <em>5.99386947</em>, <em>6.00015894</em>, <em>6.00644842</em>, <em>6.01273789</em>, <em>6.01902737</em>, <em>6.02531684</em>, <em>6.03160632</em>, <em>6.03789579</em>, <em>6.04418527</em>, <em>6.05047474</em>, <em>6.05676422</em>, <em>6.06305369</em>, <em>6.06934316</em>, <em>6.07563264</em>, <em>6.08192211</em>, <em>6.08821159</em>, <em>6.09450106</em>, <em>6.10079054</em>, <em>6.10708001</em>, <em>6.11336949</em>, <em>6.11965896</em>, <em>6.12594844</em>, <em>6.13223791</em>, <em>6.13852739</em>, <em>6.14481686</em>, <em>6.15110634</em>, <em>6.15739581</em>, <em>6.16368529</em>, <em>6.16997476</em>, <em>6.17626424</em>, <em>6.18255371</em>, <em>6.18884319</em>, <em>6.19513266</em>, <em>6.20142214</em>, <em>6.20771161</em>, <em>6.21400108</em>, <em>6.22029056</em>, <em>6.22658003</em>, <em>6.23286951</em>, <em>6.23915898</em>, <em>6.24544846</em>, <em>6.25173793</em>, <em>6.25802741</em>, <em>6.26431688</em>, <em>6.27060636</em>, <em>6.27689583</em>, <em>6.28318531])</em>, <em>datashape=(64</em>, <em>64</em>, <em>64</em>, <em>65)</em>, <em>origin=(32</em>, <em>32</em>, <em>32)</em>, <em>scale=(25</em>, <em>25</em>, <em>25)</em>, <em>angles=array([0.</em>, <em>0.2026834</em>, <em>0.40536679</em>, <em>0.60805019</em>, <em>0.81073359</em>, <em>1.01341699</em>, <em>1.21610038</em>, <em>1.41878378</em>, <em>1.62146718</em>, <em>1.82415057</em>, <em>2.02683397</em>, <em>2.22951737</em>, <em>2.43220076</em>, <em>2.63488416</em>, <em>2.83756756</em>, <em>3.04025096</em>, <em>3.24293435</em>, <em>3.44561775</em>, <em>3.64830115</em>, <em>3.85098454</em>, <em>4.05366794</em>, <em>4.25635134</em>, <em>4.45903473</em>, <em>4.66171813</em>, <em>4.86440153</em>, <em>5.06708493</em>, <em>5.26976832</em>, <em>5.47245172</em>, <em>5.67513512</em>, <em>5.87781851</em>, <em>6.08050191</em>, <em>6.28318531])</em>, <em>radii=array([0.2</em>, <em>0.56</em>, <em>0.92</em>, <em>1.28</em>, <em>1.64</em>, <em>2.  ])</em>, <em>S0=100.0</em>, <em>snr=None</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.phantom.orbital_phantom\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Create a phantom based on a 3-D orbit <code class=\"docutils literal notranslate\"><span class=\"pre\">f(t)</span> <span class=\"pre\">-&gt;</span> <span class=\"pre\">(x,y,z)</span></code>.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>gtab</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">GradientTable</span></dt>\n<dd><p class=\"first last\">Gradient table of measurement directions.</p>\n</dd>\n<dt><strong>evals</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape (3,)</span></dt>\n<dd><p class=\"first last\">Tensor eigenvalues.</p>\n</dd>\n<dt><strong>func</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">user defined function f(t)-&gt;(x,y,z)</span></dt>\n<dd><p class=\"first last\">It could be desirable for <code class=\"docutils literal notranslate\"><span class=\"pre\">-1=&lt;x,y,z</span> <span class=\"pre\">&lt;=1</span></code>.\nIf None creates a circular orbit.</p>\n</dd>\n<dt><strong>t</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape (K,)</span></dt>\n<dd><p class=\"first last\">Represents time for the orbit. Default is\n<code class=\"docutils literal notranslate\"><span class=\"pre\">np.linspace(0,</span> <span class=\"pre\">2</span> <span class=\"pre\">*</span> <span class=\"pre\">np.pi,</span> <span class=\"pre\">1000)</span></code>.</p>\n</dd>\n<dt><strong>datashape</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape (X,Y,Z,W)</span></dt>\n<dd><p class=\"first last\">Size of the output simulated data</p>\n</dd>\n<dt><strong>origin</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">tuple, shape (3,)</span></dt>\n<dd><p class=\"first last\">Define the center for the volume</p>\n</dd>\n<dt><strong>scale</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">tuple, shape (3,)</span></dt>\n<dd><p class=\"first last\">Scale the function before applying to the grid</p>\n</dd>\n<dt><strong>angles</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape (L,)</span></dt>\n<dd><p class=\"first last\">Density angle points, always perpendicular to the first eigen vector\nDefault np.linspace(0, 2 * np.pi, 32).</p>\n</dd>\n<dt><strong>radii</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape (M,)</span></dt>\n<dd><p class=\"first last\">Thickness radii.  Default <code class=\"docutils literal notranslate\"><span class=\"pre\">np.linspace(0.2,</span> <span class=\"pre\">2,</span> <span class=\"pre\">6)</span></code>.\nangles and radii define the total thickness options</p>\n</dd>\n<dt><strong>S0</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">double, optional</span></dt>\n<dd><p class=\"first last\">Maximum simulated signal. Default 100.</p>\n</dd>\n<dt><strong>snr</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float, optional</span></dt>\n<dd><p class=\"first last\">The signal to noise ratio set to apply Rician noise to the data.\nDefault is to not add noise at all.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>data</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape (datashape)</span></dt>\n<dd></dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"admonition seealso\">\n<p class=\"first admonition-title\">See also</p>\n<p class=\"last\"><a class=\"reference internal\" href=\"#dipy.sims.phantom.add_noise\" title=\"dipy.sims.phantom.add_noise\"><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">add_noise</span></code></a></p>\n</div>\n<p class=\"rubric\">Examples</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"k\">def</span> <span class=\"nf\">f</span><span class=\"p\">(</span><span class=\"n\">t</span><span class=\"p\">):</span>\n<span class=\"gp\">... </span>   <span class=\"n\">x</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">sin</span><span class=\"p\">(</span><span class=\"n\">t</span><span class=\"p\">)</span>\n<span class=\"gp\">... </span>   <span class=\"n\">y</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">cos</span><span class=\"p\">(</span><span class=\"n\">t</span><span class=\"p\">)</span>\n<span class=\"gp\">... </span>   <span class=\"n\">z</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linspace</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">))</span>\n<span class=\"gp\">... </span>   <span class=\"k\">return</span> <span class=\"n\">x</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">z</span>\n</pre></div>\n</div>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"n\">orbital_phantom</span><span class=\"p\">(</span><span class=\"n\">func</span><span class=\"o\">=</span><span class=\"n\">f</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"vec2vec-rotmat\">\n<h3>vec2vec_rotmat<a class=\"headerlink\" href=\"#vec2vec-rotmat\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.phantom.vec2vec_rotmat\">\n<code class=\"descclassname\">dipy.sims.phantom.</code><code class=\"descname\">vec2vec_rotmat</code><span class=\"sig-paren\">(</span><em>u</em>, <em>v</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.phantom.vec2vec_rotmat\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>rotation matrix from 2 unit vectors</p>\n<p>u, v being unit 3d vectors return a 3x3 rotation matrix R than aligns u to\nv.</p>\n<p>In general there are many rotations that will map u to v. If S is any\nrotation using v as an axis then R.S will also map u to v since (S.R)u =\nS(Ru) = Sv = v.  The rotation R returned by vec2vec_rotmat leaves fixed the\nperpendicular to the plane spanned by u and v.</p>\n<p>The transpose of R will align v to u.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>u</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape(3,)</span></dt>\n<dd></dd>\n<dt><strong>v</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape(3,)</span></dt>\n<dd></dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>R</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape(3,3)</span></dt>\n<dd></dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">Examples</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.core.geometry</span> <span class=\"k\">import</span> <span class=\"n\">vec2vec_rotmat</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">u</span><span class=\"o\">=</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mi\">0</span><span class=\"p\">])</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">v</span><span class=\"o\">=</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"mi\">0</span><span class=\"p\">])</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">R</span><span class=\"o\">=</span><span class=\"n\">vec2vec_rotmat</span><span class=\"p\">(</span><span class=\"n\">u</span><span class=\"p\">,</span><span class=\"n\">v</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">dot</span><span class=\"p\">(</span><span class=\"n\">R</span><span class=\"p\">,</span><span class=\"n\">u</span><span class=\"p\">)</span>\n<span class=\"go\">array([ 0.,  1.,  0.])</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">dot</span><span class=\"p\">(</span><span class=\"n\">R</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span><span class=\"n\">v</span><span class=\"p\">)</span>\n<span class=\"go\">array([ 1.,  0.,  0.])</span>\n</pre></div>\n</div>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"multitensor\">\n<h3>MultiTensor<a class=\"headerlink\" href=\"#multitensor\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.MultiTensor\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">MultiTensor</code><span class=\"sig-paren\">(</span><em>gtab, mevals, S0=1.0, angles=[(0, 0), (90, 0)], fractions=[50, 50], snr=20</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.MultiTensor\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Simulate a Multi-Tensor signal.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>gtab</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">GradientTable</span></dt>\n<dd></dd>\n<dt><strong>mevals</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array (K, 3)</span></dt>\n<dd><p class=\"first last\">each tensor\u2019s eigenvalues in each row</p>\n</dd>\n<dt><strong>S0</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Unweighted signal value (b0 signal).</p>\n</dd>\n<dt><strong>angles</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array (K,2) or (K,3)</span></dt>\n<dd><p class=\"first last\">List of K tensor directions in polar angles (in degrees) or unit\nvectors</p>\n</dd>\n<dt><strong>fractions</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Percentage of the contribution of each tensor. The sum of fractions\nshould be equal to 100%.</p>\n</dd>\n<dt><strong>snr</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Signal to noise ratio, assuming Rician noise.  If set to None, no\nnoise is added.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>S</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(N,) ndarray</span></dt>\n<dd><p class=\"first last\">Simulated signal.</p>\n</dd>\n<dt><strong>sticks</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(M,3)</span></dt>\n<dd><p class=\"first last\">Sticks in cartesian coordinates.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">Examples</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.sims.voxel</span> <span class=\"k\">import</span> <span class=\"n\">multi_tensor</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.data</span> <span class=\"k\">import</span> <span class=\"n\">get_fnames</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.core.gradients</span> <span class=\"k\">import</span> <span class=\"n\">gradient_table</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.io.gradients</span> <span class=\"k\">import</span> <span class=\"n\">read_bvals_bvecs</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">fimg</span><span class=\"p\">,</span> <span class=\"n\">fbvals</span><span class=\"p\">,</span> <span class=\"n\">fbvecs</span> <span class=\"o\">=</span> <span class=\"n\">get_fnames</span><span class=\"p\">(</span><span class=\"s1\">&#39;small_101D&#39;</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">bvals</span><span class=\"p\">,</span> <span class=\"n\">bvecs</span> <span class=\"o\">=</span> <span class=\"n\">read_bvals_bvecs</span><span class=\"p\">(</span><span class=\"n\">fbvals</span><span class=\"p\">,</span> <span class=\"n\">fbvecs</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">gtab</span> <span class=\"o\">=</span> <span class=\"n\">gradient_table</span><span class=\"p\">(</span><span class=\"n\">bvals</span><span class=\"p\">,</span> <span class=\"n\">bvecs</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">mevals</span><span class=\"o\">=</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(([</span><span class=\"mf\">0.0015</span><span class=\"p\">,</span> <span class=\"mf\">0.0003</span><span class=\"p\">,</span> <span class=\"mf\">0.0003</span><span class=\"p\">],[</span><span class=\"mf\">0.0015</span><span class=\"p\">,</span> <span class=\"mf\">0.0003</span><span class=\"p\">,</span> <span class=\"mf\">0.0003</span><span class=\"p\">]))</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">e0</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mf\">0.</span><span class=\"p\">])</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">e1</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([</span><span class=\"mf\">0.</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">])</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">S</span> <span class=\"o\">=</span> <span class=\"n\">multi_tensor</span><span class=\"p\">(</span><span class=\"n\">gtab</span><span class=\"p\">,</span> <span class=\"n\">mevals</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"id9\">\n<h3>SingleTensor<a class=\"headerlink\" href=\"#id9\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.SingleTensor\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">SingleTensor</code><span class=\"sig-paren\">(</span><em>gtab</em>, <em>S0=1</em>, <em>evals=None</em>, <em>evecs=None</em>, <em>snr=None</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.SingleTensor\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Simulated Q-space signal with a single tensor.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>gtab</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">GradientTable</span></dt>\n<dd><p class=\"first last\">Measurement directions.</p>\n</dd>\n<dt><strong>S0</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">double,</span></dt>\n<dd><p class=\"first last\">Strength of signal in the presence of no diffusion gradient (also\ncalled the <code class=\"docutils literal notranslate\"><span class=\"pre\">b=0</span></code> value).</p>\n</dd>\n<dt><strong>evals</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(3,) ndarray</span></dt>\n<dd><p class=\"first last\">Eigenvalues of the diffusion tensor.  By default, values typical for\nprolate white matter are used.</p>\n</dd>\n<dt><strong>evecs</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(3, 3) ndarray</span></dt>\n<dd><p class=\"first last\">Eigenvectors of the tensor.  You can also think of this as a rotation\nmatrix that transforms the direction of the tensor. The eigenvectors\nneed to be column wise.</p>\n</dd>\n<dt><strong>snr</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Signal to noise ratio, assuming Rician noise.  None implies no noise.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>S</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(N,) ndarray</span></dt>\n<dd><p class=\"first last\">Simulated signal: <code class=\"docutils literal notranslate\"><span class=\"pre\">S(q,</span> <span class=\"pre\">tau)</span> <span class=\"pre\">=</span> <span class=\"pre\">S_0</span> <span class=\"pre\">e^(-b</span> <span class=\"pre\">g^T</span> <span class=\"pre\">R</span> <span class=\"pre\">D</span> <span class=\"pre\">R.T</span> <span class=\"pre\">g)</span></code>.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"r3f96b1e3cbe4-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id10\">[1]</a></td><td>M. Descoteaux, \u201cHigh Angular Resolution Diffusion MRI: from Local\nEstimation to Segmentation and Tractography\u201d, PhD thesis,\nUniversity of Nice-Sophia Antipolis, p. 42, 2008.</td></tr>\n</tbody>\n</table>\n<table class=\"docutils citation\" frame=\"void\" id=\"r3f96b1e3cbe4-2\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id11\">[2]</a></td><td>E. Stejskal and J. Tanner, \u201cSpin diffusion measurements: spin echos\nin the presence of a time-dependent field gradient\u201d, Journal of\nChemical Physics, nr. 42, pp. 288\u2013292, 1965.</td></tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"sticksandball\">\n<h3>SticksAndBall<a class=\"headerlink\" href=\"#sticksandball\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.SticksAndBall\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">SticksAndBall</code><span class=\"sig-paren\">(</span><em>gtab, d=0.0015, S0=1.0, angles=[(0, 0), (90, 0)], fractions=[35, 35], snr=20</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.SticksAndBall\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Simulate the signal for a Sticks &amp; Ball model.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>gtab</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">GradientTable</span></dt>\n<dd><p class=\"first last\">Signal measurement directions.</p>\n</dd>\n<dt><strong>d</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Diffusivity value.</p>\n</dd>\n<dt><strong>S0</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Unweighted signal value.</p>\n</dd>\n<dt><strong>angles</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array (K,2) or (K, 3)</span></dt>\n<dd><p class=\"first last\">List of K polar angles (in degrees) for the sticks or array of K\nsticks as unit vectors.</p>\n</dd>\n<dt><strong>fractions</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Percentage of each stick.  Remainder to 100 specifies isotropic\ncomponent.</p>\n</dd>\n<dt><strong>snr</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Signal to noise ratio, assuming Rician noise.  If set to None, no\nnoise is added.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>S</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(N,) ndarray</span></dt>\n<dd><p class=\"first last\">Simulated signal.</p>\n</dd>\n<dt><strong>sticks</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(M,3)</span></dt>\n<dd><p class=\"first last\">Sticks in cartesian coordinates.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"rb2895a322469-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id12\">[1]</a></td><td>Behrens et al., \u201cProbabilistic diffusion\ntractography with multiple fiber orientations:  what can we gain?\u201d,\nNeuroimage, 2007.</td></tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"id13\">\n<h3>add_noise<a class=\"headerlink\" href=\"#id13\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.add_noise\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">add_noise</code><span class=\"sig-paren\">(</span><em>signal</em>, <em>snr</em>, <em>S0</em>, <em>noise_type='rician'</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.add_noise\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Add noise of specified distribution to the signal from a single voxel.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>signal</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">1-d ndarray</span></dt>\n<dd><p class=\"first last\">The signal in the voxel.</p>\n</dd>\n<dt><strong>snr</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">The desired signal-to-noise ratio. (See notes below.)\nIf <cite>snr</cite> is None, return the signal as-is.</p>\n</dd>\n<dt><strong>S0</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Reference signal for specifying <cite>snr</cite>.</p>\n</dd>\n<dt><strong>noise_type</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">string, optional</span></dt>\n<dd><p class=\"first last\">The distribution of noise added. Can be either \u2018gaussian\u2019 for Gaussian\ndistributed noise, \u2018rician\u2019 for Rice-distributed noise (default) or\n\u2018rayleigh\u2019 for a Rayleigh distribution.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>signal</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, same shape as the input</span></dt>\n<dd><p class=\"first last\">Signal with added noise.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">Notes</p>\n<p>SNR is defined here, following <a class=\"reference internal\" href=\"#rb9d9ab9d2d88-1\" id=\"id14\">[1]</a>, as <code class=\"docutils literal notranslate\"><span class=\"pre\">S0</span> <span class=\"pre\">/</span> <span class=\"pre\">sigma</span></code>, where <code class=\"docutils literal notranslate\"><span class=\"pre\">sigma</span></code> is\nthe standard deviation of the two Gaussian distributions forming the real\nand imaginary components of the Rician noise distribution (see <a class=\"reference internal\" href=\"#rb9d9ab9d2d88-2\" id=\"id15\">[2]</a>).</p>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"rb9d9ab9d2d88-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\">[1]</td><td><em>(<a class=\"fn-backref\" href=\"#id14\">1</a>, <a class=\"fn-backref\" href=\"#id16\">2</a>)</em> Descoteaux, Angelino, Fitzgibbons and Deriche (2007) Regularized,\nfast and robust q-ball imaging. MRM, 58: 497-510</td></tr>\n</tbody>\n</table>\n<table class=\"docutils citation\" frame=\"void\" id=\"rb9d9ab9d2d88-2\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\">[2]</td><td><em>(<a class=\"fn-backref\" href=\"#id15\">1</a>, <a class=\"fn-backref\" href=\"#id17\">2</a>)</em> Gudbjartson and Patz (2008). The Rician distribution of noisy MRI\ndata. MRM 34: 910-914.</td></tr>\n</tbody>\n</table>\n<p class=\"rubric\">Examples</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">signal</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"mi\">800</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">signal_w_noise</span> <span class=\"o\">=</span> <span class=\"n\">add_noise</span><span class=\"p\">(</span><span class=\"n\">signal</span><span class=\"p\">,</span> <span class=\"mf\">10.</span><span class=\"p\">,</span> <span class=\"mf\">100.</span><span class=\"p\">,</span> <span class=\"n\">noise_type</span><span class=\"o\">=</span><span class=\"s1\">&#39;rician&#39;</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"all-tensor-evecs\">\n<h3>all_tensor_evecs<a class=\"headerlink\" href=\"#all-tensor-evecs\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.all_tensor_evecs\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">all_tensor_evecs</code><span class=\"sig-paren\">(</span><em>e0</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.all_tensor_evecs\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Given the principle tensor axis, return the array of all\neigenvectors column-wise (or, the rotation matrix that orientates the\ntensor).</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>e0</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(3,) ndarray</span></dt>\n<dd><p class=\"first last\">Principle tensor axis.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>evecs</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(3,3) ndarray</span></dt>\n<dd><p class=\"first last\">Tensor eigenvectors, arranged column-wise.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"callaghan-perpendicular\">\n<h3>callaghan_perpendicular<a class=\"headerlink\" href=\"#callaghan-perpendicular\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.callaghan_perpendicular\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">callaghan_perpendicular</code><span class=\"sig-paren\">(</span><em>q</em>, <em>radius</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.callaghan_perpendicular\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Calculates the perpendicular diffusion signal E(q) in a cylinder of\nradius R using the Soderman model <a class=\"reference internal\" href=\"#r16c3255383f0-1\" id=\"id18\">[1]</a>. Assumes that the pulse length\nis infinitely short and the diffusion time is infinitely long.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>q</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape (N,)</span></dt>\n<dd><p class=\"first last\">q-space value in 1/mm</p>\n</dd>\n<dt><strong>radius</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">cylinder radius in mm</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>E</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape (N,)</span></dt>\n<dd><p class=\"first last\">signal attenuation</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"r16c3255383f0-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\">[1]</td><td><em>(<a class=\"fn-backref\" href=\"#id1\">1</a>, <a class=\"fn-backref\" href=\"#id18\">2</a>, <a class=\"fn-backref\" href=\"#id19\">3</a>)</em> S\u00f6derman, Olle, and Bengt J\u00f6nsson. \u201cRestricted diffusion in\ncylindrical geometry.\u201d Journal of Magnetic Resonance, Series A\n117.1 (1995): 94-97.</td></tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"cylinders-and-ball-soderman\">\n<h3>cylinders_and_ball_soderman<a class=\"headerlink\" href=\"#cylinders-and-ball-soderman\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.cylinders_and_ball_soderman\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">cylinders_and_ball_soderman</code><span class=\"sig-paren\">(</span><em>gtab, tau, radii=[0.005, 0.005], D=0.0007, S0=1.0, angles=[(0, 0), (90, 0)], fractions=[35, 35], snr=20</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.cylinders_and_ball_soderman\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Calculates the three-dimensional signal attenuation E(q) originating\nfrom within a cylinder of radius R using the Soderman approximation <a class=\"reference internal\" href=\"#re2fab78a2424-1\" id=\"id20\">[1]</a>.\nThe diffusion signal is assumed to be separable perpendicular and parallel\nto the cylinder axis <a class=\"reference internal\" href=\"#re2fab78a2424-2\" id=\"id21\">[2]</a>.\nThis function is basically an extension of the ball and stick model.\nSetting the radius to zero makes them equivalent.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>gtab</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">GradientTable</span></dt>\n<dd><p class=\"first last\">Signal measurement directions.</p>\n</dd>\n<dt><strong>tau</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">diffusion time in s</p>\n</dd>\n<dt><strong>radii</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">cylinder radius in mm</p>\n</dd>\n<dt><strong>D</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">diffusion constant</p>\n</dd>\n<dt><strong>S0</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Unweighted signal value.</p>\n</dd>\n<dt><strong>angles</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array (K,2) or (K, 3)</span></dt>\n<dd><p class=\"first last\">List of K polar angles (in degrees) for the sticks or array of K\nsticks as unit vectors.</p>\n</dd>\n<dt><strong>fractions</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">[float]</span></dt>\n<dd><p class=\"first last\">Percentage of each stick.  Remainder to 100 specifies isotropic\ncomponent.</p>\n</dd>\n<dt><strong>snr</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Signal to noise ratio, assuming Rician noise.  If set to None, no\nnoise is added.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>E</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape (N,)</span></dt>\n<dd><p class=\"first last\">signal attenuation</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"re2fab78a2424-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\">[1]</td><td><em>(<a class=\"fn-backref\" href=\"#id2\">1</a>, <a class=\"fn-backref\" href=\"#id20\">2</a>, <a class=\"fn-backref\" href=\"#id22\">3</a>)</em> S\u00f6derman, Olle, and Bengt J\u00f6nsson. \u201cRestricted diffusion in\ncylindrical geometry.\u201d Journal of Magnetic Resonance, Series A\n117.1 (1995): 94-97.</td></tr>\n</tbody>\n</table>\n<table class=\"docutils citation\" frame=\"void\" id=\"re2fab78a2424-2\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\">[2]</td><td><em>(<a class=\"fn-backref\" href=\"#id21\">1</a>, <a class=\"fn-backref\" href=\"#id23\">2</a>)</em> Assaf, Yaniv, et al. \u201cNew modeling and experimental framework to\ncharacterize hindered and restricted water diffusion in brain white\nmatter.\u201d Magnetic Resonance in Medicine 52.5 (2004): 965-978.</td></tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"dki-design-matrix\">\n<h3>dki_design_matrix<a class=\"headerlink\" href=\"#dki-design-matrix\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.dki_design_matrix\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">dki_design_matrix</code><span class=\"sig-paren\">(</span><em>gtab</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.dki_design_matrix\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Constructs B design matrix for DKI</p>\n<dl class=\"docutils\">\n<dt>gtab <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">GradientTable</span></dt>\n<dd>Measurement directions.</dd>\n</dl>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>B</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array (N, 22)</span></dt>\n<dd><p class=\"first\">Design matrix or B matrix for the DKI model\nB[j, :] = (Bxx, Bxy, Bzz, Bxz, Byz, Bzz,</p>\n<blockquote class=\"last\">\n<div><p>Bxxxx, Byyyy, Bzzzz, Bxxxy, Bxxxz,\nBxyyy, Byyyz, Bxzzz, Byzzz, Bxxyy,\nBxxzz, Byyzz, Bxxyz, Bxyyz, Bxyzz,\nBlogS0)</p>\n</div></blockquote>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"dki-signal\">\n<h3>dki_signal<a class=\"headerlink\" href=\"#dki-signal\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.dki_signal\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">dki_signal</code><span class=\"sig-paren\">(</span><em>gtab</em>, <em>dt</em>, <em>kt</em>, <em>S0=150</em>, <em>snr=None</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.dki_signal\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Simulated signal based on the diffusion and diffusion kurtosis\ntensors of a single voxel. Simulations are preformed assuming the DKI\nmodel.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>gtab</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">GradientTable</span></dt>\n<dd><p class=\"first last\">Measurement directions.</p>\n</dd>\n<dt><strong>dt</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(6,) ndarray</span></dt>\n<dd><p class=\"first last\">Elements of the diffusion tensor.</p>\n</dd>\n<dt><strong>kt</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(15, ) ndarray</span></dt>\n<dd><p class=\"first last\">Elements of the diffusion kurtosis tensor.</p>\n</dd>\n<dt><strong>S0</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float (optional)</span></dt>\n<dd><p class=\"first last\">Strength of signal in the presence of no diffusion gradient.</p>\n</dd>\n<dt><strong>snr</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float (optional)</span></dt>\n<dd><p class=\"first last\">Signal to noise ratio, assuming Rician noise.  None implies no noise.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>S</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(N,) ndarray</span></dt>\n<dd><p class=\"first last\">Simulated signal based on the DKI model:</p>\n</dd>\n<dt><strong>.. math::</strong></dt>\n<dd><p class=\"first last\">S=S_{0}e^{-bD+frac{1}{6}b^{2}D^{2}K}</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"rf3e80b34d88e-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id24\">[1]</a></td><td>R. Neto Henriques et al., \u201cExploring the 3D geometry of the\ndiffusion kurtosis tensor - Impact on the development of robust\ntractography procedures and novel biomarkers\u201d, NeuroImage (2015)\n111, 85-99.</td></tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"dot\">\n<h3>dot<a class=\"headerlink\" href=\"#dot\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.dot\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">dot</code><span class=\"sig-paren\">(</span><em>a</em>, <em>b</em>, <em>out=None</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.dot\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Dot product of two arrays. Specifically,</p>\n<ul>\n<li><p class=\"first\">If both <cite>a</cite> and <cite>b</cite> are 1-D arrays, it is inner product of vectors\n(without complex conjugation).</p>\n</li>\n<li><p class=\"first\">If both <cite>a</cite> and <cite>b</cite> are 2-D arrays, it is matrix multiplication,\nbut using <code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">matmul()</span></code> or <code class=\"docutils literal notranslate\"><span class=\"pre\">a</span> <span class=\"pre\">&#64;</span> <span class=\"pre\">b</span></code> is preferred.</p>\n</li>\n<li><p class=\"first\">If either <cite>a</cite> or <cite>b</cite> is 0-D (scalar), it is equivalent to <code class=\"xref py py-func docutils literal notranslate\"><span class=\"pre\">multiply()</span></code>\nand using <code class=\"docutils literal notranslate\"><span class=\"pre\">numpy.multiply(a,</span> <span class=\"pre\">b)</span></code> or <code class=\"docutils literal notranslate\"><span class=\"pre\">a</span> <span class=\"pre\">*</span> <span class=\"pre\">b</span></code> is preferred.</p>\n</li>\n<li><p class=\"first\">If <cite>a</cite> is an N-D array and <cite>b</cite> is a 1-D array, it is a sum product over\nthe last axis of <cite>a</cite> and <cite>b</cite>.</p>\n</li>\n<li><p class=\"first\">If <cite>a</cite> is an N-D array and <cite>b</cite> is an M-D array (where <code class=\"docutils literal notranslate\"><span class=\"pre\">M&gt;=2</span></code>), it is a\nsum product over the last axis of <cite>a</cite> and the second-to-last axis of <cite>b</cite>:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">dot</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">,</span> <span class=\"n\">b</span><span class=\"p\">)[</span><span class=\"n\">i</span><span class=\"p\">,</span><span class=\"n\">j</span><span class=\"p\">,</span><span class=\"n\">k</span><span class=\"p\">,</span><span class=\"n\">m</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">,</span><span class=\"n\">j</span><span class=\"p\">,:]</span> <span class=\"o\">*</span> <span class=\"n\">b</span><span class=\"p\">[</span><span class=\"n\">k</span><span class=\"p\">,:,</span><span class=\"n\">m</span><span class=\"p\">])</span>\n</pre></div>\n</div>\n</li>\n</ul>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>a</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array_like</span></dt>\n<dd><p class=\"first last\">First argument.</p>\n</dd>\n<dt><strong>b</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array_like</span></dt>\n<dd><p class=\"first last\">Second argument.</p>\n</dd>\n<dt><strong>out</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">ndarray, optional</span></dt>\n<dd><p class=\"first last\">Output argument. This must have the exact kind that would be returned\nif it was not used. In particular, it must have the right type, must be\nC-contiguous, and its dtype must be the dtype that would be returned\nfor <cite>dot(a,b)</cite>. This is a performance feature. Therefore, if these\nconditions are not met, an exception is raised, instead of attempting\nto be flexible.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>output</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">ndarray</span></dt>\n<dd><p class=\"first last\">Returns the dot product of <cite>a</cite> and <cite>b</cite>.  If <cite>a</cite> and <cite>b</cite> are both\nscalars or both 1-D arrays then a scalar is returned; otherwise\nan array is returned.\nIf <cite>out</cite> is given, then it is returned.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-odd field\"><th class=\"field-name\">Raises:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>ValueError</strong></dt>\n<dd><p class=\"first last\">If the last dimension of <cite>a</cite> is not the same size as\nthe second-to-last dimension of <cite>b</cite>.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<div class=\"admonition seealso\">\n<p class=\"first admonition-title\">See also</p>\n<dl class=\"last docutils\">\n<dt><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">vdot</span></code></dt>\n<dd>Complex-conjugating dot product.</dd>\n<dt><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">tensordot</span></code></dt>\n<dd>Sum products over arbitrary axes.</dd>\n<dt><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">einsum</span></code></dt>\n<dd>Einstein summation convention.</dd>\n<dt><code class=\"xref py py-obj docutils literal notranslate\"><span class=\"pre\">matmul</span></code></dt>\n<dd>\u2018&#64;\u2019 operator as method with out parameter.</dd>\n</dl>\n</div>\n<p class=\"rubric\">Examples</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">dot</span><span class=\"p\">(</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">)</span>\n<span class=\"go\">12</span>\n</pre></div>\n</div>\n<p>Neither argument is complex-conjugated:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">dot</span><span class=\"p\">([</span><span class=\"mi\">2</span><span class=\"n\">j</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"n\">j</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"n\">j</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"n\">j</span><span class=\"p\">])</span>\n<span class=\"go\">(-13+0j)</span>\n</pre></div>\n</div>\n<p>For 2-D arrays it is the matrix product:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">a</span> <span class=\"o\">=</span> <span class=\"p\">[[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]]</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">b</span> <span class=\"o\">=</span> <span class=\"p\">[[</span><span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">]]</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">dot</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">,</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n<span class=\"go\">array([[4, 1],</span>\n<span class=\"go\">       [2, 2]])</span>\n</pre></div>\n</div>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">a</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"mi\">3</span><span class=\"o\">*</span><span class=\"mi\">4</span><span class=\"o\">*</span><span class=\"mi\">5</span><span class=\"o\">*</span><span class=\"mi\">6</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">reshape</span><span class=\"p\">((</span><span class=\"mi\">3</span><span class=\"p\">,</span><span class=\"mi\">4</span><span class=\"p\">,</span><span class=\"mi\">5</span><span class=\"p\">,</span><span class=\"mi\">6</span><span class=\"p\">))</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">b</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"mi\">3</span><span class=\"o\">*</span><span class=\"mi\">4</span><span class=\"o\">*</span><span class=\"mi\">5</span><span class=\"o\">*</span><span class=\"mi\">6</span><span class=\"p\">)[::</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">reshape</span><span class=\"p\">((</span><span class=\"mi\">5</span><span class=\"p\">,</span><span class=\"mi\">4</span><span class=\"p\">,</span><span class=\"mi\">6</span><span class=\"p\">,</span><span class=\"mi\">3</span><span class=\"p\">))</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">dot</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">,</span> <span class=\"n\">b</span><span class=\"p\">)[</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"mi\">3</span><span class=\"p\">,</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"mi\">2</span><span class=\"p\">]</span>\n<span class=\"go\">499128</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">,</span><span class=\"mi\">3</span><span class=\"p\">,</span><span class=\"mi\">2</span><span class=\"p\">,:]</span> <span class=\"o\">*</span> <span class=\"n\">b</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"mi\">2</span><span class=\"p\">,:,</span><span class=\"mi\">2</span><span class=\"p\">])</span>\n<span class=\"go\">499128</span>\n</pre></div>\n</div>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"gaussian-parallel\">\n<h3>gaussian_parallel<a class=\"headerlink\" href=\"#gaussian-parallel\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.gaussian_parallel\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">gaussian_parallel</code><span class=\"sig-paren\">(</span><em>q</em>, <em>tau</em>, <em>D=0.0007</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.gaussian_parallel\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Calculates the parallel Gaussian diffusion signal.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>q</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape (N,)</span></dt>\n<dd><p class=\"first last\">q-space value in 1/mm</p>\n</dd>\n<dt><strong>tau</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">diffusion time in s</p>\n</dd>\n<dt><strong>D</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">diffusion constant</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>E</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape (N,)</span></dt>\n<dd><p class=\"first last\">signal attenuation</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"kurtosis-element\">\n<h3>kurtosis_element<a class=\"headerlink\" href=\"#kurtosis-element\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.kurtosis_element\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">kurtosis_element</code><span class=\"sig-paren\">(</span><em>D_comps</em>, <em>frac</em>, <em>ind_i</em>, <em>ind_j</em>, <em>ind_k</em>, <em>ind_l</em>, <em>DT=None</em>, <em>MD=None</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.kurtosis_element\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Computes the diffusion kurtosis tensor element (with indexes i, j, k\nand l) based on the individual diffusion tensor components of a\nmulticompartmental model.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>D_comps</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(K,3,3) ndarray</span></dt>\n<dd><p class=\"first last\">Diffusion tensors for all K individual compartment of the\nmulticompartmental model.</p>\n</dd>\n<dt><strong>frac</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">[float]</span></dt>\n<dd><p class=\"first last\">Percentage of the contribution of each tensor. The sum of fractions\nshould be equal to 100%.</p>\n</dd>\n<dt><strong>ind_i</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">int</span></dt>\n<dd><p class=\"first last\">Element\u2019s index i (0 for x, 1 for y, 2 for z)</p>\n</dd>\n<dt><strong>ind_j</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">int</span></dt>\n<dd><p class=\"first last\">Element\u2019s index j (0 for x, 1 for y, 2 for z)</p>\n</dd>\n<dt><strong>ind_k</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">int</span></dt>\n<dd><p class=\"first last\">Element\u2019s index k (0 for x, 1 for y, 2 for z)</p>\n</dd>\n<dt><strong>ind_l: int</strong></dt>\n<dd><p class=\"first last\">Elements index l (0 for x, 1 for y, 2 for z)</p>\n</dd>\n<dt><strong>DT</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(3,3) ndarray (optional)</span></dt>\n<dd><p class=\"first last\">Voxel\u2019s global diffusion tensor.</p>\n</dd>\n<dt><strong>MD</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float (optional)</span></dt>\n<dd><p class=\"first last\">Voxel\u2019s global mean diffusivity.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>wijkl</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">kurtosis tensor element of index i, j, k, l</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">Notes</p>\n<p>wijkl is calculated using equation 8 given in <a class=\"reference internal\" href=\"#rdbe8ff920d54-1\" id=\"id25\">[1]</a></p>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"rdbe8ff920d54-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\">[1]</td><td><em>(<a class=\"fn-backref\" href=\"#id25\">1</a>, <a class=\"fn-backref\" href=\"#id26\">2</a>)</em> R. Neto Henriques et al., \u201cExploring the 3D geometry of the\ndiffusion kurtosis tensor - Impact on the development of robust\ntractography procedures and novel biomarkers\u201d, NeuroImage (2015)\n111, 85-99.</td></tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"multi-tensor\">\n<h3>multi_tensor<a class=\"headerlink\" href=\"#multi-tensor\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.multi_tensor\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">multi_tensor</code><span class=\"sig-paren\">(</span><em>gtab, mevals, S0=1.0, angles=[(0, 0), (90, 0)], fractions=[50, 50], snr=20</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.multi_tensor\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Simulate a Multi-Tensor signal.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>gtab</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">GradientTable</span></dt>\n<dd></dd>\n<dt><strong>mevals</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array (K, 3)</span></dt>\n<dd><p class=\"first last\">each tensor\u2019s eigenvalues in each row</p>\n</dd>\n<dt><strong>S0</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Unweighted signal value (b0 signal).</p>\n</dd>\n<dt><strong>angles</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array (K,2) or (K,3)</span></dt>\n<dd><p class=\"first last\">List of K tensor directions in polar angles (in degrees) or unit\nvectors</p>\n</dd>\n<dt><strong>fractions</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Percentage of the contribution of each tensor. The sum of fractions\nshould be equal to 100%.</p>\n</dd>\n<dt><strong>snr</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Signal to noise ratio, assuming Rician noise.  If set to None, no\nnoise is added.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>S</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(N,) ndarray</span></dt>\n<dd><p class=\"first last\">Simulated signal.</p>\n</dd>\n<dt><strong>sticks</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(M,3)</span></dt>\n<dd><p class=\"first last\">Sticks in cartesian coordinates.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">Examples</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.sims.voxel</span> <span class=\"k\">import</span> <span class=\"n\">multi_tensor</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.data</span> <span class=\"k\">import</span> <span class=\"n\">get_fnames</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.core.gradients</span> <span class=\"k\">import</span> <span class=\"n\">gradient_table</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.io.gradients</span> <span class=\"k\">import</span> <span class=\"n\">read_bvals_bvecs</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">fimg</span><span class=\"p\">,</span> <span class=\"n\">fbvals</span><span class=\"p\">,</span> <span class=\"n\">fbvecs</span> <span class=\"o\">=</span> <span class=\"n\">get_fnames</span><span class=\"p\">(</span><span class=\"s1\">&#39;small_101D&#39;</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">bvals</span><span class=\"p\">,</span> <span class=\"n\">bvecs</span> <span class=\"o\">=</span> <span class=\"n\">read_bvals_bvecs</span><span class=\"p\">(</span><span class=\"n\">fbvals</span><span class=\"p\">,</span> <span class=\"n\">fbvecs</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">gtab</span> <span class=\"o\">=</span> <span class=\"n\">gradient_table</span><span class=\"p\">(</span><span class=\"n\">bvals</span><span class=\"p\">,</span> <span class=\"n\">bvecs</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">mevals</span><span class=\"o\">=</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(([</span><span class=\"mf\">0.0015</span><span class=\"p\">,</span> <span class=\"mf\">0.0003</span><span class=\"p\">,</span> <span class=\"mf\">0.0003</span><span class=\"p\">],[</span><span class=\"mf\">0.0015</span><span class=\"p\">,</span> <span class=\"mf\">0.0003</span><span class=\"p\">,</span> <span class=\"mf\">0.0003</span><span class=\"p\">]))</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">e0</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mf\">0.</span><span class=\"p\">])</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">e1</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([</span><span class=\"mf\">0.</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">])</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">S</span> <span class=\"o\">=</span> <span class=\"n\">multi_tensor</span><span class=\"p\">(</span><span class=\"n\">gtab</span><span class=\"p\">,</span> <span class=\"n\">mevals</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"multi-tensor-dki\">\n<h3>multi_tensor_dki<a class=\"headerlink\" href=\"#multi-tensor-dki\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.multi_tensor_dki\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">multi_tensor_dki</code><span class=\"sig-paren\">(</span><em>gtab, mevals, S0=1.0, angles=[(90.0, 0.0), (90.0, 0.0)], fractions=[50, 50], snr=20</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.multi_tensor_dki\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Simulate the diffusion-weight signal, diffusion and kurtosis tensors\nbased on the DKI model</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>gtab</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">GradientTable</span></dt>\n<dd></dd>\n<dt><strong>mevals</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array (K, 3)</span></dt>\n<dd><p class=\"first last\">eigenvalues of the diffusion tensor for each individual compartment</p>\n</dd>\n<dt><strong>S0</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float (optional)</span></dt>\n<dd><p class=\"first last\">Unweighted signal value (b0 signal).</p>\n</dd>\n<dt><strong>angles</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array (K,2) or (K,3) (optional)</span></dt>\n<dd><p class=\"first last\">List of K tensor directions of the diffusion tensor of each compartment\nin polar angles (in degrees) or unit vectors</p>\n</dd>\n<dt><strong>fractions</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float (K,) (optional)</span></dt>\n<dd><p class=\"first last\">Percentage of the contribution of each tensor. The sum of fractions\nshould be equal to 100%.</p>\n</dd>\n<dt><strong>snr</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float (optional)</span></dt>\n<dd><p class=\"first last\">Signal to noise ratio, assuming Rician noise.  If set to None, no\nnoise is added.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>S</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(N,) ndarray</span></dt>\n<dd><p class=\"first last\">Simulated signal based on the DKI model.</p>\n</dd>\n<dt><strong>dt</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(6,)</span></dt>\n<dd><p class=\"first last\">elements of the diffusion tensor.</p>\n</dd>\n<dt><strong>kt</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(15,)</span></dt>\n<dd><p class=\"first last\">elements of the kurtosis tensor.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">Notes</p>\n<p>Simulations are based on multicompartmental models which assumes that\ntissue is well described by impermeable diffusion compartments\ncharacterized by their only diffusion tensor. Since simulations are based\non the DKI model, coefficients larger than the fourth order of the signal\u2019s\ntaylor expansion approximation are neglected.</p>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"r2c19a1917a3c-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id27\">[1]</a></td><td>R. Neto Henriques et al., \u201cExploring the 3D geometry of the\ndiffusion kurtosis tensor - Impact on the development of robust\ntractography procedures and novel biomarkers\u201d, NeuroImage (2015)\n111, 85-99.</td></tr>\n</tbody>\n</table>\n<p class=\"rubric\">Examples</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.sims.voxel</span> <span class=\"k\">import</span> <span class=\"n\">multi_tensor_dki</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.data</span> <span class=\"k\">import</span> <span class=\"n\">get_fnames</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.core.gradients</span> <span class=\"k\">import</span> <span class=\"n\">gradient_table</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.io.gradients</span> <span class=\"k\">import</span> <span class=\"n\">read_bvals_bvecs</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">fimg</span><span class=\"p\">,</span> <span class=\"n\">fbvals</span><span class=\"p\">,</span> <span class=\"n\">fbvecs</span> <span class=\"o\">=</span> <span class=\"n\">get_fnames</span><span class=\"p\">(</span><span class=\"s1\">&#39;small_64D&#39;</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">bvals</span><span class=\"p\">,</span> <span class=\"n\">bvecs</span> <span class=\"o\">=</span> <span class=\"n\">read_bvals_bvecs</span><span class=\"p\">(</span><span class=\"n\">fbvals</span><span class=\"p\">,</span> <span class=\"n\">fbvecs</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">bvals_2s</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">concatenate</span><span class=\"p\">((</span><span class=\"n\">bvals</span><span class=\"p\">,</span> <span class=\"n\">bvals</span> <span class=\"o\">*</span> <span class=\"mi\">2</span><span class=\"p\">),</span> <span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">bvecs_2s</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">concatenate</span><span class=\"p\">((</span><span class=\"n\">bvecs</span><span class=\"p\">,</span> <span class=\"n\">bvecs</span><span class=\"p\">),</span> <span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">gtab</span> <span class=\"o\">=</span> <span class=\"n\">gradient_table</span><span class=\"p\">(</span><span class=\"n\">bvals_2s</span><span class=\"p\">,</span> <span class=\"n\">bvecs_2s</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">mevals</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([[</span><span class=\"mf\">0.00099</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">],[</span><span class=\"mf\">0.00226</span><span class=\"p\">,</span> <span class=\"mf\">0.00087</span><span class=\"p\">,</span> <span class=\"mf\">0.00087</span><span class=\"p\">]])</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">S</span><span class=\"p\">,</span> <span class=\"n\">dt</span><span class=\"p\">,</span> <span class=\"n\">kt</span> <span class=\"o\">=</span>  <span class=\"n\">multi_tensor_dki</span><span class=\"p\">(</span><span class=\"n\">gtab</span><span class=\"p\">,</span> <span class=\"n\">mevals</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"multi-tensor-msd\">\n<h3>multi_tensor_msd<a class=\"headerlink\" href=\"#multi-tensor-msd\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.multi_tensor_msd\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">multi_tensor_msd</code><span class=\"sig-paren\">(</span><em>mf</em>, <em>mevals=None</em>, <em>tau=0.025330295910584444</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.multi_tensor_msd\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Simulate a Multi-Tensor rtop.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>mf</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">sequence of floats, bounded [0,1]</span></dt>\n<dd><p class=\"first last\">Percentages of the fractions for each tensor.</p>\n</dd>\n<dt><strong>mevals</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">sequence of 1D arrays,</span></dt>\n<dd><p class=\"first last\">Eigen-values for each tensor.  By default, values typical for prolate\nwhite matter are used.</p>\n</dd>\n<dt><strong>tau</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float,</span></dt>\n<dd><p class=\"first last\">diffusion time. By default the value that makes q=sqrt(b).</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>msd</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float,</span></dt>\n<dd><p class=\"first last\">Mean square displacement.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"ra0578d0ca42a-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id28\">[1]</a></td><td>Cheng J., \u201cEstimation and Processing of Ensemble Average Propagator\nand Its Features in Diffusion MRI\u201d, PhD Thesis, 2012.</td></tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"multi-tensor-odf\">\n<h3>multi_tensor_odf<a class=\"headerlink\" href=\"#multi-tensor-odf\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.multi_tensor_odf\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">multi_tensor_odf</code><span class=\"sig-paren\">(</span><em>odf_verts</em>, <em>mevals</em>, <em>angles</em>, <em>fractions</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.multi_tensor_odf\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Simulate a Multi-Tensor ODF.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>odf_verts</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(N,3) ndarray</span></dt>\n<dd><p class=\"first last\">Vertices of the reconstruction sphere.</p>\n</dd>\n<dt><strong>mevals</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">sequence of 1D arrays,</span></dt>\n<dd><p class=\"first last\">Eigen-values for each tensor.</p>\n</dd>\n<dt><strong>angles</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">sequence of 2d tuples,</span></dt>\n<dd><p class=\"first last\">Sequence of principal directions for each tensor in polar angles\nor cartesian unit coordinates.</p>\n</dd>\n<dt><strong>fractions</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">sequence of floats,</span></dt>\n<dd><p class=\"first last\">Percentages of the fractions for each tensor.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>ODF</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(N,) ndarray</span></dt>\n<dd><p class=\"first last\">Orientation distribution function.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">Examples</p>\n<p>Simulate a MultiTensor ODF with two peaks and calculate its exact ODF.</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.sims.voxel</span> <span class=\"k\">import</span> <span class=\"n\">multi_tensor_odf</span><span class=\"p\">,</span> <span class=\"n\">all_tensor_evecs</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.data</span> <span class=\"k\">import</span> <span class=\"n\">get_sphere</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">sphere</span> <span class=\"o\">=</span> <span class=\"n\">get_sphere</span><span class=\"p\">(</span><span class=\"s1\">&#39;symmetric724&#39;</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">vertices</span><span class=\"p\">,</span> <span class=\"n\">faces</span> <span class=\"o\">=</span> <span class=\"n\">sphere</span><span class=\"o\">.</span><span class=\"n\">vertices</span><span class=\"p\">,</span> <span class=\"n\">sphere</span><span class=\"o\">.</span><span class=\"n\">faces</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">mevals</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(([</span><span class=\"mf\">0.0015</span><span class=\"p\">,</span> <span class=\"mf\">0.0003</span><span class=\"p\">,</span> <span class=\"mf\">0.0003</span><span class=\"p\">],[</span><span class=\"mf\">0.0015</span><span class=\"p\">,</span> <span class=\"mf\">0.0003</span><span class=\"p\">,</span> <span class=\"mf\">0.0003</span><span class=\"p\">]))</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">angles</span> <span class=\"o\">=</span> <span class=\"p\">[(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">),</span> <span class=\"p\">(</span><span class=\"mi\">90</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)]</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">odf</span> <span class=\"o\">=</span> <span class=\"n\">multi_tensor_odf</span><span class=\"p\">(</span><span class=\"n\">vertices</span><span class=\"p\">,</span> <span class=\"n\">mevals</span><span class=\"p\">,</span> <span class=\"n\">angles</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"mi\">50</span><span class=\"p\">,</span> <span class=\"mi\">50</span><span class=\"p\">])</span>\n</pre></div>\n</div>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"multi-tensor-pdf\">\n<h3>multi_tensor_pdf<a class=\"headerlink\" href=\"#multi-tensor-pdf\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.multi_tensor_pdf\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">multi_tensor_pdf</code><span class=\"sig-paren\">(</span><em>pdf_points</em>, <em>mevals</em>, <em>angles</em>, <em>fractions</em>, <em>tau=0.025330295910584444</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.multi_tensor_pdf\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Simulate a Multi-Tensor ODF.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>pdf_points</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(N, 3) ndarray</span></dt>\n<dd><p class=\"first last\">Points to evaluate the PDF.</p>\n</dd>\n<dt><strong>mevals</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">sequence of 1D arrays,</span></dt>\n<dd><p class=\"first last\">Eigen-values for each tensor.  By default, values typical for prolate\nwhite matter are used.</p>\n</dd>\n<dt><strong>angles</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">sequence,</span></dt>\n<dd><p class=\"first last\">Sequence of principal directions for each tensor in polar angles\nor cartesian unit coordinates.</p>\n</dd>\n<dt><strong>fractions</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">sequence of floats,</span></dt>\n<dd><p class=\"first last\">Percentages of the fractions for each tensor.</p>\n</dd>\n<dt><strong>tau</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float,</span></dt>\n<dd><p class=\"first last\">diffusion time. By default the value that makes q=sqrt(b).</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>pdf</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(N,) ndarray,</span></dt>\n<dd><p class=\"first last\">Probability density function of the water displacement.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"rc689307ee495-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id29\">[1]</a></td><td>Cheng J., \u201cEstimation and Processing of Ensemble Average Propagator\nand its Features in Diffusion MRI\u201d, PhD Thesis, 2012.</td></tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"multi-tensor-rtop\">\n<h3>multi_tensor_rtop<a class=\"headerlink\" href=\"#multi-tensor-rtop\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.multi_tensor_rtop\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">multi_tensor_rtop</code><span class=\"sig-paren\">(</span><em>mf</em>, <em>mevals=None</em>, <em>tau=0.025330295910584444</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.multi_tensor_rtop\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Simulate a Multi-Tensor rtop.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>mf</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">sequence of floats, bounded [0,1]</span></dt>\n<dd><p class=\"first last\">Percentages of the fractions for each tensor.</p>\n</dd>\n<dt><strong>mevals</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">sequence of 1D arrays,</span></dt>\n<dd><p class=\"first last\">Eigen-values for each tensor.  By default, values typical for prolate\nwhite matter are used.</p>\n</dd>\n<dt><strong>tau</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float,</span></dt>\n<dd><p class=\"first last\">diffusion time. By default the value that makes q=sqrt(b).</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>rtop</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float,</span></dt>\n<dd><p class=\"first last\">Return to origin probability.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"rc96e34bb10c1-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id30\">[1]</a></td><td>Cheng J., \u201cEstimation and Processing of Ensemble Average Propagator\nand Its Features in Diffusion MRI\u201d, PhD Thesis, 2012.</td></tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"single-tensor\">\n<h3>single_tensor<a class=\"headerlink\" href=\"#single-tensor\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.single_tensor\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">single_tensor</code><span class=\"sig-paren\">(</span><em>gtab</em>, <em>S0=1</em>, <em>evals=None</em>, <em>evecs=None</em>, <em>snr=None</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.single_tensor\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Simulated Q-space signal with a single tensor.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>gtab</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">GradientTable</span></dt>\n<dd><p class=\"first last\">Measurement directions.</p>\n</dd>\n<dt><strong>S0</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">double,</span></dt>\n<dd><p class=\"first last\">Strength of signal in the presence of no diffusion gradient (also\ncalled the <code class=\"docutils literal notranslate\"><span class=\"pre\">b=0</span></code> value).</p>\n</dd>\n<dt><strong>evals</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(3,) ndarray</span></dt>\n<dd><p class=\"first last\">Eigenvalues of the diffusion tensor.  By default, values typical for\nprolate white matter are used.</p>\n</dd>\n<dt><strong>evecs</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(3, 3) ndarray</span></dt>\n<dd><p class=\"first last\">Eigenvectors of the tensor.  You can also think of this as a rotation\nmatrix that transforms the direction of the tensor. The eigenvectors\nneed to be column wise.</p>\n</dd>\n<dt><strong>snr</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Signal to noise ratio, assuming Rician noise.  None implies no noise.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>S</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(N,) ndarray</span></dt>\n<dd><p class=\"first last\">Simulated signal: <code class=\"docutils literal notranslate\"><span class=\"pre\">S(q,</span> <span class=\"pre\">tau)</span> <span class=\"pre\">=</span> <span class=\"pre\">S_0</span> <span class=\"pre\">e^(-b</span> <span class=\"pre\">g^T</span> <span class=\"pre\">R</span> <span class=\"pre\">D</span> <span class=\"pre\">R.T</span> <span class=\"pre\">g)</span></code>.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"r33603d57b825-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id31\">[1]</a></td><td>M. Descoteaux, \u201cHigh Angular Resolution Diffusion MRI: from Local\nEstimation to Segmentation and Tractography\u201d, PhD thesis,\nUniversity of Nice-Sophia Antipolis, p. 42, 2008.</td></tr>\n</tbody>\n</table>\n<table class=\"docutils citation\" frame=\"void\" id=\"r33603d57b825-2\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id32\">[2]</a></td><td>E. Stejskal and J. Tanner, \u201cSpin diffusion measurements: spin echos\nin the presence of a time-dependent field gradient\u201d, Journal of\nChemical Physics, nr. 42, pp. 288\u2013292, 1965.</td></tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"single-tensor-msd\">\n<h3>single_tensor_msd<a class=\"headerlink\" href=\"#single-tensor-msd\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.single_tensor_msd\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">single_tensor_msd</code><span class=\"sig-paren\">(</span><em>evals=None</em>, <em>tau=0.025330295910584444</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.single_tensor_msd\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Simulate a Multi-Tensor rtop.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>evals</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">1D arrays,</span></dt>\n<dd><p class=\"first last\">Eigen-values for the tensor.  By default, values typical for prolate\nwhite matter are used.</p>\n</dd>\n<dt><strong>tau</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float,</span></dt>\n<dd><p class=\"first last\">diffusion time. By default the value that makes q=sqrt(b).</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>msd</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float,</span></dt>\n<dd><p class=\"first last\">Mean square displacement.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"re546f6d4f85b-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id33\">[1]</a></td><td>Cheng J., \u201cEstimation and Processing of Ensemble Average Propagator\nand Its Features in Diffusion MRI\u201d, PhD Thesis, 2012.</td></tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"single-tensor-odf\">\n<h3>single_tensor_odf<a class=\"headerlink\" href=\"#single-tensor-odf\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.single_tensor_odf\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">single_tensor_odf</code><span class=\"sig-paren\">(</span><em>r</em>, <em>evals=None</em>, <em>evecs=None</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.single_tensor_odf\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Simulated ODF with a single tensor.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>r</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(N,3) or (M,N,3) ndarray</span></dt>\n<dd><p class=\"first last\">Measurement positions in (x, y, z), either as a list or on a grid.</p>\n</dd>\n<dt><strong>evals</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(3,)</span></dt>\n<dd><p class=\"first last\">Eigenvalues of diffusion tensor.  By default, use values typical for\nprolate white matter.</p>\n</dd>\n<dt><strong>evecs</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(3, 3) ndarray</span></dt>\n<dd><p class=\"first last\">Eigenvectors of the tensor, written column-wise.  You can also think\nof these as the rotation matrix that determines the orientation of\nthe diffusion tensor.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>ODF</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(N,) ndarray</span></dt>\n<dd><p class=\"first last\">The diffusion probability at <code class=\"docutils literal notranslate\"><span class=\"pre\">r</span></code> after time <code class=\"docutils literal notranslate\"><span class=\"pre\">tau</span></code>.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"r3b7be155f682-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id34\">[1]</a></td><td>Aganj et al., \u201cReconstruction of the Orientation Distribution\nFunction in Single- and Multiple-Shell q-Ball Imaging Within\nConstant Solid Angle\u201d, Magnetic Resonance in Medicine, nr. 64,\npp. 554\u2013566, 2010.</td></tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"single-tensor-pdf\">\n<h3>single_tensor_pdf<a class=\"headerlink\" href=\"#single-tensor-pdf\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.single_tensor_pdf\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">single_tensor_pdf</code><span class=\"sig-paren\">(</span><em>r</em>, <em>evals=None</em>, <em>evecs=None</em>, <em>tau=0.025330295910584444</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.single_tensor_pdf\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Simulated ODF with a single tensor.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>r</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(N,3) or (M,N,3) ndarray</span></dt>\n<dd><p class=\"first last\">Measurement positions in (x, y, z), either as a list or on a grid.</p>\n</dd>\n<dt><strong>evals</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(3,)</span></dt>\n<dd><p class=\"first last\">Eigenvalues of diffusion tensor.  By default, use values typical for\nprolate white matter.</p>\n</dd>\n<dt><strong>evecs</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(3, 3) ndarray</span></dt>\n<dd><p class=\"first last\">Eigenvectors of the tensor.  You can also think of these as the\nrotation matrix that determines the orientation of the diffusion\ntensor.</p>\n</dd>\n<dt><strong>tau</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float,</span></dt>\n<dd><p class=\"first last\">diffusion time. By default the value that makes q=sqrt(b).</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>pdf</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(N,) ndarray</span></dt>\n<dd><p class=\"first last\">The diffusion probability at <code class=\"docutils literal notranslate\"><span class=\"pre\">r</span></code> after time <code class=\"docutils literal notranslate\"><span class=\"pre\">tau</span></code>.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"r9b4d3e28979e-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id35\">[1]</a></td><td>Cheng J., \u201cEstimation and Processing of Ensemble Average Propagator\nand Its Features in Diffusion MRI\u201d, PhD Thesis, 2012.</td></tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"single-tensor-rtop\">\n<h3>single_tensor_rtop<a class=\"headerlink\" href=\"#single-tensor-rtop\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.single_tensor_rtop\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">single_tensor_rtop</code><span class=\"sig-paren\">(</span><em>evals=None</em>, <em>tau=0.025330295910584444</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.single_tensor_rtop\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Simulate a Multi-Tensor rtop.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>evals</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">1D arrays,</span></dt>\n<dd><p class=\"first last\">Eigen-values for the tensor.  By default, values typical for prolate\nwhite matter are used.</p>\n</dd>\n<dt><strong>tau</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float,</span></dt>\n<dd><p class=\"first last\">diffusion time. By default the value that makes q=sqrt(b).</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>rtop</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float,</span></dt>\n<dd><p class=\"first last\">Return to origin probability.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"raad40b85a7cb-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id36\">[1]</a></td><td>Cheng J., \u201cEstimation and Processing of Ensemble Average Propagator\nand Its Features in Diffusion MRI\u201d, PhD Thesis, 2012.</td></tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"sphere2cart\">\n<h3>sphere2cart<a class=\"headerlink\" href=\"#sphere2cart\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.sphere2cart\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">sphere2cart</code><span class=\"sig-paren\">(</span><em>r</em>, <em>theta</em>, <em>phi</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.sphere2cart\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Spherical to Cartesian coordinates</p>\n<p>This is the standard physics convention where <cite>theta</cite> is the\ninclination (polar) angle, and <cite>phi</cite> is the azimuth angle.</p>\n<p>Imagine a sphere with center (0,0,0).  Orient it with the z axis\nrunning south-north, the y axis running west-east and the x axis\nfrom posterior to anterior.  <cite>theta</cite> (the inclination angle) is the\nangle to rotate from the z-axis (the zenith) around the y-axis,\ntowards the x axis.  Thus the rotation is counter-clockwise from the\npoint of view of positive y.  <cite>phi</cite> (azimuth) gives the angle of\nrotation around the z-axis towards the y axis.  The rotation is\ncounter-clockwise from the point of view of positive z.</p>\n<p>Equivalently, given a point P on the sphere, with coordinates x, y,\nz, <cite>theta</cite> is the angle between P and the z-axis, and <cite>phi</cite> is\nthe angle between the projection of P onto the XY plane, and the X\naxis.</p>\n<p>Geographical nomenclature designates theta as \u2018co-latitude\u2019, and phi\nas \u2018longitude\u2019</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>r</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array_like</span></dt>\n<dd><p class=\"first last\">radius</p>\n</dd>\n<dt><strong>theta</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array_like</span></dt>\n<dd><p class=\"first last\">inclination or polar angle</p>\n</dd>\n<dt><strong>phi</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array_like</span></dt>\n<dd><p class=\"first last\">azimuth angle</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>x</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array</span></dt>\n<dd><p class=\"first last\">x coordinate(s) in Cartesion space</p>\n</dd>\n<dt><strong>y</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array</span></dt>\n<dd><p class=\"first last\">y coordinate(s) in Cartesian space</p>\n</dd>\n<dt><strong>z</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array</span></dt>\n<dd><p class=\"first last\">z coordinate</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">Notes</p>\n<p>See these pages:</p>\n<ul class=\"simple\">\n<li><a class=\"reference external\" href=\"http://en.wikipedia.org/wiki/Spherical_coordinate_system\">http://en.wikipedia.org/wiki/Spherical_coordinate_system</a></li>\n<li><a class=\"reference external\" href=\"http://mathworld.wolfram.com/SphericalCoordinates.html\">http://mathworld.wolfram.com/SphericalCoordinates.html</a></li>\n</ul>\n<p>for excellent discussion of the many different conventions\npossible.  Here we use the physics conventions, used in the\nwikipedia page.</p>\n<p>Derivations of the formulae are simple. Consider a vector x, y, z of\nlength r (norm of x, y, z).  The inclination angle (theta) can be\nfound from: cos(theta) == z / r -&gt; z == r * cos(theta).  This gives\nthe hypotenuse of the projection onto the XY plane, which we will\ncall Q. Q == r*sin(theta). Now x / Q == cos(phi) -&gt; x == r *\nsin(theta) * cos(phi) and so on.</p>\n<p>We have deliberately named this function <code class=\"docutils literal notranslate\"><span class=\"pre\">sphere2cart</span></code> rather than\n<code class=\"docutils literal notranslate\"><span class=\"pre\">sph2cart</span></code> to distinguish it from the Matlab function of that\nname, because the Matlab function uses an unusual convention for the\nangles that we did not want to replicate.  The Matlab function is\ntrivial to implement with the formulae given in the Matlab help.</p>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"sticks-and-ball\">\n<h3>sticks_and_ball<a class=\"headerlink\" href=\"#sticks-and-ball\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.sticks_and_ball\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">sticks_and_ball</code><span class=\"sig-paren\">(</span><em>gtab, d=0.0015, S0=1.0, angles=[(0, 0), (90, 0)], fractions=[35, 35], snr=20</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.sticks_and_ball\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>Simulate the signal for a Sticks &amp; Ball model.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>gtab</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">GradientTable</span></dt>\n<dd><p class=\"first last\">Signal measurement directions.</p>\n</dd>\n<dt><strong>d</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Diffusivity value.</p>\n</dd>\n<dt><strong>S0</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Unweighted signal value.</p>\n</dd>\n<dt><strong>angles</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array (K,2) or (K, 3)</span></dt>\n<dd><p class=\"first last\">List of K polar angles (in degrees) for the sticks or array of K\nsticks as unit vectors.</p>\n</dd>\n<dt><strong>fractions</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Percentage of each stick.  Remainder to 100 specifies isotropic\ncomponent.</p>\n</dd>\n<dt><strong>snr</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">float</span></dt>\n<dd><p class=\"first last\">Signal to noise ratio, assuming Rician noise.  If set to None, no\nnoise is added.</p>\n</dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>S</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(N,) ndarray</span></dt>\n<dd><p class=\"first last\">Simulated signal.</p>\n</dd>\n<dt><strong>sticks</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">(M,3)</span></dt>\n<dd><p class=\"first last\">Sticks in cartesian coordinates.</p>\n</dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">References</p>\n<table class=\"docutils citation\" frame=\"void\" id=\"r8d243290f5cf-1\" rules=\"none\">\n<colgroup><col class=\"label\" /><col /></colgroup>\n<tbody valign=\"top\">\n<tr><td class=\"label\"><a class=\"fn-backref\" href=\"#id37\">[1]</a></td><td>Behrens et al., \u201cProbabilistic diffusion\ntractography with multiple fiber orientations:  what can we gain?\u201d,\nNeuroimage, 2007.</td></tr>\n</tbody>\n</table>\n</dd></dl>\n\n</div>\n<div class=\"section\" id=\"id38\">\n<h3>vec2vec_rotmat<a class=\"headerlink\" href=\"#id38\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<dl class=\"function\">\n<dt id=\"dipy.sims.voxel.vec2vec_rotmat\">\n<code class=\"descclassname\">dipy.sims.voxel.</code><code class=\"descname\">vec2vec_rotmat</code><span class=\"sig-paren\">(</span><em>u</em>, <em>v</em><span class=\"sig-paren\">)</span><a class=\"headerlink\" href=\"#dipy.sims.voxel.vec2vec_rotmat\" title=\"Permalink to this definition\">\u00b6</a></dt>\n<dd><p>rotation matrix from 2 unit vectors</p>\n<p>u, v being unit 3d vectors return a 3x3 rotation matrix R than aligns u to\nv.</p>\n<p>In general there are many rotations that will map u to v. If S is any\nrotation using v as an axis then R.S will also map u to v since (S.R)u =\nS(Ru) = Sv = v.  The rotation R returned by vec2vec_rotmat leaves fixed the\nperpendicular to the plane spanned by u and v.</p>\n<p>The transpose of R will align v to u.</p>\n<table class=\"docutils field-list\" frame=\"void\" rules=\"none\">\n<col class=\"field-name\" />\n<col class=\"field-body\" />\n<tbody valign=\"top\">\n<tr class=\"field-odd field\"><th class=\"field-name\">Parameters:</th><td class=\"field-body\"><dl class=\"first docutils\">\n<dt><strong>u</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape(3,)</span></dt>\n<dd></dd>\n<dt><strong>v</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape(3,)</span></dt>\n<dd></dd>\n</dl>\n</td>\n</tr>\n<tr class=\"field-even field\"><th class=\"field-name\">Returns:</th><td class=\"field-body\"><dl class=\"first last docutils\">\n<dt><strong>R</strong> <span class=\"classifier-delimiter\">:</span> <span class=\"classifier\">array, shape(3,3)</span></dt>\n<dd></dd>\n</dl>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"rubric\">Examples</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">from</span> <span class=\"nn\">dipy.core.geometry</span> <span class=\"k\">import</span> <span class=\"n\">vec2vec_rotmat</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">u</span><span class=\"o\">=</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mi\">0</span><span class=\"p\">])</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">v</span><span class=\"o\">=</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">,</span><span class=\"mi\">0</span><span class=\"p\">])</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">R</span><span class=\"o\">=</span><span class=\"n\">vec2vec_rotmat</span><span class=\"p\">(</span><span class=\"n\">u</span><span class=\"p\">,</span><span class=\"n\">v</span><span class=\"p\">)</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">dot</span><span class=\"p\">(</span><span class=\"n\">R</span><span class=\"p\">,</span><span class=\"n\">u</span><span class=\"p\">)</span>\n<span class=\"go\">array([ 0.,  1.,  0.])</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">dot</span><span class=\"p\">(</span><span class=\"n\">R</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">,</span><span class=\"n\">v</span><span class=\"p\">)</span>\n<span class=\"go\">array([ 1.,  0.,  0.])</span>\n</pre></div>\n</div>\n</dd></dl>\n\n</div>\n</div>\n</div>\n", "metatags": "", "rellinks": [["genindex", "General Index", "I", "index"], ["py-modindex", "Python Module Index", "", "modules"], ["reference/dipy.tracking", "<code class=\"docutils literal notranslate\"><span class=\"pre\">tracking</span></code>", "N", "next"]], "sourcename": "reference/dipy.sims.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\"><code class=\"docutils literal notranslate\"><span class=\"pre\">sims</span></code></a><ul>\n<li><a class=\"reference internal\" href=\"#module-dipy.sims.phantom\">Module: <code class=\"docutils literal notranslate\"><span class=\"pre\">sims.phantom</span></code></a></li>\n<li><a class=\"reference internal\" href=\"#module-dipy.sims.voxel\">Module: <code class=\"docutils literal notranslate\"><span class=\"pre\">sims.voxel</span></code></a><ul>\n<li><a class=\"reference internal\" href=\"#singletensor\">SingleTensor</a></li>\n<li><a class=\"reference internal\" href=\"#add-noise\">add_noise</a></li>\n<li><a class=\"reference internal\" href=\"#diff2eigenvectors\">diff2eigenvectors</a></li>\n<li><a class=\"reference internal\" href=\"#get-fnames\">get_fnames</a></li>\n<li><a class=\"reference internal\" href=\"#gradient-table\">gradient_table</a></li>\n<li><a class=\"reference internal\" href=\"#orbital-phantom\">orbital_phantom</a></li>\n<li><a class=\"reference internal\" href=\"#vec2vec-rotmat\">vec2vec_rotmat</a></li>\n<li><a class=\"reference internal\" href=\"#multitensor\">MultiTensor</a></li>\n<li><a class=\"reference internal\" href=\"#id9\">SingleTensor</a></li>\n<li><a class=\"reference internal\" href=\"#sticksandball\">SticksAndBall</a></li>\n<li><a class=\"reference internal\" href=\"#id13\">add_noise</a></li>\n<li><a class=\"reference internal\" href=\"#all-tensor-evecs\">all_tensor_evecs</a></li>\n<li><a class=\"reference internal\" href=\"#callaghan-perpendicular\">callaghan_perpendicular</a></li>\n<li><a class=\"reference internal\" href=\"#cylinders-and-ball-soderman\">cylinders_and_ball_soderman</a></li>\n<li><a class=\"reference internal\" href=\"#dki-design-matrix\">dki_design_matrix</a></li>\n<li><a class=\"reference internal\" href=\"#dki-signal\">dki_signal</a></li>\n<li><a class=\"reference internal\" href=\"#dot\">dot</a></li>\n<li><a class=\"reference internal\" href=\"#gaussian-parallel\">gaussian_parallel</a></li>\n<li><a class=\"reference internal\" href=\"#kurtosis-element\">kurtosis_element</a></li>\n<li><a class=\"reference internal\" href=\"#multi-tensor\">multi_tensor</a></li>\n<li><a class=\"reference internal\" href=\"#multi-tensor-dki\">multi_tensor_dki</a></li>\n<li><a class=\"reference internal\" href=\"#multi-tensor-msd\">multi_tensor_msd</a></li>\n<li><a class=\"reference internal\" href=\"#multi-tensor-odf\">multi_tensor_odf</a></li>\n<li><a class=\"reference internal\" href=\"#multi-tensor-pdf\">multi_tensor_pdf</a></li>\n<li><a class=\"reference internal\" href=\"#multi-tensor-rtop\">multi_tensor_rtop</a></li>\n<li><a class=\"reference internal\" href=\"#single-tensor\">single_tensor</a></li>\n<li><a class=\"reference internal\" href=\"#single-tensor-msd\">single_tensor_msd</a></li>\n<li><a class=\"reference internal\" href=\"#single-tensor-odf\">single_tensor_odf</a></li>\n<li><a class=\"reference internal\" href=\"#single-tensor-pdf\">single_tensor_pdf</a></li>\n<li><a class=\"reference internal\" href=\"#single-tensor-rtop\">single_tensor_rtop</a></li>\n<li><a class=\"reference internal\" href=\"#sphere2cart\">sphere2cart</a></li>\n<li><a class=\"reference internal\" href=\"#sticks-and-ball\">sticks_and_ball</a></li>\n<li><a class=\"reference internal\" href=\"#id38\">vec2vec_rotmat</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "reference/dipy.sims", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.11"}